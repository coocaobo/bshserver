<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- namespace：必须与对应的接口全类名一致 id:必须与对应接口的某个对应的方法名一致 -->
<mapper namespace="com.bsoft.mapper.meishan.MSDigitalHospitalMapper">

	<!-- 数据权限 科室代码 -->
	<sql id="sql_where_deptCodes">
		<if test="role != '1' and role != '0'">
			<if test="deptCodes != null and deptCodes !=''">
				where code in
				<foreach item="item" collection="deptCodes" open="("
					separator="," close=")">
					#{item,jdbcType=VARCHAR}
				</foreach>getOutpatientOrHospitalizationIncomeByYear
			</if>
		</if>
	</sql>
	
	<!-- 数据权限 医生代码 -->
	<sql id="sql_where_doctorCodes">
	<if test="role != '1' and role != '0'">
		<if test="doctorCodes != null and doctorCodes !=''">
			where code in
		<foreach item="item" collection="doctorCodes" open="("
				separator="," close=")">
				#{item,jdbcType=VARCHAR}
			</foreach>
		</if>
		</if>
	</sql>
	<!-- 数据权限 科室代码 -->
	<sql id="sql_where_deptCodes_a">
	<if test="role != '1' and role != '0'">
		<if test="deptCodes != null and deptCodes !=''">
			where a.code in
			<foreach item="item" collection="deptCodes" open="("
				separator="," close=")">
				#{item,jdbcType=VARCHAR}
			</foreach>
		</if>
		</if>
	</sql>
	
	<!-- 数据权限 医生代码 -->
	<sql id="sql_where_doctorCodes_a">
	<if test="role != '1' and role != '0'">
		<if test="doctorCodes != null and doctorCodes !=''">
			where a.code in
		<foreach item="item" collection="doctorCodes" open="("
				separator="," close=")">
				#{item,jdbcType=VARCHAR}
			</foreach>
		</if>
		</if>
	</sql>
	<!-- 数据权限 科室代码 -->
	<sql id="sql_where_and_deptCodes">
	<if test="role != '1' and role != '0'">
		<if test="deptCodes != null and deptCodes !=''">
			and code in
			<foreach item="item" collection="deptCodes" open="("
				separator="," close=")">
				#{item,jdbcType=VARCHAR}
			</foreach>
		</if>
		</if>
	</sql>
	
	<!-- 数据权限 医生代码 -->
	<sql id="sql_where_and_doctorCodes">
	<if test="role != '1' and role != '0'">
		<if test="doctorCodes != null and doctorCodes !=''">
			and t2.code in
		<foreach item="item" collection="doctorCodes" open="("
				separator="," close=")">
				#{item,jdbcType=VARCHAR}
			</foreach>
		</if>
		</if>
	</sql>
	

	<sql id="sql_where_hourTime">
		and to_char(to_date(t1.${gh_rc.dimHour}, 'hh24:mi:ss'), 'hh24') =  to_number(#{hourTime})
	</sql>
	
	
	<sql id="sql_where_doctor_code_FY">
		<choose>
			<when test="MzorZyorSs=='MZ'">
				and t1.${yw_mzxx.dimDept} = #{code,jdbcType=VARCHAR}
			</when>
			<when test="MzorZyorSs=='ZY'">
				and t1.${yw_zyxx.dimDept} = #{code,jdbcType=VARCHAR}
			</when>
			<when test="MzorZyorSs=='SS'">
				and t1.${yw_ssfy.dimDept} = #{code,jdbcType=VARCHAR}
			</when>
		</choose>
	</sql>
	<sql id="sql_where_doctor_code_FY_CW">
		<choose>
			<when test="MzorZyorSs=='MZ'">
				and t1.${cw_mzxx.dimDept} = #{code,jdbcType=VARCHAR}
			</when>
			<when test="MzorZyorSs=='ZY'">
				and t1.${cw_zyxx.dimDept} = #{code,jdbcType=VARCHAR}
			</when>
			<when test="MzorZyorSs=='SS'">
				and t1.${cw_ssfy.dimDept} = #{code,jdbcType=VARCHAR}
			</when>
		</choose>
	</sql>
	<sql id="sql_where_doctor_code_RC">
		<choose>
			<when test="MzorZyorSs=='MZ'">
				and t1.${mz_jzrc.dimDept} = #{code,jdbcType=VARCHAR}
			</when>
			<when test="MzorZyorSs=='ZY'">
				and t1.${zy_jzrc.dimDept} = #{code,jdbcType=VARCHAR}
			</when>
			<when test="MzorZyorSs=='SS'">
				and t1.${ss_jzrc.dimDept} = #{code,jdbcType=VARCHAR}
			</when>
		</choose>
	</sql>


	<sql id="sql_where">
		<if test='date != null'> and t1.dim0000001 = #{date,jdbcType=VARCHAR}</if>
		<if test="size != 0">
			and t1.dim0000114 in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
	</sql>
	<sql id="sql_where_fj_fjrc">
		<if test='date != null'> and t1.${fj_fjrc.dimTime} = #{date,jdbcType=VARCHAR}</if>
		<if test="size != 0">
			and t1.${fj_fjrc.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
	</sql>
	<sql id="sql_where_getNursingMS">
		<if test='date != null'> and t1.${hl_rc.dimTime} = #{date,jdbcType=VARCHAR}</if>
		<if test="size != 0">
			and t1.${hl_rc.dimOrganization} in
			<foreach item="item" collection="jgidList" open="(" separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
	</sql>
	<!-- 门诊费用当日sql -->
	<sql id="sql_where_type">
		<choose>
			<when test="whereType=='DRFY'">
				<if test='date != null'> and t1.${dr_mzfy.dimTime} = #{date,jdbcType=VARCHAR}</if>
				<if test="size != 0">
					and t1.${dr_mzfy.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
			<when test="whereType=='YSGZAP'">
				<if test='date != null'> and t1.${ys_gzap.dimTime} = #{date,jdbcType=VARCHAR}</if>
				<if test="size != 0">
					and t1.${ys_gzap.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
		</choose>
	</sql>
	<!--当前月份 -->
	<sql id="sql_nowMonth_where">
		<if test='yf != null'> and t1.dim0000003 = #{yf,jdbcType=VARCHAR}</if>
		<if test="size != 0">
			and t1.dim0000114 in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
	</sql>
	<sql id="sql_nowMonth_where_cw_zyxx">
		<if test='yf != null'> and t1.${cw_zyxx.dimMonth} = #{yf,jdbcType=VARCHAR}</if>
		<if test="size != 0">
			and t1.${cw_zyxx.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
	</sql>
	<sql id="sql_nowMonth_where_yw_zyxx">
		<if test='yf != null'> and t1.${yw_zyxx.dimMonth} = #{yf,jdbcType=VARCHAR}</if>
				<if test="size != 0">
					and t1.${yw_zyxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
	</sql>
	<sql id="sql_nowMonth_where2_yw_mzxx">
		<if test='yf != null'> and t1.${yw_mzxx.dimMonth} = #{yf,jdbcType=VARCHAR}</if>
		<if test="size != 0">
			and t1.${yw_mzxx.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
	</sql>
	<sql id="sql_nowMonth_where2_yw_zyxx">
		<if test='yf != null'> and t1.${yw_zyxx.dimMonth} = #{yf,jdbcType=VARCHAR}</if>
		<if test="size != 0">
			and t1.${yw_zyxx.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
	</sql>
	<sql id="sql_nowMonth_where_mz_ypsr">
		<if test='yf != null'> and t1.${mz_ypsr.dimMonth} = #{yf,jdbcType=VARCHAR}</if>
			<if test="size != 0">
			and t1.${mz_ypsr.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
			</if>
	</sql>
	<sql id="sql_nowMonth_where_zy_ypsr">
		<if test='yf != null'> and t1.${zy_ypsr.dimMonth} = #{yf,jdbcType=VARCHAR}</if>
			<if test="size != 0">
			and t1.${zy_ypsr.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
			</if>
	</sql>
	
	<!--当前月份 -->
	<sql id="sql_nowMonth_where_dr_mzfy_or_dr_zyfy">
		<choose>
			<when test="MZorZY=='MZ'">  
				<if test='yf != null'> and t1.${dr_mzfy.dimMonth} = #{yf,jdbcType=VARCHAR}</if>
				<if test="size != 0">
					and t1.${dr_mzfy.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
			<when test="MZorZY=='ZY'">
				<if test='yf != null'> and t1.${dr_zyfy.dimMonth} = #{yf,jdbcType=VARCHAR}</if>
				<if test="size != 0">
					and t1.${dr_zyfy.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
		</choose>	
	</sql>
	
	<!--业务or财务 当前月份 -->
		<sql id="sql_nowMonth_where_ywOrcw_mzfy_or_zyfy">
		<if test=" CWorYW !='CW' ">
		<choose>
			<when test="MZorZY=='MZ'">  
				<if test='yf != null'> and t1.${yw_mzxx.dimMonth} = #{yf,jdbcType=VARCHAR}</if>
				<if test="size != 0">
					and t1.${yw_mzxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
			<when test="MZorZY=='ZY'">
				<if test='yf != null'> and t1.${yw_zyxx.dimMonth} = #{yf,jdbcType=VARCHAR}</if>
				<if test="size != 0">
					and t1.${yw_zyxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
		</choose>
		</if>	
		
		<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
		<choose>
			<when test="MZorZY=='MZ'">  
				<if test='yf != null'> and t1.${cw_mzxx.dimMonth} = #{yf,jdbcType=VARCHAR}</if>
				<if test="size != 0">
					and t1.${cw_mzxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
			<when test="MZorZY=='ZY'">
				<if test='yf != null'> and t1.${cw_zyxx.dimMonth} = #{yf,jdbcType=VARCHAR}</if>
				<if test="size != 0">
					and t1.${cw_zyxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
		</choose>
		</if>	
	</sql>
	
	<!--同比月份 -->
	<sql id="sql_yearOnYearMonth_where">
		<if test='yearOnYearMonth != null'> and t1.dim0000003 = #{yearOnYearMonth,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.dim0000114 in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
	</sql>
	<sql id="sql_yearOnYearMonth_where_cw_zyxx">
		<if test='yearOnYearMonth != null'> and t1.${cw_zyxx.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${cw_zyxx.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
	</sql>
	<sql id="sql_yearOnYearMonth_where_yw_zyxx">
		<if test='yearOnYearMonth != null'> and t1.${yw_zyxx.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${yw_zyxx.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
	</sql>
	<sql id="sql_yearOnYearMonth_where_mz_ypsr">
		<if test='yearOnYearMonth != null'> and t1.${mz_ypsr.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${mz_ypsr.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
	</sql>
	<sql id="sql_yearOnYearMonth_where_zy_ypsr">
		<if test='yearOnYearMonth != null'> and t1.${zy_ypsr.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${zy_ypsr.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
	</sql>
	
	<!--同比月份 -->
	<sql id="sql_yearOnYearMonth_where_dr_mzfy_or_dr_zyfy">
		<choose>
			<when test="MZorZY=='MZ'">
				<if test='yearOnYearMonth != null'> and t1.${dr_mzfy.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${dr_mzfy.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
			<when test="MZorZY=='ZY'">
				<if test='yearOnYearMonth != null'> and t1.${dr_zyfy.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${dr_zyfy.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
		</choose>
	</sql>
	
	<!--业务or财务 同比月份 -->
	<sql id="sql_yearOnYearMonth_where_ywOrcw_mzfy_or_zyfy">
		<if test=" CWorYW !='CW' ">
		<choose>
			<when test="MZorZY=='MZ'">
				<if test='yearOnYearMonth != null'> and t1.${yw_mzxx.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${yw_mzxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
			<when test="MZorZY=='ZY'">
				<if test='yearOnYearMonth != null'> and t1.${yw_zyxx.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${yw_zyxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
		</choose>
		</if>
		
		<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
		<choose>
			<when test="MZorZY=='MZ'">
				<if test='yearOnYearMonth != null'> and t1.${cw_mzxx.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${cw_mzxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
			<when test="MZorZY=='ZY'">
				<if test='yearOnYearMonth != null'> and t1.${cw_zyxx.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${cw_zyxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
		</choose>
		</if>
	</sql>
	
	<!--环比月份 -->
	<sql id="sql_ringRatioMonth_where">
		<if test='ringRatioMonth != null'>and t1.dim0000003 = #{ringRatioMonth,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.dim0000114 in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
	</sql>
	<sql id="sql_ringRatioMonth_where_cw_zyxx">
		<if test='ringRatioMonth != null'>and t1.${cw_zyxx.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${cw_zyxx.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
	</sql>
	<sql id="sql_ringRatioMonth_where_yw_zyxx">
		<if test='ringRatioMonth != null'>and t1.${yw_zyxx.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${yw_zyxx.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
	</sql>
	<!--环比月份 -->
	<sql id="sql_ringRatioMonth_where_mz_ypsr">
		<if test='ringRatioMonth != null'>and t1.${mz_ypsr.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${mz_ypsr.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
	</sql>
	<!--环比月份 -->
	<sql id="sql_ringRatioMonth_where_zy_ypsr">
		<if test='ringRatioMonth != null'>and t1.${zy_ypsr.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${zy_ypsr.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
	</sql>
	<sql id="sql_ringRatioMonth_where_dr_mzfy_or_dr_zyfy">
		<choose>
			<when test="MZorZY=='MZ'">
				<if test='ringRatioMonth != null'>and t1.${dr_mzfy.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and ${dr_mzfy.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
			<when test="MZorZY=='ZY'">
				<if test='ringRatioMonth != null'>and t1.${dr_zyfy.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and ${dr_zyfy.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
		</choose>
	</sql>
	
	<!-- 业务or财务环比月份 -->
	<sql id="sql_ringRatioMonth_where_ywOrcw_mzfy_or_zyfy">
		<if test=" CWorYW !='CW' ">
		<choose>
			<when test="MZorZY=='MZ'">
				<if test='ringRatioMonth != null'>and t1.${yw_mzxx.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and ${yw_mzxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
			<when test="MZorZY=='ZY'">
				<if test='ringRatioMonth != null'>and t1.${yw_zyxx.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and ${yw_zyxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
		</choose>
		</if>
		
		<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
		<choose>
			<when test="MZorZY=='MZ'">
				<if test='ringRatioMonth != null'>and t1.${cw_mzxx.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and ${cw_mzxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
			<when test="MZorZY=='ZY'">
				<if test='ringRatioMonth != null'>and t1.${cw_zyxx.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and ${cw_zyxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
		</choose>
		</if>
	</sql>
	
	<!--当前日期 -->
	<sql id="sql_now_where">
		<if test='startDate != null'> and t1.dim0000001 >= #{startDate,jdbcType=VARCHAR}</if>
		<if test='endDate != null'>and
			t1.dim0000001 <![CDATA[ <= ]]>
			#{endDate,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.dim0000114 in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
	</sql>
	<sql id="sql_now_where_cw_zyxx">
		<if test='startDate != null'> and t1.${cw_zyxx.dimTime} >= #{startDate,jdbcType=VARCHAR}</if>
		<if test='endDate != null'>and
			t1.${cw_zyxx.dimTime} <![CDATA[ <= ]]>
			#{endDate,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${cw_zyxx.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
	</sql>
	<sql id="sql_now_where_yw_zyxx">
		<if test='startDate != null'> and t1.${yw_zyxx.dimTime} >= #{startDate,jdbcType=VARCHAR}</if>
		<if test='endDate != null'>and
			t1.${yw_zyxx.dimTime} <![CDATA[ <= ]]>
			#{endDate,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${yw_zyxx.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
	</sql>
	
	
	<!--当前日期 -->
	<sql id="sql_now_where_dr_mzfy_or_dr_zyfy">
		 <choose>
			<when test="MZorZY=='MZ'">
				<if test='startDate != null'> and t1.${dr_mzfy.dimTime}	>= 
				#{startDate,jdbcType=VARCHAR}</if>
			<if test='endDate != null'>and
				t1.${dr_mzfy.dimTime} <![CDATA[ <= ]]>
				#{endDate,jdbcType=VARCHAR}
			</if>
		<if test="size != 0">
			and t1.${dr_mzfy.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
			</when>
			<when test="MZorZY=='ZY'">
			<if test='startDate != null'> and t1.${dr_zyfy.dimTime}	>= #{startDate,jdbcType=VARCHAR}</if>
		<if test='endDate != null'>and
			t1.${dr_zyfy.dimTime} <![CDATA[ <= ]]>
			#{endDate,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${dr_zyfy.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
			</when>
		</choose>
	</sql>
	
	<!--财务或者业务 门诊or住院 -->
	<sql id="sql_now_where_ywOrcw_mzfy_or_zyfy">
	<if test=" CWorYW !='CW' ">
		 <choose>
			<when test="MZorZY=='MZ'">
				<if test='startDate != null'> and t1.${yw_mzxx.dimTime}	>= 
				#{startDate,jdbcType=VARCHAR}</if>
			<if test='endDate != null'>and
				t1.${yw_mzxx.dimTime} <![CDATA[ <= ]]>
				#{endDate,jdbcType=VARCHAR}
			</if>
		<if test="size != 0">
			and t1.${yw_mzxx.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		</when>
		<when test="MZorZY=='ZY'">
		<if test='startDate != null'> and t1.${yw_zyxx.dimTime}	>= #{startDate,jdbcType=VARCHAR}</if>
		<if test='endDate != null'>and
			t1.${yw_zyxx.dimTime} <![CDATA[ <= ]]>#{endDate,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${yw_zyxx.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
			</when>
		</choose>
	</if>
	
	<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
		 <choose>
			<when test="MZorZY=='MZ'">
				<if test='startDate != null'> and t1.${cw_mzxx.dimTime}	>= 
				#{startDate,jdbcType=VARCHAR}</if>
			<if test='endDate != null'>and
				t1.${cw_mzxx.dimTime} <![CDATA[ <= ]]>
				#{endDate,jdbcType=VARCHAR}
			</if>
		<if test="size != 0">
			and t1.${cw_mzxx.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		</when>
		<when test="MZorZY=='ZY'">
		<if test='startDate != null'> and t1.${cw_zyxx.dimTime}	>= #{startDate,jdbcType=VARCHAR}</if>
		<if test='endDate != null'>and
			t1.${cw_zyxx.dimTime} <![CDATA[ <= ]]>#{endDate,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${cw_zyxx.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
			</when>
		</choose>
	</if>
	</sql>
	
	
	
	<!--同比日期 -->
	<sql id="sql_yearOnYear_where">
		<if test='yearOnYearStartDate != null'>and t1.dim0000001 >=
			#{yearOnYearStartDate,jdbcType=VARCHAR}
		</if>
		<if test='yearOnYearEndDate != null'>and
			t1.dim0000001 <![CDATA[ <= ]]>
			#{yearOnYearEndDate,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.dim0000114 in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
	</sql>
	<sql id="sql_yearOnYear_where_cw_zyxx">
		<if test='yearOnYearStartDate != null'>and t1.${cw_zyxx.dimTime} >=
			#{yearOnYearStartDate,jdbcType=VARCHAR}
		</if>
		<if test='yearOnYearEndDate != null'>and
			t1.${cw_zyxx.dimTime} <![CDATA[ <= ]]>
			#{yearOnYearEndDate,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${cw_zyxx.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
	</sql>
	<sql id="sql_yearOnYear_where_yw_zyxx">
		<if test='yearOnYearStartDate != null'>and t1.${yw_zyxx.dimTime} >=
			#{yearOnYearStartDate,jdbcType=VARCHAR}
		</if>
		<if test='yearOnYearEndDate != null'>and
			t1.${yw_zyxx.dimTime} <![CDATA[ <= ]]>
			#{yearOnYearEndDate,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${yw_zyxx.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
	</sql>
	
	<!--同比日期 -->
	<sql id="sql_yearOnYear_where_dr_mzfy_or_dr_zyfy">
		<choose>
			<when test="MZorZY=='MZ'">
				<if test='yearOnYearStartDate != null'>and t1.${dr_mzfy.dimTime} >=
					#{yearOnYearStartDate,jdbcType=VARCHAR}
				</if>
				<if test='yearOnYearEndDate != null'>and
					t1.${dr_mzfy.dimTime} <![CDATA[ <= ]]>
					#{yearOnYearEndDate,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${dr_mzfy.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
			<when test="MZorZY=='ZY'">
				<if test='yearOnYearStartDate != null'>and t1.${dr_zyfy.dimTime} >=
					#{yearOnYearStartDate,jdbcType=VARCHAR}
				</if>
				<if test='yearOnYearEndDate != null'>and
					t1.${dr_zyfy.dimTime} <![CDATA[ <= ]]>
					#{yearOnYearEndDate,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${dr_zyfy.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
		</choose>
	</sql>
	
	<!--业务or财务，同比日期 -->
	<sql id="sql_yearOnYear_where_ywOrcw_mzfy_or_zyfy">
		<if test=" CWorYW !='CW' ">
		<choose>
			<when test="MZorZY=='MZ'">
				<if test='yearOnYearStartDate != null'>and t1.${yw_mzxx.dimTime} >=
					#{yearOnYearStartDate,jdbcType=VARCHAR}
				</if>
				<if test='yearOnYearEndDate != null'>and
					t1.${yw_mzxx.dimTime} <![CDATA[ <= ]]>
					#{yearOnYearEndDate,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${yw_mzxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
			<when test="MZorZY=='ZY'">
				<if test='yearOnYearStartDate != null'>and t1.${yw_zyxx.dimTime} >=
					#{yearOnYearStartDate,jdbcType=VARCHAR}
				</if>
				<if test='yearOnYearEndDate != null'>and
					t1.${yw_zyxx.dimTime} <![CDATA[ <= ]]>
					#{yearOnYearEndDate,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${yw_zyxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
		</choose>
		</if>
		<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
		<choose>
			<when test="MZorZY=='MZ'">
				<if test='yearOnYearStartDate != null'>and t1.${cw_mzxx.dimTime} >=
					#{yearOnYearStartDate,jdbcType=VARCHAR}
				</if>
				<if test='yearOnYearEndDate != null'>and
					t1.${cw_mzxx.dimTime} <![CDATA[ <= ]]>
					#{yearOnYearEndDate,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${cw_mzxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
			<when test="MZorZY=='ZY'">
				<if test='yearOnYearStartDate != null'>and t1.${cw_zyxx.dimTime} >=
					#{yearOnYearStartDate,jdbcType=VARCHAR}
				</if>
				<if test='yearOnYearEndDate != null'>and
					t1.${cw_zyxx.dimTime} <![CDATA[ <= ]]>
					#{yearOnYearEndDate,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${cw_zyxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
		</choose>
		</if>
	</sql>
	
	
	<!--环比日期 -->
	<sql id="sql_ringRatio_where">
		<if test='ringRatioStartDate != null'>and t1.dim0000001 >=
			#{ringRatioStartDate,jdbcType=VARCHAR}
		</if>
		<if test='ringRatioEndDate != null'>and
			t1.dim0000001 <![CDATA[ <= ]]>
			#{ringRatioEndDate,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.dim0000114 in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
	</sql>
	<sql id="sql_ringRatio_where_cw_zyxx">
		<if test='ringRatioStartDate != null'>and t1.${cw_zyxx.dimTime} >=
			#{ringRatioStartDate,jdbcType=VARCHAR}
		</if>
		<if test='ringRatioEndDate != null'>and
			t1.${cw_zyxx.dimTime} <![CDATA[ <= ]]>
			#{ringRatioEndDate,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${cw_zyxx.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
	</sql>
	<sql id="sql_ringRatio_where_yw_zyxx">
		<if test='ringRatioStartDate != null'>and t1.${yw_zyxx.dimTime} >=
			#{ringRatioStartDate,jdbcType=VARCHAR}
		</if>
		<if test='ringRatioEndDate != null'>and
			t1.${yw_zyxx.dimTime} <![CDATA[ <= ]]>
			#{ringRatioEndDate,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${yw_zyxx.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
	</sql>
	
	<!--环比日期 -->
	<sql id="sql_ringRatio_where_dr_mzfy_or_dr_zyfy">
		<choose>
			<when test="MZorZY=='MZ'">
				<if test='ringRatioStartDate != null'>and t1.${dr_mzfy.dimTime} >=
					#{ringRatioStartDate,jdbcType=VARCHAR}
				</if>
				<if test='ringRatioEndDate != null'>and
					t1.${dr_mzfy.dimTime} <![CDATA[ <= ]]>
					#{ringRatioEndDate,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${dr_mzfy.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
			<when test="MZorZY=='ZY'">
				<if test='ringRatioStartDate != null'>and t1.${dr_zyfy.dimTime} >=
					#{ringRatioStartDate,jdbcType=VARCHAR}
				</if>
				<if test='ringRatioEndDate != null'>and
					t1.${dr_zyfy.dimTime} <![CDATA[ <= ]]>
					#{ringRatioEndDate,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${dr_zyfy.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
		</choose>
	</sql>
	
	<!--业务or财务 环比日期 -->
	<sql id="sql_ringRatio_where_ywOrcw_mzfy_or_zyfy">
		<if test=" CWorYW !='CW' ">
		<choose>
			<when test="MZorZY=='MZ'">
				<if test='ringRatioStartDate != null'>and t1.${yw_mzxx.dimTime} >=
					#{ringRatioStartDate,jdbcType=VARCHAR}
				</if>
				<if test='ringRatioEndDate != null'>and
					t1.${yw_mzxx.dimTime} <![CDATA[ <= ]]>
					#{ringRatioEndDate,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${yw_mzxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
			<when test="MZorZY=='ZY'">
				<if test='ringRatioStartDate != null'>and t1.${yw_zyxx.dimTime} >=
					#{ringRatioStartDate,jdbcType=VARCHAR}
				</if>
				<if test='ringRatioEndDate != null'>and
					t1.${yw_zyxx.dimTime} <![CDATA[ <= ]]>
					#{ringRatioEndDate,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${yw_zyxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
		</choose>
		</if>
		
		<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
		<choose>
			<when test="MZorZY=='MZ'">
				<if test='ringRatioStartDate != null'>and t1.${cw_mzxx.dimTime} >=
					#{ringRatioStartDate,jdbcType=VARCHAR}
				</if>
				<if test='ringRatioEndDate != null'>and
					t1.${cw_mzxx.dimTime} <![CDATA[ <= ]]>
					#{ringRatioEndDate,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${cw_mzxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
			<when test="MZorZY=='ZY'">
				<if test='ringRatioStartDate != null'>and t1.${cw_zyxx.dimTime} >=
					#{ringRatioStartDate,jdbcType=VARCHAR}
				</if>
				<if test='ringRatioEndDate != null'>and t1.${cw_zyxx.dimTime} <![CDATA[ <= ]]>#{ringRatioEndDate,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${cw_zyxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
		</choose>
		</if>
	</sql>

	<!-- 统计查询  均次费用 start -->
	<sql id="sql_where2_RC">
	<choose>
			<when test="MzorZyorSs=='MZ'">
				<if test='date != null'> and t1.${mz_jzrc.dimTime} = #{date,jdbcType=VARCHAR}</if>
				<if test="size != 0">
					and t1.${mz_jzrc.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
			<when test="MzorZyorSs=='ZY'">
			<if test='date != null'> and t1.${zy_jzrc.dimTime} = #{date,jdbcType=VARCHAR}</if>
				<if test="size != 0">
					and t1.${zy_jzrc.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
			<when test="MzorZyorSs=='SS'">
				<if test='date != null'> and t1.${ss_jzrc.dimTime} = #{date,jdbcType=VARCHAR}</if>
					<if test="size != 0">
						and t1.${ss_jzrc.dimOrganization} in
						<foreach item="item" collection="jgidList" open="("
							separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
			</when>
		</choose>
		
	</sql>
	
	
	<sql id="sql_where2_FY">
		<choose>
			<when test="CWorYW=='YW'">
				<choose>
				<when test="MzorZyorSs=='MZ'">
					<if test='date != null'> and t1.${yw_mzxx.dimTime} = #{date,jdbcType=VARCHAR}</if>
					<if test="size != 0">
						and t1.${yw_mzxx.dimOrganization} in
						<foreach item="item" collection="jgidList" open="("
							separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</when>
				<when test="MzorZyorSs=='ZY'">
				<if test='date != null'> and t1.${yw_zyxx.dimTime} = #{date,jdbcType=VARCHAR}</if>
					<if test="size != 0">
						and t1.${yw_zyxx.dimOrganization} in
						<foreach item="item" collection="jgidList" open="("
							separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</when>
				<when test="MzorZyorSs=='SS'">
					<if test='date != null'> and t1.${yw_ssfy.dimTime} = #{date,jdbcType=VARCHAR}</if>
						<if test="size != 0">
							and t1.${yw_ssfy.dimOrganization} in
							<foreach item="item" collection="jgidList" open="("
								separator="," close=")">
								#{item.jgid,jdbcType=VARCHAR}
							</foreach>
						</if>
				</when>
			</choose>
			</when>
			<when test="CWorYW=='CW'">
				<choose>
				<when test="MzorZyorSs=='MZ'">
					<if test='date != null'> and t1.${cw_mzxx.dimTime} = #{date,jdbcType=VARCHAR}</if>
					<if test="size != 0">
						and t1.${cw_mzxx.dimOrganization} in
						<foreach item="item" collection="jgidList" open="("
							separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</when>
				<when test="MzorZyorSs=='ZY'">
				<if test='date != null'> and t1.${cw_zyxx.dimTime} = #{date,jdbcType=VARCHAR}</if>
					<if test="size != 0">
						and t1.${cw_zyxx.dimOrganization} in
						<foreach item="item" collection="jgidList" open="("
							separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</when>
				<when test="MzorZyorSs=='SS'">
					<if test='date != null'> and t1.${cw_ssfy.dimTime} = #{date,jdbcType=VARCHAR}</if>
						<if test="size != 0">
							and t1.${cw_ssfy.dimOrganization} in
							<foreach item="item" collection="jgidList" open="("
								separator="," close=")">
								#{item.jgid,jdbcType=VARCHAR}
							</foreach>
						</if>
				</when>
			</choose>
			</when>
		</choose>
		
		
	</sql>
	
	
	<!--当前月份 -->
	<sql id="sql_nowMonth_where2_FY">
		<choose>
			<when test="CWorYW=='YW'">
				<choose>
					<when test="MzorZyorSs=='MZ'">
					<if test='yf != null'> and t1.${yw_mzxx.dimMonth}= #{yf,jdbcType=VARCHAR}</if>
					<if test="size != 0">
						and t1.${yw_mzxx.dimOrganization} in
						<foreach item="item" collection="jgidList" open="("
							separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
					</when>
					<when test="MzorZyorSs=='ZY'">
					<if test='yf != null'> and t1.${yw_zyxx.dimMonth}= #{yf,jdbcType=VARCHAR}</if>
					<if test="size != 0">
						and t1.${yw_zyxx.dimOrganization} in
						<foreach item="item" collection="jgidList" open="("
							separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
					</when>
					<when test="MzorZyorSs=='SS'">
					<if test='yf != null'> and t1.${yw_ssfy.dimMonth}= #{yf,jdbcType=VARCHAR}</if>
					<if test="size != 0">
						and t1.${yw_ssfy.dimOrganization} in
						<foreach item="item" collection="jgidList" open="("
							separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
					</when>
				</choose>
			</when>
			<when test="CWorYW=='CW'">
				<choose>
					<when test="MzorZyorSs=='MZ'">
					<if test='yf != null'> and t1.${cw_mzxx.dimMonth}= #{yf,jdbcType=VARCHAR}</if>
					<if test="size != 0">
						and t1.${cw_mzxx.dimOrganization} in
						<foreach item="item" collection="jgidList" open="("
							separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</when>
					<when test="MzorZyorSs=='ZY'">
					<if test='yf != null'> and t1.${cw_zyxx.dimMonth}= #{yf,jdbcType=VARCHAR}</if>
					<if test="size != 0">
						and t1.${cw_zyxx.dimOrganization} in
						<foreach item="item" collection="jgidList" open="("
							separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
					</when>
				<when test="MzorZyorSs=='SS'">
				<if test='yf != null'> and t1.${cw_ssfy.dimMonth}= #{yf,jdbcType=VARCHAR}</if>
				<if test="size != 0">
					and t1.${cw_ssfy.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
				</when>
			</choose>
			</when>
		</choose>
	</sql>
	
	<sql id="sql_nowMonth_where2_RC">
	<choose>
			<when test="MzorZyorSs=='MZ'">
			<if test='yf != null'> and t1.${mz_jzrc.dimMonth}= #{yf,jdbcType=VARCHAR}</if>
			<if test="size != 0">
				and t1.${mz_jzrc.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
			<when test="MzorZyorSs=='ZY'">
			<if test='yf != null'> and t1.${zy_jzrc.dimMonth}= #{yf,jdbcType=VARCHAR}</if>
			<if test="size != 0">
				and t1.${zy_jzrc.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
			<when test="MzorZyorSs=='SS'">
			<if test='yf != null'> and t1.${ss_jzrc.dimMonth}= #{yf,jdbcType=VARCHAR}</if>
			<if test="size != 0">
				and t1.${ss_jzrc.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
		</choose>
		
	</sql>
	
	
	
	<!--同比月份 -->
	<sql id="sql_yearOnYearMonth_where2_FY">
		<choose>
			<when test="CWorYW=='YW'">
				<choose>
			<when test="MzorZyorSs=='MZ'">
			<if test='yearOnYearMonth != null'> and t1.${yw_mzxx.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${yw_mzxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
			<when test="MzorZyorSs=='ZY'">
				<if test='yearOnYearMonth != null'> and t1.${yw_zyxx.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${yw_zyxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
			<when test="MzorZyorSs=='SS'">
				<if test='yearOnYearMonth != null'> and t1.${yw_ssfy.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${yw_ssfy.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
		</choose>
			</when>
			<when test="CWorYW=='CW'">
				<choose>
			<when test="MzorZyorSs=='MZ'">
			<if test='yearOnYearMonth != null'> and t1.${cw_mzxx.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${cw_mzxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
			<when test="MzorZyorSs=='ZY'">
				<if test='yearOnYearMonth != null'> and t1.${cw_zyxx.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${cw_zyxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
			<when test="MzorZyorSs=='SS'">
				<if test='yearOnYearMonth != null'> and t1.${cw_ssfy.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${cw_ssfy.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
		</choose>
			</when>
		</choose>
		
		
	</sql>
	
	<sql id="sql_yearOnYearMonth_where2_RC">
	<choose>
			<when test="MzorZyorSs=='MZ'">
			<if test='yearOnYearMonth != null'> and t1.${mz_jzrc.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${mz_jzrc.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
			<when test="MzorZyorSs=='ZY'">
				<if test='yearOnYearMonth != null'> and t1.${zy_jzrc.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${zy_jzrc.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
			<when test="MzorZyorSs=='SS'">
				<if test='yearOnYearMonth != null'> and t1.${ss_jzrc.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${ss_jzrc.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
		</choose>
		
	</sql>
	
	
	<!--环比月份 -->
	<sql id="sql_ringRatioMonth_where2_FY">
		<choose>
			<when test="CWorYW=='YW'">
				<choose>
			<when test="MzorZyorSs=='MZ'">
				<if test='ringRatioMonth != null'>and t1.${yw_mzxx.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${yw_mzxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
			<when test="MzorZyorSs=='ZY'">
				<if test='ringRatioMonth != null'>and t1.${yw_zyxx.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${yw_zyxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
			</if>
			</when>
			<when test="MzorZyorSs=='SS'">
				<if test='ringRatioMonth != null'>and t1.${yw_ssfy.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${yw_ssfy.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
		</choose>
			</when>
			<when test="CWorYW=='CW'">
				<choose>
			<when test="MzorZyorSs=='MZ'">
				<if test='ringRatioMonth != null'>and t1.${cw_mzxx.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${cw_mzxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
			<when test="MzorZyorSs=='ZY'">
				<if test='ringRatioMonth != null'>and t1.${cw_zyxx.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${cw_zyxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
			</if>
			</when>
			<when test="MzorZyorSs=='SS'">
				<if test='ringRatioMonth != null'>and t1.${cw_ssfy.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${cw_ssfy.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
		</choose>
			</when>
		</choose>
			
		
		
	</sql>
	
	<sql id="sql_ringRatioMonth_where2_RC">
	<choose>
			<when test="MzorZyorSs=='MZ'">
				<if test='ringRatioMonth != null'>and t1.${mz_jzrc.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${mz_jzrc.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
			<when test="MzorZyorSs=='ZY'">
				<if test='ringRatioMonth != null'>and t1.${zy_jzrc.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${zy_jzrc.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
			</if>
			</when>
			<when test="MzorZyorSs=='SS'">
				<if test='ringRatioMonth != null'>and t1.${ss_jzrc.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${ss_jzrc.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
		</choose>
		
	</sql>
	
	
	
	<!--当前日期 -->
	<sql id="sql_now_where2_FY">
		<choose>
			<when test="CWorYW=='YW'">
				<choose>
			<when test="MzorZyorSs=='MZ'">
			<if test='startDate != null'> and t1.${yw_mzxx.dimTime} >= #{startDate,jdbcType=VARCHAR}</if>
			<if test='endDate != null'>and
			t1.${yw_mzxx.dimTime} <![CDATA[ <= ]]>
			#{endDate,jdbcType=VARCHAR}
			</if>
			<if test="size != 0">
				and t1.${yw_mzxx.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
			<when test="MzorZyorSs=='ZY'">
			<if test='startDate != null'> and t1.${yw_zyxx.dimTime} >= #{startDate,jdbcType=VARCHAR}</if>
			<if test='endDate != null'>and
			t1.${yw_zyxx.dimTime} <![CDATA[ <= ]]>
			#{endDate,jdbcType=VARCHAR}
			</if>
			<if test="size != 0">
				and t1.${yw_zyxx.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
			<when test="MzorZyorSs=='SS'">
			<if test='startDate != null'> and t1.${yw_ssfy.dimTime} >= #{startDate,jdbcType=VARCHAR}</if>
			<if test='endDate != null'>and
			t1.${yw_ssfy.dimTime} <![CDATA[ <= ]]>
			#{endDate,jdbcType=VARCHAR}
			</if>
			<if test="size != 0">
				and t1.${yw_ssfy.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
		</choose>
			</when>
			<when test="CWorYW=='CW'">
				<choose>
			<when test="MzorZyorSs=='MZ'">
			<if test='startDate != null'> and t1.${cw_mzxx.dimTime} >= #{startDate,jdbcType=VARCHAR}</if>
			<if test='endDate != null'>and
			t1.${cw_mzxx.dimTime} <![CDATA[ <= ]]>
			#{endDate,jdbcType=VARCHAR}
			</if>
			<if test="size != 0">
				and t1.${cw_mzxx.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
			<when test="MzorZyorSs=='ZY'">
			<if test='startDate != null'> and t1.${cw_zyxx.dimTime} >= #{startDate,jdbcType=VARCHAR}</if>
			<if test='endDate != null'>and
			t1.${cw_zyxx.dimTime} <![CDATA[ <= ]]>
			#{endDate,jdbcType=VARCHAR}
			</if>
			<if test="size != 0">
				and t1.${cw_zyxx.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
			<when test="MzorZyorSs=='SS'">
			<if test='startDate != null'> and t1.${cw_ssfy.dimTime} >= #{startDate,jdbcType=VARCHAR}</if>
			<if test='endDate != null'>and
			t1.${cw_ssfy.dimTime} <![CDATA[ <= ]]>
			#{endDate,jdbcType=VARCHAR}
			</if>
			<if test="size != 0">
				and t1.${cw_ssfy.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
		</choose>
			</when>
		</choose>
		
		
	</sql>
	
	
	<sql id="sql_now_where2_RC">
	<choose>
			<when test="MzorZyorSs=='MZ'">
			<if test='startDate != null'> and t1.${mz_jzrc.dimTime} >= #{startDate,jdbcType=VARCHAR}</if>
			<if test='endDate != null'>and
			t1.${mz_jzrc.dimTime} <![CDATA[ <= ]]>
			#{endDate,jdbcType=VARCHAR}
			</if>
			<if test="size != 0">
				and t1.${mz_jzrc.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
			<when test="MzorZyorSs=='ZY'">
			<if test='startDate != null'> and t1.${zy_jzrc.dimTime} >= #{startDate,jdbcType=VARCHAR}</if>
			<if test='endDate != null'>and
			t1.${zy_jzrc.dimTime} <![CDATA[ <= ]]>
			#{endDate,jdbcType=VARCHAR}
			</if>
			<if test="size != 0">
				and t1.${zy_jzrc.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
			<when test="MzorZyorSs=='SS'">
			<if test='startDate != null'> and t1.${ss_jzrc.dimTime} >= #{startDate,jdbcType=VARCHAR}</if>
			<if test='endDate != null'>and
			t1.${ss_jzrc.dimTime} <![CDATA[ <= ]]>
			#{endDate,jdbcType=VARCHAR}
			</if>
			<if test="size != 0">
				and t1.${ss_jzrc.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
		</choose>
		
	</sql>
	
	<!--同比日期 -->
	<sql id="sql_yearOnYear_where2_FY">
		<choose>
			<when test="CWorYW=='YW'">
				<choose>
			<when test="MzorZyorSs=='MZ'">
			<if test='yearOnYearStartDate != null'>and t1.${yw_mzxx.dimTime} >=
			#{yearOnYearStartDate,jdbcType=VARCHAR}
			</if>
			<if test='yearOnYearEndDate != null'>and
				t1.${yw_mzxx.dimTime} <![CDATA[ <= ]]>
				#{yearOnYearEndDate,jdbcType=VARCHAR}
			</if>
			<if test="size != 0">
				and t1.${yw_mzxx.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
			<when test="MzorZyorSs=='ZY'">
			<if test='yearOnYearStartDate != null'>and t1.${yw_zyxx.dimTime} >=
			#{yearOnYearStartDate,jdbcType=VARCHAR}
			</if>
			<if test='yearOnYearEndDate != null'>and
				t1.${yw_zyxx.dimTime} <![CDATA[ <= ]]>
				#{yearOnYearEndDate,jdbcType=VARCHAR}
			</if>
			<if test="size != 0">
				and t1.${yw_zyxx.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
			<when test="MzorZyorSs=='SS'">
			<if test='yearOnYearStartDate != null'>and t1.${yw_ssfy.dimTime} >=
			#{yearOnYearStartDate,jdbcType=VARCHAR}
			</if>
			<if test='yearOnYearEndDate != null'>and
				t1.${yw_ssfy.dimTime} <![CDATA[ <= ]]>
				#{yearOnYearEndDate,jdbcType=VARCHAR}
			</if>
			<if test="size != 0">
				and t1.${yw_ssfy.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
		</choose>
			</when>
			<when test="CWorYW=='CW'">
				<choose>
			<when test="MzorZyorSs=='MZ'">
			<if test='yearOnYearStartDate != null'>and t1.${cw_mzxx.dimTime} >=
			#{yearOnYearStartDate,jdbcType=VARCHAR}
			</if>
			<if test='yearOnYearEndDate != null'>and
				t1.${cw_mzxx.dimTime} <![CDATA[ <= ]]>
				#{yearOnYearEndDate,jdbcType=VARCHAR}
			</if>
			<if test="size != 0">
				and t1.${cw_mzxx.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
			<when test="MzorZyorSs=='ZY'">
			<if test='yearOnYearStartDate != null'>and t1.${cw_zyxx.dimTime} >=
			#{yearOnYearStartDate,jdbcType=VARCHAR}
			</if>
			<if test='yearOnYearEndDate != null'>and
				t1.${cw_zyxx.dimTime} <![CDATA[ <= ]]>
				#{yearOnYearEndDate,jdbcType=VARCHAR}
			</if>
			<if test="size != 0">
				and t1.${cw_zyxx.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
			<when test="MzorZyorSs=='SS'">
			<if test='yearOnYearStartDate != null'>and t1.${cw_ssfy.dimTime} >=
			#{yearOnYearStartDate,jdbcType=VARCHAR}
			</if>
			<if test='yearOnYearEndDate != null'>and
				t1.${cw_ssfy.dimTime} <![CDATA[ <= ]]>
				#{yearOnYearEndDate,jdbcType=VARCHAR}
			</if>
			<if test="size != 0">
				and t1.${cw_ssfy.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
		</choose>
			</when>
		</choose>
			
		
		
	</sql>
	
	
	<sql id="sql_yearOnYear_where2_RC">
	<choose>
			<when test="MzorZyorSs=='MZ'">
			<if test='yearOnYearStartDate != null'>and t1.${mz_jzrc.dimTime} >=
			#{yearOnYearStartDate,jdbcType=VARCHAR}
			</if>
			<if test='yearOnYearEndDate != null'>and
				t1.${mz_jzrc.dimTime} <![CDATA[ <= ]]>
				#{yearOnYearEndDate,jdbcType=VARCHAR}
			</if>
			<if test="size != 0">
				and t1.${mz_jzrc.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
			<when test="MzorZyorSs=='ZY'">
			<if test='yearOnYearStartDate != null'>and t1.${zy_jzrc.dimTime} >=
			#{yearOnYearStartDate,jdbcType=VARCHAR}
			</if>
			<if test='yearOnYearEndDate != null'>and
				t1.${zy_jzrc.dimTime} <![CDATA[ <= ]]>
				#{yearOnYearEndDate,jdbcType=VARCHAR}
			</if>
			<if test="size != 0">
				and t1.${zy_jzrc.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
			<when test="MzorZyorSs=='SS'">
			<if test='yearOnYearStartDate != null'>and t1.${ss_jzrc.dimTime} >=
			#{yearOnYearStartDate,jdbcType=VARCHAR}
			</if>
			<if test='yearOnYearEndDate != null'>and
				t1.${ss_jzrc.dimTime} <![CDATA[ <= ]]>
				#{yearOnYearEndDate,jdbcType=VARCHAR}
			</if>
			<if test="size != 0">
				and t1.${ss_jzrc.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
		</choose>
		
	</sql>
	
	<!--环比日期 -->
	<sql id="sql_ringRatio_where2_FY">
		<choose>
			<when test="CWorYW=='YW'">
				<choose>
			<when test="MzorZyorSs=='MZ'">
			<if test='ringRatioStartDate != null'>and t1.${yw_mzxx.dimTime} >=
			#{ringRatioStartDate,jdbcType=VARCHAR}
			</if>
			<if test='ringRatioEndDate != null'>and
				t1.${yw_mzxx.dimTime} <![CDATA[ <= ]]>
				#{ringRatioEndDate,jdbcType=VARCHAR}
			</if>
			<if test="size != 0">
				and t1.${yw_mzxx.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
			<when test="MzorZyorSs=='ZY'">
			<if test='ringRatioStartDate != null'>and t1.${yw_zyxx.dimTime} >=
			#{ringRatioStartDate,jdbcType=VARCHAR}
			</if>
			<if test='ringRatioEndDate != null'>and
				t1.${yw_zyxx.dimTime} <![CDATA[ <= ]]>
				#{ringRatioEndDate,jdbcType=VARCHAR}
			</if>
			<if test="size != 0">
				and t1.${yw_zyxx.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
			<when test="MzorZyorSs=='SS'">
			<if test='ringRatioStartDate != null'>and t1.${yw_ssfy.dimTime} >=
			#{ringRatioStartDate,jdbcType=VARCHAR}
			</if>
			<if test='ringRatioEndDate != null'>and
				t1.${yw_ssfy.dimTime} <![CDATA[ <= ]]>
				#{ringRatioEndDate,jdbcType=VARCHAR}
			</if>
			<if test="size != 0">
				and t1.${yw_ssfy.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
		</choose>
			</when>
			<when test="CWorYW=='CW'">
				<choose>
			<when test="MzorZyorSs=='MZ'">
			<if test='ringRatioStartDate != null'>and t1.${cw_mzxx.dimTime} >=
			#{ringRatioStartDate,jdbcType=VARCHAR}
			</if>
			<if test='ringRatioEndDate != null'>and
				t1.${cw_mzxx.dimTime} <![CDATA[ <= ]]>
				#{ringRatioEndDate,jdbcType=VARCHAR}
			</if>
			<if test="size != 0">
				and t1.${cw_mzxx.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
			<when test="MzorZyorSs=='ZY'">
			<if test='ringRatioStartDate != null'>and t1.${cw_zyxx.dimTime} >=
			#{ringRatioStartDate,jdbcType=VARCHAR}
			</if>
			<if test='ringRatioEndDate != null'>and
				t1.${cw_zyxx.dimTime} <![CDATA[ <= ]]>
				#{ringRatioEndDate,jdbcType=VARCHAR}
			</if>
			<if test="size != 0">
				and t1.${cw_zyxx.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
			<when test="MzorZyorSs=='SS'">
			<if test='ringRatioStartDate != null'>and t1.${cw_ssfy.dimTime} >=
			#{ringRatioStartDate,jdbcType=VARCHAR}
			</if>
			<if test='ringRatioEndDate != null'>and
				t1.${cw_ssfy.dimTime} <![CDATA[ <= ]]>
				#{ringRatioEndDate,jdbcType=VARCHAR}
			</if>
			<if test="size != 0">
				and t1.${cw_ssfy.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
		</choose>
			</when>
		</choose>
		
		
	</sql>
	
	
	<sql id="sql_ringRatio_where2_RC">
	<choose>
			<when test="MzorZyorSs=='MZ'">
			<if test='ringRatioStartDate != null'>and t1.${mz_jzrc.dimTime} >=
			#{ringRatioStartDate,jdbcType=VARCHAR}
			</if>
			<if test='ringRatioEndDate != null'>and
				t1.${mz_jzrc.dimTime} <![CDATA[ <= ]]>
				#{ringRatioEndDate,jdbcType=VARCHAR}
			</if>
			<if test="size != 0">
				and t1.${mz_jzrc.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
			<when test="MzorZyorSs=='ZY'">
			<if test='ringRatioStartDate != null'>and t1.${zy_jzrc.dimTime} >=
			#{ringRatioStartDate,jdbcType=VARCHAR}
			</if>
			<if test='ringRatioEndDate != null'>and
				t1.${zy_jzrc.dimTime} <![CDATA[ <= ]]>
				#{ringRatioEndDate,jdbcType=VARCHAR}
			</if>
			<if test="size != 0">
				and t1.${zy_jzrc.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
			<when test="MzorZyorSs=='SS'">
			<if test='ringRatioStartDate != null'>and t1.${ss_jzrc.dimTime} >=
			#{ringRatioStartDate,jdbcType=VARCHAR}
			</if>
			<if test='ringRatioEndDate != null'>and
				t1.${ss_jzrc.dimTime} <![CDATA[ <= ]]>
				#{ringRatioEndDate,jdbcType=VARCHAR}
			</if>
			<if test="size != 0">
				and t1.${ss_jzrc.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			</when>
		</choose>
		
	</sql>
	
	<!-- 门诊费用当日 -->
	<select id="getDigitalHospitalIncome" resultType="DigitalHospitalIncome"
		parameterType="hashmap">
		select
		<if test="size >1 ">
			sum(a.zfy + b.zfy) as totalIncomeToday,'全部' as
			hospitalName,'' as jgid
		</if>
		<if test="size ==1 ">
			(a.zfy + b.zfy) as totalIncomeToday, a.text as
			hospitalName,a.code as jgid
		</if>

		from (select sum(${dr_mzfy.indbName_value}) zfy, t2.code, t2.text
		from ${dr_mzfy.indbName_value} t1,
		${dr_mzfy.dimOrganization} t2
		where 1 = 1
		and t1.${dr_mzfy.dimOrganization} = t2.code
		<include refid="sql_where_type" />

		group by t2.code, t2.text) a,
		(select sum(${dr_zyfy.indbName_value}) zfy, t2.code,
		t2.text
		from ${dr_zyfy.indbName_value} t1, ${dr_zyfy.dimOrganization} t2
		where 1 = 1
		and t1.${dr_zyfy.dimOrganization} =
		t2.code
		<include refid="sql_where_type" />
		group by t2.code, t2.text) b
		where a.code = b.code
	</select>

	<!-- 今日医生排班列表 -->
	<select id="getDigitalHospitalOutDoc" resultType="DigitalHospitalOutDoc"
		parameterType="hashmap">
		select
		t1.${ys_gzap.dimTime} jgid,
		nvl(t1.${ys_gzap.dimTotalNumber},0) countNum,
		nvl(t1.${ys_gzap.dimResidueNumber},0) lastNum,
		t3.text docName,
		t3.code docJobNum,
		t2.text docDept,
		t2.code docDeptId,
		t1.${ys_gzap.dimWorkTime} amOrPm
		from ${ys_gzap.indbName_value}
		t1, ${ys_gzap.dimDept} t2, ${ys_gzap.dimDoctor} t3
		where t1.${ys_gzap.dimDept} = t2.code
		and
		t1.${ys_gzap.dimDoctor} = t3.code
		and t1.${ys_gzap.dimDoctor} = t3.code
		and t1.${ys_gzap.dimSjc} =
		(select max(t1.${ys_gzap.dimSjc}) from ${ys_gzap.indbName_value} t1 where
		1=1
		<include refid="sql_where_type" />
		)
		and t1.${ys_gzap.dimWorkStatus} = '看诊'
		<include refid="sql_where_type" />
		order by t2.dimorder


	</select>

	<!-- 获取首页手术信息 -->
	<select id="getDigitalHospitalTodayOperation" resultType="DigitalHospitalTodayOperation"
		parameterType="hashmap">
		select
		sum(applicationsNum) applicationsNum,
		sum(finishToday)
		finishToday,
		sum(arrangementQuantity) arrangementQuantity,
		sum(tomorrowArrangement) tomorrowArrangement
		from (
		--安排
		select
		t1.${ss_aptc.dimOrganization} jgid,
		0 applicationsNum,
		0 finishToday,
		sum(${ss_aptc.indbName_value})
		arrangementQuantity,
		0 tomorrowArrangement
		from ${ss_aptc.indbName_value} t1
		where 1=1
<!-- 		<include refid="sql_where" /> -->
		<if test='date != null'> and t1.${ss_aptc.dimTime} = #{date,jdbcType=VARCHAR}</if>
		<if test="size != 0">
			and t1.${ss_aptc.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>

		group by t1.${ss_aptc.dimOrganization}
		union
		--完成
		select t1.${ss_wctc.dimOrganization} jgid,
		0
		applicationsNum,
		sum(${ss_wctc.indbName_value}) finishToday,
		0 arrangementQuantity,
		0
		tomorrowArrangement
		from ${ss_wctc.indbName_value} t1
		where 1=1
<!-- 		<include refid="sql_where" /> -->
		<if test='date != null'> and t1.${ss_wctc.dimTime} = #{date,jdbcType=VARCHAR}</if>
		<if test="size != 0">
			and t1.${ss_wctc.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		group by t1.${ss_wctc.dimOrganization}
		union
		--申请
		select t1.${ss_sqtc.dimOrganization} jgid,
		sum(${ss_sqtc.indbName_value}) applicationsNum,
		0 finishToday,
		0 arrangementQuantity,
		0
		tomorrowArrangement
		from ${ss_sqtc.indbName_value} t1
		where 1=1
<!-- 		<include refid="sql_where" /> -->
		<if test='date != null'> and t1.${ss_sqtc.dimTime} = #{date,jdbcType=VARCHAR}</if>
		<if test="size != 0">
			and t1.${ss_sqtc.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		group by t1.${ss_sqtc.dimOrganization}
		union
		-- 明日安排
		select t1.${ss_aptc.dimOrganization} jgid,
		0
		applicationsNum,
		0 finishToday,
		0 arrangementQuantity,
		sum(${ss_aptc.indbName_value})
		tomorrowArrangement
		from ${ss_aptc.indbName_value} t1
		where to_char(to_date(${ss_aptc.dimTime},
		'yyyy-mm-dd') - 1, 'yyyy-mm-dd') =
		#{date,jdbcType=VARCHAR}
		<if test="size != 0">
			and t1.${ss_aptc.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		group by t1.${ss_aptc.dimOrganization}
		)
	</select>
	
	<!-- 获取首页病区护理信息 -->
	<select id="getNursingMS" resultType="hashmap" parameterType="hashmap">
		select t2.code, t2.text, sum(${hl_rc.indbName_value}) as rc
		from ${hl_rc.indbName_value} t1
		left
		join ${hl_rc.dimHljB} t2
		on t1.${hl_rc.dimHljB} = t2.code
		where 1 = 1
		and t1.${hl_rc.dimSjc} = (select max(t1.${hl_rc.dimSjc}) from ${hl_rc.indbName_value} t1 
		where 1=1
		<include refid="sql_where_getNursingMS" />
		)
		<include refid="sql_where_getNursingMS" />
		group by t2.code, t2.text
		order by t2.code
	</select>
	
	<!-- 获取病人出入院信息 -->
	<select id="getEntranceAndExitMS" resultType="hashmap"	parameterType="hashmap">
		select sum(t1.${ry_rc.indbName_value}) RC, '入院' TEXT
		from ${ry_rc.indbName_value} t1
		<where>
			<if test='date != null'>t1.${ry_rc.dimTime} = #{date,jdbcType=VARCHAR}</if>
			<if test="size != 0">
				and t1.${ry_rc.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
		</where>
		union
		select sum(t1.${zy_rc.indbName_value}) RC, '在院' TEXT
		from ${zy_rc.indbName_value} t1
		where 1=1
		<if test='date != null'>and t1.${zy_rc.dimTime} = #{date,jdbcType=VARCHAR}</if>
		<if test="size != 0">
			and t1.${zy_rc.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		union
		select sum(t1.${cy_rc.indbName_value}) RC, '出院' TEXT
		from ${cy_rc.indbName_value} t1
		<where>
			<if test='date != null'>t1.${cy_rc.dimTime} = #{date,jdbcType=VARCHAR}</if>
			<if test="size != 0">
				and t1.${cy_rc.dimOrganization} in
				<foreach item="item" collection="jgidList" open="("
					separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
		</where>
		union
		select sum(${zywz_rc.indbName_value}) RC, '危重' TEXT
		from ${zywz_rc.indbName_value} t1
		where 1 = 1
		<if test='date != null'>and t1.${zywz_rc.dimTime} = #{date,jdbcType=VARCHAR}</if>
		<if test="size != 0">
			and t1.${zywz_rc.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
	</select>
	
	<!-- 综合日报	总收入、日均收入 -->
	<sql id="sql_getComprehensiveMonthlyRep">
		select sum(fy) as dailyIncome,to_char(to_date(dimTime,'yyyy-mm-dd'), 'dd') as day,
		(case when #{yf,jdbcType=VARCHAR} =to_char(sysdate,'yyyy-mm')
			then to_char(sysdate, 'dd') -1 
			else to_number(to_char(last_day(to_date(#{yf,jdbcType=VARCHAR},'yyyy-mm')), 'dd')) 
			end) as totalDays
		from (
				select sum(${cw_zyxx.indbName_value}) fy,t1.${cw_zyxx.dimTime} dimTime, t2.code, t2.text
				from ${cw_zyxx.indbName_value} t1, ${cw_zyxx.dimOrganization} t2 
				where t1.${cw_zyxx.dimOrganization} = t2.code
				<if test='yf != null'>
				 	and t1.${cw_zyxx.dimMonth} = #{yf,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${cw_zyxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="(" separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
				group by t1.${cw_zyxx.dimTime}, t2.code, t2.text
				union
				select sum(${cw_mzxx.indbName_value}) fy,t1.${cw_mzxx.dimTime} dimTime,t2.code,t2.text
				from ${cw_mzxx.indbName_value} t1, ${cw_mzxx.dimOrganization} t2
				where t1.${cw_mzxx.dimOrganization} = t2.code
				<if test='yf != null'>
				 	and t1.${cw_mzxx.dimMonth} = #{yf,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${cw_mzxx.dimOrganization} in
					<foreach item="item" collection="jgidList" open="(" separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
				group by t1.${cw_mzxx.dimTime}, t2.code, t2.text
			)
		group by dimTime
		order by dimTime
	</sql>

	<!--  综合日报-选择月份每日明细 -->
	<select id="getComprehensiveMonthlyRepByDay" resultType="ComprehensiveMonthlyRepByDay" parameterType="hashmap">
		<include refid="sql_getComprehensiveMonthlyRep" />
	</select>

	<!-- 综合日报-总收入、日均收入 -->
	<select id="getComprehensiveMonthlyRep" resultType="ComprehensiveMonthlyRep" parameterType="hashmap">
		select round(sum(dailyIncome) /
		(case when #{yf,jdbcType=VARCHAR} =
		to_char(sysdate,'yyyy-mm')
		then to_char(sysdate, 'dd') -1 else
		to_number(to_char(last_day(to_date(#{yf,jdbcType=VARCHAR},
		'yyyy-mm')), 'dd'))
		end) , 4)
		dailyIncomeAvg,
		sum(dailyIncome) as
		monthlyIncome from (
		<include refid="sql_getComprehensiveMonthlyRep" />
		)
	</select>

	<!-- 今日手术安排列表 -->
	<select id="getSurgicalArrangementList" resultType="hashmap" parameterType="hashmap">
		select t1.${br_ssxx.dimOperationTime} operationTime,t1.${br_ssxx.dimDoctor} doctor,t1.${br_ssxx.dimPatientName} patientName,
		t1.${br_ssxx.dimAge} age,t1.${br_ssxx.dimSex} gender,t1.${br_ssxx.dimOperationName} operativeName,t2.code departId,
		t2.text department,t1.${br_ssxx.dimFirstDoctor} zmys,t1.${br_ssxx.dimFirstNurse} xhhs,t1.${br_ssxx.dimSecondDoctor} fmys,t1.${br_ssxx.dimSecondNurse} xshs
		from ${br_ssxx.indbName_value} t1, ${br_ssxx.dimDept} t2
		where t1.${br_ssxx.dimDept} = t2.code and t1.${br_ssxx.dimSecondDept} = '01'
		<if test='date != null'>
			and t1.${br_ssxx.dimTime} = #{date,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${br_ssxx.dimOrganization} in
			<foreach item="item" collection="jgidList" open="(" separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		order by t1.${br_ssxx.dimOperationTime}
	</select>

	<!-- 门急诊人数统计 -->
	<select id="getTodayEmergencyVolumeTotal" resultType="hashmap" parameterType="hashmap">
		select sum(mzrc) as "doorEmergencyRegTotalNum",sum(jzrc) as "emergencyNum" from(
			select sum(${mzgh_rc.indbName_value}) as mzrc,0 jzrc 
			from ${mzgh_rc.indbName_value} t1
			where 1=1
			<if test='date != null'> and t1.${mzgh_rc.dimTime} = #{date,jdbcType=VARCHAR}</if>
			<if test="size != 0">
				and t1.${mzgh_rc.dimOrganization} in
				<foreach item="item" collection="jgidList" open="(" separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			union
			select 0 mzrc,sum(${jzgh_rc.indbName_value}) as jzrc 
			from ${jzgh_rc.indbName_value} t1
			where 1=1
			<if test='date != null'> and t1.${jzgh_rc.dimTime} = #{date,jdbcType=VARCHAR}</if>
			<if test="size != 0">
				and t1.${jzgh_rc.dimOrganization} in
				<foreach item="item" collection="jgidList" open="(" separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
		)
	</select>

	<!-- 今日辅捡量（合计） -->
	<select id="getTodayAccessoryExaminationTotal" resultType="hashmap" parameterType="hashmap">
		select sum(${fj_fjrc.indbName_value}) as rc,t2.code,t2.text
		from ${fj_fjrc.indbName_value} t1,${fj_fjrc.dimFjnx} t2,${fj_fjrc.dimOrganization} t3
		where t1.${fj_fjrc.dimFjnx} = t2.code and t1.${fj_fjrc.dimOrganization} = t3.code
	<!-- 现在指标改为按日查询  不按月-->
		<include refid="sql_where_fj_fjrc" />
		and t1.${fj_fjrc.dimMzOrZy} = '1'
		group by t2.code,t2.text
	</select>
	
	<select id="getInpatientAssistantExaminationMS" resultType="hashmap"
		parameterType="hashmap">
		select sum(${fj_fjrc.indbName_value}) as rc,t2.code,t2.text from ${fj_fjrc.indbName_value}
		t1,${fj_fjrc.dimFjnx} t2,${fj_fjrc.dimOrganization} t3
		where t1.${fj_fjrc.dimFjnx} = t2.code and t1.${fj_fjrc.dimOrganization} = t3.code
		<include refid="sql_where_fj_fjrc" />
		and t1.${fj_fjrc.dimMzOrZy} = '2' group by t2.code,t2.text
	</select>
	
	<!--今日处方量（合计）  -->
	<select id="getTodayPrescriptionTotal" resultType="hashmap" parameterType="hashmap">
		select sum(zdcf) zdcf,sum(zxcf) zxcf,sum(zdcf+zxcf) cfsl,sum(cfje) cfje from(
			<!-- 最大处方数 -->
			select sum(${cf_sl.indbName_value}) as zdcf,0 zxcf,0 cfje from ${cf_sl.indbName_value} t1
			where ${cf_sl.dimPrescriptionType}='1'
			<if test='date != null'> and t1.${cf_sl.dimTime} = #{date,jdbcType=VARCHAR}</if>
			<if test="size != 0">
				and t1.${cf_sl.dimOrganization} in
				<foreach item="item" collection="jgidList" open="(" separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			union
			<!-- 一般处方数 -->
			select 0 zdcf,sum(${cf_sl.indbName_value}) zxcf,0 cfje from ${cf_sl.indbName_value} t1
			where ${cf_sl.dimPrescriptionType}='0'
			<if test='date != null'> and t1.${cf_sl.dimTime} = #{date,jdbcType=VARCHAR}</if>
			<if test="size != 0">
				and t1.${cf_sl.dimOrganization} in
				<foreach item="item" collection="jgidList" open="(" separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
			union
			<!-- 处方总金额 -->
			select 0 zdcf,0 zxcf,sum(${cf_je.indbName_value}) cfje from ${cf_je.indbName_value} t1
			where 1=1
			<if test='date != null'> and t1.${cf_je.dimTime} = #{date,jdbcType=VARCHAR}</if>
			<if test="size != 0">
				and t1.${cf_je.dimOrganization} in
				<foreach item="item" collection="jgidList" open="(" separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
		)
	</select>

	<!-- 今日医生出诊量（合计） -->
	<select id="getTodayDoctorTotal" resultType="hashmap" parameterType="hashmap">
		select sum(czzs) czzs, case when sum(czzs) = 0 then 0 else round(sum(mzrc)/sum(czzs) ,2) end mzl,
		case when sum(cfzs) = 0 then 0 else round(sum(cfje)/sum(cfzs),2) end cfje,
		case when sum(czzs) = 0 then 0 else round(sum(cfzs)/sum(czzs),2) end cfsl
		from (
				--出诊总数
				select sum(czzs) czzs,0 as mzrc,0 as cfzs,0 as cfje 
				from (
					select ${ys_gzap.indbName_value} as czzs
					from ${ys_gzap.indbName_value} t1, ${ys_gzap.dimOrganization} t3
					where t1.${ys_gzap.dimOrganization} = t3.code
					and t1.${ys_gzap.dimSjc} = (
						select max(t1.${ys_gzap.dimSjc}) from ${ys_gzap.indbName_value} t1
						<where>
							<if test='date != null'>
								t1.${ys_gzap.dimTime} = #{date,jdbcType=VARCHAR}
							</if>
							<if test="size != 0">
								and t1.${ys_gzap.dimOrganization} in
								<foreach item="item" collection="jgidList" open="("
									separator="," close=")">
									#{item.jgid,jdbcType=VARCHAR}
								</foreach>
							</if>
						</where>
					)
					and t1.${ys_gzap.dimWorkStatus} = '看诊'
					<if test='date != null'>
						and t1.${ys_gzap.dimTime} = #{date,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${ys_gzap.dimOrganization} in
						<foreach item="item" collection="jgidList" open="("
							separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
					group by t1.${ys_gzap.dimDoctor},${ys_gzap.indbName_value} 
				)
				union
				-- 门诊人次
				select 0 as czzs,
				sum(${mzgh_rc.indbName_value}) as mzrc,0 as cfzs,0 as cfje
				from ${mzgh_rc.indbName_value} t1,${mzgh_rc.dimOrganization} t3
				where t1.${mzgh_rc.dimOrganization} = t3.code
				<if test='date != null'>
					and t1.${mzgh_rc.dimTime} = #{date,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${mzgh_rc.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
				union
				--处方总数
				select 0 as czzs,0 as mzrc,sum(${cf_sl.indbName_value}) cfzs,0 as cfje
				from ${cf_sl.indbName_value} t1, ${cf_sl.dimOrganization} t3
				where t1.${cf_sl.dimOrganization} = t3.code
				<if test='date != null'>
					and t1.${cf_sl.dimTime} = #{date,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${cf_sl.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
				union
				--处方总金额
				select 0 as czzs,0 as mzrc,0 as cfzs,sum(${cf_je.indbName_value}) cfje
				from ${cf_je.indbName_value} t1, ${cf_je.dimOrganization} t3
				where t1.${cf_je.dimOrganization} = t3.code
				<if test='date != null'>
					and t1.${cf_je.dimTime} = #{date,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${cf_je.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
		)
	</select>

	<sql id="sql_getTimeIntervalAnalysis">
		select sum(rc) as rc, regTime as regTime from (
		select
		sum(${gh_rc.indbName_value}) as rc, to_number(to_char(to_date(t1.${gh_rc.dimHour},
		'hh24:mi:ss'), 'hh24')) as regTime
		from ${gh_rc.indbName_value} t1 where 1 = 1
	</sql>

	<select id="getTimeIntervalAnalysisByEmergency" resultType="hashmap"
		parameterType="hashmap">
		<include refid="sql_getTimeIntervalAnalysis" />
		and t1.${gh_rc.dimDept} = '0189'
<!-- 		<include refid="sql_where" /> -->
		<if test='date != null'> and t1.${gh_rc.dimTime} = #{date,jdbcType=VARCHAR}</if>
		<if test="size != 0">
			and t1.${gh_rc.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		group by to_char(to_date(t1.${gh_rc.dimHour}, 'hh24:mi:ss'), 'hh24')
		union
		all
		select 0 as mzrc, level - 1 as mzsj
		from dual
		connect by level <![CDATA[<=]]>
		24)
		group by regTime
		order by regTime
	</select>
	<select id="getTimeIntervalAnalysisByOutpatient" resultType="hashmap"
		parameterType="hashmap">
		<include refid="sql_getTimeIntervalAnalysis" />
		and t1.${gh_rc.dimDept} <![CDATA[<>]]>
		'0189'
<!-- 		<include refid="sql_where" /> -->
		<if test='date != null'> and t1.${gh_rc.dimTime} = #{date,jdbcType=VARCHAR}</if>
		<if test="size != 0">
			and t1.${gh_rc.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		group by to_char(to_date(t1.${gh_rc.dimHour}, 'hh24:mi:ss'), 'hh24')
		union
		all
		select 0 as mzrc, level - 1 as mzsj
		from dual
		connect by level <![CDATA[<=]]>
		24)
		group by regTime
		order by regTime
	</select>
	
	<!-- 门诊、住院收入-当日 -->
	<select id="getOutpatientOrHospitalizationIncomeByYear"
		resultType="hashmap" parameterType="hashmap">
		select nvl(zfy, 0) zfy, 
		month ringData,
		round(case when month = 0 then 0
		else (zfy-month)/month end ,4) ringRatio
		from (select
		(select
		nvl(sum(
		<choose>
	        <when test="MZorZY=='MZ'">
	           t1.${dr_mzfy.indbName_value}
	        </when>
	        <when test="MZorZY=='ZY'">
	           t1.${dr_zyfy.indbName_value}
	        </when>
    	</choose>
		),0) as zfy
		from 
		<choose>
	        <when test="MZorZY=='MZ'">
	           ${dr_mzfy.indbName_value} t1 
	        </when>
	        <when test="MZorZY=='ZY'">
	           ${dr_zyfy.indbName_value} t1  
	        </when>
    	</choose>
		
		where 1=1
		<if test=" aycx == null or (aycx != null and aycx !=1 )">
			<include refid="sql_now_where_dr_mzfy_or_dr_zyfy" />

		</if>
		<if test=" aycx != null and aycx ==1 ">
			<include refid="sql_nowMonth_where_dr_mzfy_or_dr_zyfy" />
		</if>
		) zfy,
		(select nvl(sum(
			<choose>
	        <when test="MZorZY=='MZ'">
	           t1.${dr_mzfy.indbName_value}
	        </when>
	        <when test="MZorZY=='ZY'">
	           t1.${dr_zyfy.indbName_value}
	        </when>
    	</choose>
		
		),0) as zfy
		from 
		<choose>
	        <when test="MZorZY=='MZ'">
	           ${dr_mzfy.indbName_value} t1 
	        </when>
	        <when test="MZorZY=='ZY'">
	           ${dr_zyfy.indbName_value} t1  
	        </when>
    	</choose>
		where 1=1
		<if test="aycx == null">
			<choose>
			<when test="MZorZY=='MZ'">
				<if test="date != null">
					and t1.${dr_mzfy.dimTime}=to_char(to_date(#{date,jdbcType=VARCHAR},'yyyy-MM-dd')-1,'yyyy-MM-dd')
				</if>
				<if test="size != 0">
					and t1.${dr_mzfy.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
			<when test="MZorZY=='ZY'">
				<if test="date != null">
					and t1.${dr_zyfy.dimTime}=to_char(to_date(#{date,jdbcType=VARCHAR},'yyyy-MM-dd')-1,'yyyy-MM-dd')
				</if>
				<if test="size != 0">
					and t1.${dr_zyfy.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			</when>
		</choose>
		</if>
		<if test="aycx != null and aycx !=1">
			<include refid="sql_ringRatio_where_dr_mzfy_or_dr_zyfy" />
		</if>
		<if test=" aycx != null and aycx ==1 ">
			<include refid="sql_ringRatioMonth_where_dr_mzfy_or_dr_zyfy" />
		</if>
		) month
		from dual
		)
	</select>
	
	
	<!-- 业务or财务的 门诊收入 or 住院收入 -->
	<select id="getOutpatientOrHospitalizationIncomByYearYWORCW" resultType="hashmap" parameterType="hashmap">
				select nvl(zfy, 0) zfy, round(case when year = 0 then 0 else
		(zfy-year)/year end ,4) yearOnYear ,round(case when month = 0 then 0
		else (zfy-month)/month end ,4) ringRatio
		from (select
		(select
		nvl(sum(
		<if test=" CWorYW !='CW' ">
				<choose>
			        <when test="MZorZY=='MZ'">
			           t1.${yw_mzxx.indbName_value}
			        </when>
			        <when test="MZorZY=='ZY'">
			           t1.${yw_zyxx.indbName_value}
			        </when>
	    		</choose>
	    	</if>
	    	<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
	    		<choose>
			        <when test="MZorZY=='MZ'">
			           t1.${cw_mzxx.indbName_value}
			        </when>
			        <when test="MZorZY=='ZY'">
			           t1.${cw_zyxx.indbName_value}
			        </when>
	    		</choose>
	    </if>
		),0) as zfy
		from 
		<if test=" CWorYW !='CW' ">
				<choose>
			        <when test="MZorZY=='MZ'">
			          ${yw_mzxx.indbName_value} t1 
			        </when>
			        <when test="MZorZY=='ZY'">
			           ${yw_zyxx.indbName_value} t1 
			        </when>
	    		</choose>
	    	</if>
	    	<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
	    		<choose>
			        <when test="MZorZY=='MZ'">
			          ${cw_mzxx.indbName_value} t1 
			        </when>
			        <when test="MZorZY=='ZY'">
			          ${cw_zyxx.indbName_value} t1 
			        </when>
	    		</choose>
	    </if>
		where 1=1
		<if test=" aycx == null or (aycx != null and aycx !=1 )">
			<include refid="sql_now_where_ywOrcw_mzfy_or_zyfy" />

		</if>
		<if test=" aycx != null and aycx ==1 ">
			<include refid="sql_nowMonth_where_ywOrcw_mzfy_or_zyfy" />
		</if>
		) zfy,
		(select nvl(sum(
			<if test=" CWorYW !='CW' ">
				<choose>
			        <when test="MZorZY=='MZ'">
			           t1.${yw_mzxx.indbName_value}
			        </when>
			        <when test="MZorZY=='ZY'">
			           t1.${yw_zyxx.indbName_value}
			        </when>
	    		</choose>
	    	</if>
	    	<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
	    		<choose>
			        <when test="MZorZY=='MZ'">
			           t1.${cw_mzxx.indbName_value}
			        </when>
			        <when test="MZorZY=='ZY'">
			           t1.${cw_zyxx.indbName_value}
			        </when>
	    		</choose>
	    </if>
		),0) as zfy
		from 
		<if test=" CWorYW !='CW' ">
				<choose>
			        <when test="MZorZY=='MZ'">
			          ${yw_mzxx.indbName_value} t1 
			        </when>
			        <when test="MZorZY=='ZY'">
			           ${yw_zyxx.indbName_value} t1 
			        </when>
	    		</choose>
	    	</if>
	    	<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
	    		<choose>
			        <when test="MZorZY=='MZ'">
			          ${cw_mzxx.indbName_value} t1 
			        </when>
			        <when test="MZorZY=='ZY'">
			          ${cw_zyxx.indbName_value} t1 
			        </when>
	    		</choose>
	    	</if>
		where 1=1
		<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
			<include refid="sql_yearOnYear_where_ywOrcw_mzfy_or_zyfy" />
		</if>
		<if test=" aycx != null and aycx ==1 ">
			<include refid="sql_yearOnYearMonth_where_ywOrcw_mzfy_or_zyfy" />
		</if>
		) year,
		(select nvl(sum(
			<if test=" CWorYW !='CW' ">
				<choose>
			        <when test="MZorZY=='MZ'">
			          ${yw_mzxx.indbName_value} 
			        </when>
			        <when test="MZorZY=='ZY'">
			           ${yw_zyxx.indbName_value} 
			        </when>
	    		</choose>
	    	</if>
	    	<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
	    		<choose>
			        <when test="MZorZY=='MZ'">
			          ${cw_mzxx.indbName_value} 
			        </when>
			        <when test="MZorZY=='ZY'">
			          ${cw_zyxx.indbName_value}
			        </when>
	    		</choose>
	    	</if>
		),0) as zfy
		from 
		<if test=" CWorYW !='CW' ">
				<choose>
			        <when test="MZorZY=='MZ'">
			          ${yw_mzxx.indbName_value} t1 
			        </when>
			        <when test="MZorZY=='ZY'">
			           ${yw_zyxx.indbName_value} t1 
			        </when>
	    		</choose>
	    	</if>
	    	<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
	    		<choose>
			        <when test="MZorZY=='MZ'">
			          ${cw_mzxx.indbName_value} t1 
			        </when>
			        <when test="MZorZY=='ZY'">
			          ${cw_zyxx.indbName_value} t1 
			        </when>
	    		</choose>
	    	</if>
		where 1=1
		<if test=" aycx == null or (aycx != null and aycx !=1 )">
			<include refid="sql_ringRatio_where_ywOrcw_mzfy_or_zyfy" />
		</if>
		<if test=" aycx != null and aycx ==1 ">
			<include refid="sql_ringRatioMonth_where_ywOrcw_mzfy_or_zyfy" />
		</if>
		) month
		from dual
	)
	</select>

	<select id="getOutpatientOrHospitalizationIncomeByType"
		resultType="hashmap" parameterType="hashmap">
		select sum(zfy) as zfy,
		sum(zfy2) as yearOnYear,
		sum(zfy3) as ringRatio,
		text
		from (select case
		when flag = 1 then
		sum(zfy)
		else
		0
		end zfy,
		case
		when
		flag = 2 then
		sum(zfy)
		else
		0
		end zfy2,
		case
		when flag = 3 then
		sum(zfy)
		else
		0
		end zfy3,
		text
		from (
		<if test=" CWorYW !='CW' ">
			select 
			<choose>
		        <when test="searchType=='ZY'">
		          sum(t1.${yw_zyxx.indbName_value}) as zfy,
		        </when>
		        <when test="searchType=='MZ'">
		       	  sum(t1.${yw_mzxx.indbName_value}) as zfy,
		        </when>
		    </choose>
			case
			when t2.code in ('10000102',
			'10000101', '10000103') then
			'药品收入'

			else
			t2.text
			end text,
			1 as flag
			from
			<choose>
		        <when test="searchType=='ZY'">
		          ${yw_zyxx.indbName_value} t1 
		        </when>
		        <when test="searchType=='MZ'">
		          ${yw_mzxx.indbName_value} t1 
		        </when>
		    </choose>
			left join
			 <choose>
		        <when test="searchType=='ZY'">
		          ${yw_zyxx.dimExpenseType} t2
		        </when>
		        <when test="searchType=='MZ'">
		          ${yw_mzxx.dimExpenseType} t2
		        </when>
		    </choose>
			on 
			<choose>
		        <when test="searchType=='ZY'">
		           t1.${yw_zyxx.dimExpenseType} = t2.code
		        </when>
		        <when test="searchType=='MZ'">
		           t1.${yw_mzxx.dimExpenseType} = t2.code
		        </when>
		    </choose>
			<where>
				<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
					<include refid="sql_now_where2_FY" />
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<include refid="sql_nowMonth_where2_FY" />
				</if>
			</where>
			group by t2.text, t2.code
			union
			select 
			<choose>
		        <when test="searchType=='ZY'">
		          sum(t1.${yw_zyxx.indbName_value}) as zfy,
		        </when>
		        <when test="searchType=='MZ'">
		       	  sum(t1.${yw_mzxx.indbName_value}) as zfy,
		        </when>
		    </choose>
			case
			when t2.code in ('12','13','14') then
			'药品收入'

			else
			t2.text
			end text,
			2 as flag
			from 
			<choose>
		        <when test="searchType=='ZY'">
		          ${yw_zyxx.indbName_value} t1 
		        </when>
		        <when test="searchType=='MZ'">
		       	  ${yw_mzxx.indbName_value} t1 
		        </when>
		    </choose>
			left join
			<choose>
		        <when test="searchType=='ZY'">
		          ${yw_zyxx.dimExpenseType} t2 
		        </when>
		        <when test="searchType=='MZ'">
		       	  ${yw_mzxx.dimExpenseType} t2
		        </when>
		    </choose>
			on 
			<choose>
		        <when test="searchType=='ZY'">
		           t1.${yw_zyxx.dimExpenseType} = t2.code
		        </when>
		        <when test="searchType=='MZ'">
		           t1.${yw_mzxx.dimExpenseType} = t2.code
		        </when>
		    </choose>
			<where>
				<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
					<include refid="sql_yearOnYear_where2_FY" />
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<include refid="sql_yearOnYearMonth_where2_FY" />
				</if>
			</where>
			group by t2.text, t2.code
			union
			select 
			<choose>
		        <when test="searchType=='ZY'">
		          sum(t1.${yw_zyxx.indbName_value}) as zfy,
		        </when>
		        <when test="searchType=='MZ'">
		       	  sum(t1.${yw_mzxx.indbName_value}) as zfy,
		        </when>
		    </choose>
			case
			when t2.code in ('10000102', '10000101', '10000103') then
			'药品收入'
			else
			t2.text
			end text,
			3 as flag
			from 
			<choose>
		        <when test="searchType=='ZY'">
		          ${yw_zyxx.indbName_value} t1 
		        </when>
		        <when test="searchType=='MZ'">
		       	  ${yw_mzxx.indbName_value} t1 
		        </when>
		    </choose>
			left join
			<choose>
		        <when test="searchType=='ZY'">
		          ${yw_zyxx.dimExpenseType} t2
		        </when>
		        <when test="searchType=='MZ'">
		       	  ${yw_mzxx.dimExpenseType} t2
		        </when>
		    </choose>
			on 
			<choose>
		        <when test="searchType=='ZY'">
		           t1.${yw_zyxx.dimExpenseType} = t2.code
		        </when>
		        <when test="searchType=='MZ'">
		           t1.${yw_mzxx.dimExpenseType} = t2.code
		        </when>
		    </choose>
			<where>
				<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
					<include refid="sql_ringRatio_where2_FY" />
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<include refid="sql_ringRatioMonth_where2_FY" />
				</if>
			</where>
			group by t2.text, t2.code
		</if>
		<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
			select 
			<choose>
		        <when test="searchType=='ZY'">
		          sum(t1.${cw_zyxx.indbName_value}) as zfy,
		        </when>
		        <when test="searchType=='MZ'">
		       	  sum(t1.${cw_mzxx.indbName_value}) as zfy,
		        </when>
		    </choose>
			case when t2.code in ('12', '13',
			'14') then
			'药品收入'

			else
			t2.text
			end as text, 1 as flag
			from 
			<choose>
		        <when test="searchType=='ZY'">
		          ${cw_zyxx.indbName_value} t1
		        </when>
		        <when test="searchType=='MZ'">
		       	  ${cw_mzxx.indbName_value} t1
		        </when>
		    </choose>
			left join 
			<choose>
		        <when test="searchType=='ZY'">
		          ${cw_zyxx.dimExpenseType} t2
		        </when>
		        <when test="searchType=='MZ'">
		       	  ${cw_mzxx.dimExpenseType} t2
		        </when>
		    </choose>
			on 
			<choose>
		        <when test="searchType=='ZY'">
		          t1.${cw_zyxx.dimExpenseType} = t2.code
		        </when>
		        <when test="searchType=='MZ'">
		       	  t1.${cw_mzxx.dimExpenseType} = t2.code
		        </when>
		    </choose>
			<where>
				<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
					<include refid="sql_now_where2_FY" />
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<include refid="sql_nowMonth_where2_FY" />
				</if>
			</where>
			group by t2.text, t2.code
			union
			select 
			<choose>
		        <when test="searchType=='ZY'">
		          sum(t1.${cw_zyxx.indbName_value}) as zfy,
		        </when>
		        <when test="searchType=='MZ'">
		       	  sum(t1.${cw_mzxx.indbName_value}) as zfy,
		        </when>
		    </choose>
			case
			when t2.code in ('12', '13', '14')
			then
			'药品收入'

			else
			t2.text
			end as text, 2
			as flag
			from 
			<choose>
		        <when test="searchType=='ZY'">
		          ${cw_zyxx.indbName_value} t1
		        </when>
		        <when test="searchType=='MZ'">
		       	  ${cw_mzxx.indbName_value} t1
		        </when>
		    </choose>
			left join 
			<choose>
		        <when test="searchType=='ZY'">
		          ${cw_zyxx.dimExpenseType} t2
		        </when>
		        <when test="searchType=='MZ'">
		       	  ${cw_mzxx.dimExpenseType} t2
		        </when>
		    </choose>
			on 
			<choose>
		        <when test="searchType=='ZY'">
		          t1.${cw_zyxx.dimExpenseType} = t2.code
		        </when>
		        <when test="searchType=='MZ'">
		       	  t1.${cw_mzxx.dimExpenseType} = t2.code
		        </when>
		    </choose>
			<where>
				<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
					<include refid="sql_yearOnYear_where2_FY" />
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<include refid="sql_yearOnYearMonth_where2_FY" />
				</if>
			</where>
			group by t2.text, t2.code
			union
			select 
			<choose>
		        <when test="searchType=='ZY'">
		          sum(t1.${cw_zyxx.indbName_value}) as zfy,
		        </when>
		        <when test="searchType=='MZ'">
		       	  sum(t1.${cw_mzxx.indbName_value}) as zfy,
		        </when>
		    </choose>
			case when t2.code in ('12', '13', '14')
			then
			'药品收入'
			else
			t2.text
			end as
			text, 3 as flag
			from 
			<choose>
		        <when test="searchType=='ZY'">
		          ${cw_zyxx.indbName_value} t1
		        </when>
		        <when test="searchType=='MZ'">
		       	  ${cw_mzxx.indbName_value} t1
		        </when>
		    </choose>
			left join 
			<choose>
		        <when test="searchType=='ZY'">
		          ${cw_zyxx.dimExpenseType} t2
		        </when>
		        <when test="searchType=='MZ'">
		       	  ${cw_mzxx.dimExpenseType} t2
		        </when>
		    </choose>
			on
			<choose>
		        <when test="searchType=='ZY'">
		          t1.${cw_zyxx.dimExpenseType} = t2.code
		        </when>
		        <when test="searchType=='MZ'">
		       	  t1.${cw_mzxx.dimExpenseType} = t2.code
		        </when>
		    </choose>
			<where>
				<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
					<include refid="sql_ringRatio_where2_FY" />
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<include refid="sql_ringRatioMonth_where2_FY" />
				</if>
			</where>
			group by t2.text, t2.code
		</if>
		) a
		group by text, flag)
		group by text
	</select>

<!-- 门诊收入 or 住院收入按照科室名称分组(字段：科室名称-收入-同比-环比） -->
	<select id="getOutpatientOrHospitalizationIncomeByDept" resultType="hashmap" parameterType="hashmap">
		select sum(zfy) as zfy,
		case when sum(zfy2) <![CDATA[ <> ]]> 0 then round((sum(zfy) - sum(zfy2)) / sum(zfy2), 4) else 0 end as yearOnYear,
		case when sum(zfy3) <![CDATA[ <> ]]> 0 then round((sum(zfy) - sum(zfy3)) / sum(zfy3), 4) else 0 end as ringRatio,
		text, code from (select
		case when flag = 1 then sum(zfy) else 0 end zfy,
		case when flag = 2 then sum(zfy) else 0 end zfy2,
		case when flag = 3 then sum(zfy) else 0 end zfy3,
		text, dimorder, code
		from (
		<if test=" CWorYW !='CW' ">
			select t4.text, t4.code,
			<if test="searchType != null and searchType =='MZ' ">
				t5.dimorder,
			</if>
			<if test="searchType != null and searchType =='ZY' ">
				t4.dimorder,
			</if>
			<choose>
		        <when test="searchType=='ZY'">
		          sum(t1.${yw_zyxx.indbName_value}) as zfy,
		        </when>
		        <when test="searchType=='MZ'">
		       	  sum(t1.${yw_mzxx.indbName_value}) as zfy,
		        </when>
		    </choose>
			1 as flag from 
			<choose>
		        <when test="searchType=='ZY'">
		          ${yw_zyxx.indbName_value} t1,
		        </when>
		        <when test="searchType=='MZ'">
		       	  ${yw_mzxx.indbName_value} t1,
		        </when>
		    </choose>
			<choose>
		        <when test="searchType=='ZY'">
		      		${yw_zyxx.dimDept} t4
		        </when>
		        <when test="searchType=='MZ'">
		       	 	${yw_mzxx.dimDept} t4
		        </when>
		    </choose>
			<if test="searchType != null and searchType =='MZ' ">
				left join ${yw_mzxx.dimExpenseType} t5 on t4.code=t5.code
			</if>
			where 
			<choose>
		        <when test="searchType=='ZY'">
		      		t1.${yw_zyxx.dimDept} = t4.code
		        </when>
		        <when test="searchType=='MZ'">
		       	 	t1.${yw_mzxx.dimDept} = t4.code
		        </when>
		    </choose>
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			group by t4.code, t4.text
			<if test="searchType != null and searchType =='MZ' ">
				,t5.dimorder
			</if>
			<if test="searchType != null and searchType =='ZY' ">
				,t4.dimorder
			</if>
			union
			select t4.text, t4.code,
			<if test="searchType != null and searchType =='MZ' ">
				t5.dimorder,
			</if>
			<if test="searchType != null and searchType =='ZY' ">
				t4.dimorder,
			</if>
			<choose>
		        <when test="searchType=='ZY'">
		          sum(t1.${yw_zyxx.indbName_value}) as zfy,
		        </when>
		        <when test="searchType=='MZ'">
		       	  sum(t1.${yw_mzxx.indbName_value}) as zfy,
		        </when>
		    </choose>
			 2 as flag from 
			<choose>
		        <when test="searchType=='ZY'">
		          ${yw_zyxx.indbName_value} t1,
		        </when>
		        <when test="searchType=='MZ'">
		       	  ${yw_mzxx.indbName_value} t1,
		        </when>
		    </choose>
			<choose>
		        <when test="searchType=='ZY'">
		      		${yw_zyxx.dimDept} t4
		        </when>
		        <when test="searchType=='MZ'">
		       	 	${yw_mzxx.dimDept} t4
		        </when>
		    </choose>
			<if test="searchType != null and searchType =='MZ' ">
				left join ${yw_mzxx.dimExpenseType} t5 on t4.code=t5.code
			</if>
			where 
			<choose>
		        <when test="searchType=='ZY'">
		      		t1.${yw_zyxx.dimDept} = t4.code
		        </when>
		        <when test="searchType=='MZ'">
		       	 	t1.${yw_mzxx.dimDept} = t4.code
		        </when>
		    </choose>
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			group by t4.code, t4.text
			<if test="searchType != null and searchType =='MZ' ">
				,t5.dimorder
			</if>
			<if test="searchType != null and searchType =='ZY' ">
				,t4.dimorder
			</if>
			union
			select t4.text, t4.code,
			<if test="searchType != null and searchType =='MZ' ">
				t5.dimorder,
			</if>
			<if test="searchType != null and searchType =='ZY' ">
				t4.dimorder,
			</if>
			<choose>
		        <when test="searchType=='ZY'">
		          sum(t1.${yw_zyxx.indbName_value}) as zfy,
		        </when>
		        <when test="searchType=='MZ'">
		       	  sum(t1.${yw_mzxx.indbName_value}) as zfy,
		        </when>
		    </choose>
			 3 as flag from
			<choose>
		        <when test="searchType=='ZY'">
		          ${yw_zyxx.indbName_value} t1,
		        </when>
		        <when test="searchType=='MZ'">
		       	  ${yw_mzxx.indbName_value} t1,
		        </when>
		    </choose>
			<choose>
		        <when test="searchType=='ZY'">
		      		${yw_zyxx.dimDept} t4
		        </when>
		        <when test="searchType=='MZ'">
		       	 	${yw_mzxx.dimDept} t4
		        </when>
		    </choose>
			<if test="searchType != null and searchType =='MZ' ">
				left join ${yw_mzxx.dimExpenseType} t5 on t4.code=t5.code
			</if>
			where 
			<choose>
		        <when test="searchType=='ZY'">
		      		t1.${yw_zyxx.dimDept} = t4.code
		        </when>
		        <when test="searchType=='MZ'">
		       	 	t1.${yw_mzxx.dimDept} = t4.code
		        </when>
		    </choose>
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			group by t4.code, t4.text
			<if test="searchType != null and searchType =='MZ' ">
				,t5.dimorder
			</if>
			<if test="searchType != null and searchType =='ZY' ">
				,t4.dimorder
			</if>
		</if>
		<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
			select t4.text, t4.code,t4.dimorder,
<!-- 			<if test="searchType != null and searchType =='MZ' "> -->
<!-- 				t5.dimorder, -->
<!-- 			</if> -->
<!-- 			<if test="searchType != null and searchType =='ZY' "> -->
<!-- 				t4.dimorder, -->
<!-- 			</if> -->
			<choose>
		        <when test="searchType=='ZY'">
		          sum(t1.${cw_zyxx.indbName_value}) as zfy,
		        </when>
		        <when test="searchType=='MZ'">
		       	  sum(t1.${cw_mzxx.indbName_value}) as zfy,
		        </when>
		    </choose>
			1 as flag from 
			<choose>
		        <when test="searchType=='ZY'">
		          ${cw_zyxx.indbName_value} t1,
		        </when>
		        <when test="searchType=='MZ'">
		       	  ${cw_mzxx.indbName_value} t1,
		        </when>
		    </choose>
			<choose>
		        <when test="searchType=='ZY'">
		      		${cw_zyxx.dimDept} t4
		        </when>
		        <when test="searchType=='MZ'">
		       	 	${cw_mzxx.dimDept} t4
		        </when>
		    </choose>
		    <!-- MS_TODO SQL  -->
<!-- 			<if test="searchType != null and searchType =='MZ' "> -->
<!-- 				left join dim0001365 t5 on t4.code=t5.code -->
<!-- 			</if> -->
			where 
			<choose>
		        <when test="searchType=='ZY'">
		      		t1.${cw_zyxx.dimDept} = t4.code
		        </when>
		        <when test="searchType=='MZ'">
		       	 	t1.${cw_mzxx.dimDept} = t4.code
		        </when>
		    </choose>
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			group by t4.code, t4.text ,t4.dimorder
<!-- 			<if test="searchType != null and searchType =='MZ' "> -->
<!-- 				,t5.dimorder -->
<!-- 			</if> -->
<!-- 			<if test="searchType != null and searchType =='ZY' "> -->
<!-- 				,t4.dimorder -->
<!-- 			</if> -->
			union
			select t4.text, t4.code,t4.dimorder,
<!-- 			<if test="searchType != null and searchType =='MZ' "> -->
<!-- 				t5.dimorder, -->
<!-- 			</if> -->
<!-- 			<if test="searchType != null and searchType =='ZY' "> -->
<!-- 				t4.dimorder, -->
<!-- 			</if> -->
			<choose>
		        <when test="searchType=='ZY'">
		          sum(t1.${cw_zyxx.indbName_value}) as zfy,
		        </when>
		        <when test="searchType=='MZ'">
		       	  sum(t1.${cw_mzxx.indbName_value}) as zfy,
		        </when>
		    </choose>
			2 as flag from 
			<choose>
		        <when test="searchType=='ZY'">
		          ${cw_zyxx.indbName_value} t1,
		        </when>
		        <when test="searchType=='MZ'">
		       	  ${cw_mzxx.indbName_value} t1,
		        </when>
		    </choose>
			<choose>
		        <when test="searchType=='ZY'">
		      		${cw_zyxx.dimDept} t4
		        </when>
		        <when test="searchType=='MZ'">
		       	 	${cw_mzxx.dimDept} t4
		        </when>
		    </choose>
<!-- 			<if test="searchType != null and searchType =='MZ' "> -->
<!-- 				left join dim0001365 t5 on t4.code=t5.code -->
<!-- 			</if> -->
			where 
			<choose>
		        <when test="searchType=='ZY'">
		      		t1.${cw_zyxx.dimDept} = t4.code
		        </when>
		        <when test="searchType=='MZ'">
		       	 	t1.${cw_mzxx.dimDept} = t4.code
		        </when>
		    </choose>
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			group by t4.code, t4.text ,t4.dimorder
<!-- 			<if test="searchType != null and searchType =='MZ' "> -->
<!-- 				,t5.dimorder -->
<!-- 			</if> -->
<!-- 			<if test="searchType != null and searchType =='ZY' "> -->
<!-- 				,t4.dimorder -->
<!-- 			</if> -->
			union
			select t4.text, t4.code, t4.dimorder,
<!-- 			<if test="searchType != null and searchType =='MZ' "> -->
<!-- 				t5.dimorder, -->
<!-- 			</if> -->
<!-- 			<if test="searchType != null and searchType =='ZY' "> -->
<!-- 				t4.dimorder, -->
<!-- 			</if> -->
			<choose>
		        <when test="searchType=='ZY'">
		          sum(t1.${cw_zyxx.indbName_value}) as zfy,
		        </when>
		        <when test="searchType=='MZ'">
		       	  sum(t1.${cw_mzxx.indbName_value}) as zfy,
		        </when>
		    </choose>
			3 as flag from 
			<choose>
		        <when test="searchType=='ZY'">
		          ${cw_zyxx.indbName_value} t1,
		        </when>
		        <when test="searchType=='MZ'">
		       	  ${cw_mzxx.indbName_value} t1,
		        </when>
		    </choose>
			<choose>
		        <when test="searchType=='ZY'">
		      		${cw_zyxx.dimDept} t4
		        </when>
		        <when test="searchType=='MZ'">
		       	 	${cw_mzxx.dimDept} t4
		        </when>
		    </choose>
<!-- 			<if test="searchType != null and searchType =='MZ' "> -->
<!-- 				left join dim0001365 t5 on t4.code=t5.code -->
<!-- 			</if> -->
			where 
			<choose>
		        <when test="searchType=='ZY'">
		      		t1.${cw_zyxx.dimDept} = t4.code
		        </when>
		        <when test="searchType=='MZ'">
		       	 	t1.${cw_mzxx.dimDept} = t4.code
		        </when>
		    </choose>
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			group by t4.code, t4.text,t4.dimorder 
<!-- 			<if test="searchType != null and searchType =='MZ' "> -->
<!-- 				,t5.dimorder -->
<!-- 			</if> -->
<!-- 			<if test="searchType != null and searchType =='ZY' "> -->
<!-- 				,t4.dimorder -->
<!-- 			</if> -->
		</if>
		) a 
		<!-- TODO科室数据权限控制 -->
		<!-- <include refid="sql_where_deptCodes" /> -->
		
		group by text, code, flag,dimorder)
		group by code, text,dimorder
		order by dimorder
	</select>

	<!-- 下钻到医生 -->
	<select id="getOutpatientOrHospitalizationIncomeByDoctor"
		resultType="hashmap" parameterType="hashmap">
		select sum(zfy) as zfy,
		case when sum(zfy2) <![CDATA[ <> ]]>
		0 then round((sum(zfy) - sum(zfy2)) / sum(zfy2), 4)
		else 0 end as
		yearOnYear,
		case when sum(zfy3) <![CDATA[ <> ]]>
		0 then round((sum(zfy) - sum(zfy3)) / sum(zfy3), 4)
		else 0 end as
		ringRatio,
		text,
		code
		from (
		select
		case when flag = 1 then sum(zfy) else 0 end
		zfy,
		case when flag = 2 then sum(zfy) else 0 end zfy2,
		case when flag =
		3 then sum(zfy) else 0 end zfy3,
		text,
		dimorder,
		code
		from (
		<if test=" CWorYW !='CW' ">
			select t4.text, t4.code,t4.dimorder,
			<choose>
				<when test="searchType=='MZ'">
					sum(t1.${yw_mzxx.indbName_value}) as zfy, 
				</when>
				<when test="searchType=='ZY'">
					sum(t1.${yw_zyxx.indbName_value}) as zfy, 
				</when>
			</choose>
			1 as flag
			
			from
			<choose>
				<when test="searchType=='MZ'">
					${yw_mzxx.indbName_value} t1, 
				</when>
				<when test="searchType=='ZY'">
					${yw_zyxx.indbName_value} t1, 
				</when>
			</choose>
			<choose>
				<when test="searchType=='MZ'">
					${yw_mzxx.dimDoctor} t4 
				</when>
				<when test="searchType=='ZY'">
					${yw_zyxx.dimDoctor} t4
				</when>
			</choose>

			where 
			<choose>
				<when test="searchType=='MZ'">
					t1.${yw_mzxx.dimDoctor} = t4.code 
				</when>
				<when test="searchType=='ZY'">
					t1.${yw_zyxx.dimDoctor} = t4.code 
				</when>
			</choose>
			<if test="dept != null and dept != ''">
			<choose>
				<when test="searchType=='MZ'">
					and t1.${yw_mzxx.dimDept} = #{dept}
				</when>
				<when test="searchType=='ZY'">
					and t1.${yw_zyxx.dimDept} = #{dept}
				</when>
			</choose>
			</if>
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			group by t4.code, t4.text,t4.dimorder
			union
			select t4.text,
			t4.code,t4.dimorder,

			<choose>
				<when test="searchType=='MZ'">
					sum(t1.${yw_mzxx.indbName_value}) as zfy, 
				</when>
				<when test="searchType=='ZY'">
					sum(t1.${yw_zyxx.indbName_value}) as zfy, 
				</when>
			</choose>
			2 as flag
			
			from
			<choose>
				<when test="searchType=='MZ'">
					${yw_mzxx.indbName_value} t1, 
				</when>
				<when test="searchType=='ZY'">
					${yw_zyxx.indbName_value} t1, 
				</when>
			</choose>
			<choose>
				<when test="searchType=='MZ'">
					${yw_mzxx.dimDoctor} t4 
				</when>
				<when test="searchType=='ZY'">
					${yw_zyxx.dimDoctor} t4
				</when>
			</choose>

			where 
			<choose>
				<when test="searchType=='MZ'">
					t1.${yw_mzxx.dimDoctor} = t4.code 
				</when>
				<when test="searchType=='ZY'">
					t1.${yw_zyxx.dimDoctor} = t4.code 
				</when>
			</choose>
			<if test="dept != null and dept != ''">
			<choose>
				<when test="searchType=='MZ'">
					and t1.${yw_mzxx.dimDept} = #{dept}
				</when>
				<when test="searchType=='ZY'">
					and t1.${yw_zyxx.dimDept} = #{dept}
				</when>
			</choose>
			</if>
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			group by t4.code, t4.text,t4.dimorder

			union
			select t4.text,
			t4.code,t4.dimorder,

			<choose>
				<when test="searchType=='MZ'">
					sum(t1.${yw_mzxx.indbName_value}) as zfy, 
				</when>
				<when test="searchType=='ZY'">
					sum(t1.${yw_zyxx.indbName_value}) as zfy, 
				</when>
			</choose>
			3 as flag
			
			from
			<choose>
				<when test="searchType=='MZ'">
					${yw_mzxx.indbName_value} t1, 
				</when>
				<when test="searchType=='ZY'">
					${yw_zyxx.indbName_value} t1, 
				</when>
			</choose>
			<choose>
				<when test="searchType=='MZ'">
					${yw_mzxx.dimDoctor} t4 
				</when>
				<when test="searchType=='ZY'">
					${yw_zyxx.dimDoctor} t4
				</when>
			</choose>

			where 
			<choose>
				<when test="searchType=='MZ'">
					t1.${yw_mzxx.dimDoctor} = t4.code 
				</when>
				<when test="searchType=='ZY'">
					t1.${yw_zyxx.dimDoctor} = t4.code 
				</when>
			</choose>
			<if test="dept != null and dept != ''">
			<choose>
				<when test="searchType=='MZ'">
					and t1.${yw_mzxx.dimDept} = #{dept}
				</when>
				<when test="searchType=='ZY'">
					and t1.${yw_zyxx.dimDept} = #{dept}
				</when>
			</choose>
			</if>
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			group by t4.code, t4.text,t4.dimorder

		</if>
		<!-- <if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
			select t4.text, t4.code,
			<if test="searchType != null and searchType =='MZ' ">
				t5.dimorder,
			</if>
			<if test="searchType != null and searchType =='ZY' ">
				t4.dimorder,
			</if>
			sum(t1.${tableName}) as zfy, 1 as flag
			from ${tableName} t1, dim0000773 t4
			<if test="searchType != null and searchType =='MZ' ">
				left join dim0001365 t5 on t4.code=t5.code
			</if>
			where t1.dim0000773 = t4.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			group by t4.code, t4.text
			<if test="searchType != null and searchType =='MZ' ">
				,t5.dimorder
			</if>
			<if test="searchType != null and searchType =='ZY' ">
				,t4.dimorder
			</if>
			union
			select t4.text, t4.code,
			<if test="searchType != null and searchType =='MZ' ">
				t5.dimorder,
			</if>
			<if test="searchType != null and searchType =='ZY' ">
				t4.dimorder,
			</if>
			sum(t1.${tableName}) as zfy, 2 as flag
			from ${tableName} t1, dim0000773 t4
			<if test="searchType != null and searchType =='MZ' ">
				left join dim0001365 t5 on t4.code=t5.code
			</if>
			where t1.dim0000773 = t4.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			group by t4.code, t4.text
			<if test="searchType != null and searchType =='MZ' ">
				,t5.dimorder
			</if>
			<if test="searchType != null and searchType =='ZY' ">
				,t4.dimorder
			</if>
			union
			select t4.text, t4.code,
			<if test="searchType != null and searchType =='MZ' ">
				t5.dimorder,
			</if>
			<if test="searchType != null and searchType =='ZY' ">
				t4.dimorder,
			</if>
			sum(t1.${tableName}) as zfy, 3 as flag
			from ${tableName} t1, dim0000773 t4
			<if test="searchType != null and searchType =='MZ' ">
				left join dim0001365 t5 on t4.code=t5.code
			</if>
			where t1.dim0000773 = t4.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			group by t4.code, t4.text
			<if test="searchType != null and searchType =='MZ' ">
				,t5.dimorder
			</if>
			<if test="searchType != null and searchType =='ZY' ">
				,t4.dimorder
			</if>
		</if> -->
		<!--   如果是财务则不能下钻到医生  -->
<!-- 		<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' "> -->
<!-- 			select t4.text, t4.code,,t4.dimorder, -->

<!-- 			sum(t1.${tableName}) as zfy, 1 -->
<!-- 			as flag -->
<!-- 			from ${tableName} t1, dim0000282 t4 -->

<!-- 			where t1.dim0000282 = -->
<!-- 			t4.code -->
<!-- 			<if test="dept != null and dept != ''">and t1.dim0000584 = ${dept} -->
<!-- 			</if> -->
<!-- 			<if test=" aycx == null or (aycx != null and aycx !=1 ) "> -->
<!-- 				<include refid="sql_now_where" /> -->
<!-- 			</if> -->
<!-- 			<if test=" aycx != null and aycx ==1 "> -->
<!-- 				<include refid="sql_nowMonth_where" /> -->
<!-- 			</if> -->
<!-- 			group by t4.code, t4.text,t4.dimorder -->

<!-- 			union -->
<!-- 			select t4.text, -->
<!-- 			t4.code,,t4.dimorder, -->

<!-- 			sum(t1.${tableName}) as zfy, 2 as flag -->
<!-- 			from -->
<!-- 			${tableName} t1, dim0000282 t4 -->

<!-- 			where t1.dim0000282 = t4.code -->
<!-- 			<if test="dept != null and dept != ''">and t1.dim0000584 = ${dept} -->
<!-- 			</if> -->
<!-- 			<if test=" aycx == null or (aycx != null and aycx !=1 ) "> -->
<!-- 				<include refid="sql_yearOnYear_where" /> -->
<!-- 			</if> -->
<!-- 			<if test=" aycx != null and aycx ==1 "> -->
<!-- 				<include refid="sql_yearOnYearMonth_where" /> -->
<!-- 			</if> -->
<!-- 			group by t4.code, t4.text,t4.dimorder -->

<!-- 			union -->
<!-- 			select t4.text, -->
<!-- 			t4.code,,t4.dimorder, -->

<!-- 			sum(t1.${tableName}) as zfy, 3 as flag -->
<!-- 			from -->
<!-- 			${tableName} t1, dim0000282 t4 -->

<!-- 			where t1.dim0000282 = t4.code -->
<!-- 			<if test="dept != null and dept != ''">and t1.dim0000584 = ${dept} -->
<!-- 			</if> -->
<!-- 			<if test=" aycx == null or (aycx != null and aycx !=1 ) "> -->
<!-- 				<include refid="sql_ringRatio_where" /> -->
<!-- 			</if> -->
<!-- 			<if test=" aycx != null and aycx ==1 "> -->
<!-- 				<include refid="sql_ringRatioMonth_where" /> -->
<!-- 			</if> -->
<!-- 			group by t4.code, t4.text,t4.dimorder -->
<!-- 		</if> -->
		) a 
		
		<!-- TODO医生数据权限控制 -->
		<include refid="sql_where_doctorCodes" />
		
		group by text, code, flag,dimorder)
		group by code, text,dimorder
		order by dimorder 

	</select>

	<!-- 门诊总人次 -->
	<select id="getCountOutpatientPersonTime" resultType="hashmap" parameterType="hashmap">
		select nvl(sum(rc), 0) rc, '门诊总人次' as text,
		case when sum(rc2) <![CDATA[ <> ]]> 0 then round((sum(rc) - sum(rc2)) / sum(rc2), 4)
		else 0 end as yearOnYear,
		case when sum(rc3) <![CDATA[ <> ]]> 0 then round((sum(rc) - sum(rc3)) / sum(rc3), 4)
		else 0 end as ringRatio
		from (
			select case when flag = 1 then sum(rc) else 0 end rc,
			case when flag =2 then sum(rc) else 0 end rc2,
			case when flag = 3 then sum(rc) else 0 end rc3
			from (
				select sum(${mz_jzrc.indbName_value}) rc, 1 as flag
				from ${mz_jzrc.indbName_value} t1
				where 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
					<include refid="sql_now_where2_RC" />
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<include refid="sql_nowMonth_where2_RC" />
				</if>
				
				union
				select sum(${mz_jzrc.indbName_value}) rc, 2 as flag
				from ${mz_jzrc.indbName_value} t1
				where 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
					<include refid="sql_yearOnYear_where2_RC" />
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<include refid="sql_yearOnYearMonth_where2_RC" />
				</if>
				
				union
				select sum(${mz_jzrc.indbName_value}) rc, 3 as flag
				from ${mz_jzrc.indbName_value} t1
				where 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
					<include refid="sql_ringRatio_where2_RC" />
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<include refid="sql_ringRatioMonth_where2_RC" />
				</if>
			) group by flag
		)
	</select>
	
	<!--  门诊总人次下钻到科室 -->
	<select id="getCountOutpatientPersonTimeByDept" resultType="hashmap"
		parameterType="hashmap">
		select nvl(sum(rc), 0) rc,  text,code,DIMORDER,
		case
		when sum(rc2) <![CDATA[ <> ]]>
		0 then
		round((sum(rc) - sum(rc2)) / sum(rc2), 4)
		else
		0
		end as yearOnYear,
		case
		when sum(rc3) <![CDATA[ <> ]]>
		0 then
		round((sum(rc) - sum(rc3)) / sum(rc3), 4)
		else
		0
		end as ringRatio
		from (
		
		
		select
		text,
		code,
		DIMORDER,
		 case
		when flag = 1 then
		sum(rc)
		else
		0
		end rc,
		case
		when flag =
		2 then
		sum(rc)
		else
		0
		end rc2,
		case
		when flag = 3 then
		sum(rc)
		else
		0
		end rc3
		from (
		
		select 
		text,
		code,
		DIMORDER,
		sum(${mz_jzrc.indbName_value}) rc, 
		1 as flag
		from ${mz_jzrc.indbName_value} t1
		left join
		${mz_jzrc.dimDept} t4
		on
		t1.${mz_jzrc.dimDept} = t4.code
		where 1=1
		<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
			<include refid="sql_now_where2_RC" />
		</if>
		<if test=" aycx != null and aycx ==1 ">
			<include refid="sql_nowMonth_where2_RC" />
		</if>
		GROUP BY t4.code,t4.text,DIMORDER
		union
		select
		text,code,DIMORDER,
		sum(${mz_jzrc.indbName_value}) rc, 
		2 as flag
		from ${mz_jzrc.indbName_value} t1
		left join
		${mz_jzrc.dimDept} t4
		on
		t1.${mz_jzrc.dimDept} = t4.code
		where 1=1
		<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
			<include refid="sql_yearOnYear_where2_RC" />
		</if>
		<if test=" aycx != null and aycx ==1 ">
			<include refid="sql_yearOnYearMonth_where2_RC" />
		</if>
		GROUP BY t4.code,t4.text,DIMORDER
		union
		select 
		text,code,DIMORDER,
		sum(${mz_jzrc.indbName_value}) rc, 
		3 as flag
		from ${mz_jzrc.indbName_value} t1
		left join
		${mz_jzrc.dimDept} t4
		on
		t1.${mz_jzrc.dimDept} = t4.code
		where 1=1
		<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
			<include refid="sql_ringRatio_where2_RC" />
		</if>
		<if test=" aycx != null and aycx ==1 ">
			<include refid="sql_ringRatioMonth_where2_RC" />
		</if>
		GROUP BY t4.code,t4.text,DIMORDER) 
		<!-- TODO -->
		<include refid="sql_where_deptCodes" />
		GROUP BY
			text,
			code,
			dimorder,
			flag 
		ORDER BY
			DIMORDER
		)  GROUP BY
			text,
			code,
			dimorder 
			ORDER BY
			DIMORDER
		
	</select>
	<select id="getCountOutpatientPersonTimeByDoctor" resultType="hashmap"
		parameterType="hashmap">
		select nvl(sum(rc), 0) rc,  text,code,DIMORDER,
		case
		when sum(rc2) <![CDATA[ <> ]]>
		0 then
		round((sum(rc) - sum(rc2)) / sum(rc2), 4)
		else
		0
		end as yearOnYear,
		case
		when sum(rc3) <![CDATA[ <> ]]>
		0 then
		round((sum(rc) - sum(rc3)) / sum(rc3), 4)
		else
		0
		end as ringRatio
		from (
		
		
		select
		text,
		code,
		DIMORDER,
		 case
		when flag = 1 then
		sum(rc)
		else
		0
		end rc,
		case
		when flag =
		2 then
		sum(rc)
		else
		0
		end rc2,
		case
		when flag = 3 then
		sum(rc)
		else
		0
		end rc3
		from (
		
		select 
		text,
		code,
		DIMORDER,
		sum(${mz_jzrc.indbName_value}) rc, 
		1 as flag
		from ${mz_jzrc.indbName_value} t1
		left join
		${mz_jzrc.dimDoctor} t4
		on
		t1.${mz_jzrc.dimDoctor} = t4.code
		where 1=1 <include refid="sql_where_doctor_code_RC" />
		<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
			<include refid="sql_now_where2_RC" />
		</if>
		<if test=" aycx != null and aycx ==1 ">
			<include refid="sql_nowMonth_where2_RC" />
		</if>
		GROUP BY t4.code,t4.text,DIMORDER
		union
		select
		text,code,DIMORDER,
		sum(${mz_jzrc.indbName_value}) rc, 
		2 as flag
		from ${mz_jzrc.indbName_value} t1
		left join
		${mz_jzrc.dimDoctor} t4
		on
		t1.${mz_jzrc.dimDoctor} = t4.code
		where 1=1 <include refid="sql_where_doctor_code_RC" />
		<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
			<include refid="sql_yearOnYear_where2_RC" />
		</if>
		<if test=" aycx != null and aycx ==1 ">
			<include refid="sql_yearOnYearMonth_where2_RC" />
		</if>
		GROUP BY t4.code,t4.text,DIMORDER
		union
		select 
		text,code,DIMORDER,
		sum(${mz_jzrc.indbName_value}) rc, 
		3 as flag
		from ${mz_jzrc.indbName_value} t1
		left join
		${mz_jzrc.dimDoctor} t4
		on
		t1.${mz_jzrc.dimDoctor} = t4.code
		where 1=1 <include refid="sql_where_doctor_code_RC" />
		<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
			<include refid="sql_ringRatio_where2_RC" />
		</if>
		<if test=" aycx != null and aycx ==1 ">
			<include refid="sql_ringRatioMonth_where2_RC" />
		</if>
		GROUP BY t4.code,t4.text,DIMORDER) 
		<!-- TODO -->
		<include refid="sql_where_doctorCodes" />
		GROUP BY
			text,
			code,
			dimorder,
			flag 
		ORDER BY
			DIMORDER
		) GROUP BY
			text,
			code,
			dimorder 
			ORDER BY
			DIMORDER
		
	</select>

	<!--门诊人次-根据付款类型分组(人次，同比，环比)-->
	<select id="getOutpatientPersonTime" resultType="hashmap" parameterType="hashmap">
		select nvl(sum(rc), 0) rc,
		case when sum(rc2) <![CDATA[ <> ]]> 0 then round((sum(rc) - sum(rc2)) / sum(rc2), 4)
		else 0 end as yearOnYear,
		case when sum(rc3)  <![CDATA[ <> ]]> 0 then round((sum(rc) - sum(rc3)) / sum(rc3), 4)
		else 0 end as ringRatio,code,text 
		from (
				select case when flag = 1 then sum(rc) else 0 end rc,
				case when flag = 2 then sum(rc) else 0 end rc2,
				case when flag = 3 then sum(rc) else 0 end rc3,code,text
				from (
						select sum(${mz_jzrc.indbName_value}) rc, t2.code code,t2.text, 1 as flag
						from ${mz_jzrc.indbName_value} t1, ${mz_jzrc.dimRegisteredSource} t2
						where t1.${mz_jzrc.dimRegisteredSource}= t2.code
						<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
							<include refid="sql_now_where2_RC" />
						</if>
						<if test=" aycx != null and aycx ==1 ">
							<include refid="sql_nowMonth_where2_RC" />
						</if>
						group by t2.code, t2.text
						
						union
						select sum(${mz_jzrc.indbName_value}) rc, t2.code code,
						t2.text, 2 as flag
						from ${mz_jzrc.indbName_value} t1,  ${mz_jzrc.dimRegisteredSource} t2
						where t1. ${mz_jzrc.dimRegisteredSource}
						= t2.code
						<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
							<include refid="sql_yearOnYear_where2_RC" />
						</if>
						<if test=" aycx != null and aycx ==1 ">
							<include refid="sql_yearOnYearMonth_where2_RC" />
						</if>
						group by t2.code, t2.text
						
						union
						select sum(${mz_jzrc.indbName_value}) rc, t2.code code,
						t2.text, 3 as flag
						from ${mz_jzrc.indbName_value} t1, ${mz_jzrc.dimRegisteredSource} t2
						where t1. ${mz_jzrc.dimRegisteredSource}
						= t2.code
						<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
							<include refid="sql_ringRatio_where2_RC" />
						</if>
						<if test=" aycx != null and aycx ==1 ">
							<include refid="sql_ringRatioMonth_where2_RC" />
						</if>
						group by t2.code, t2.text
				) group by flag, code, text
		) group by code,text order by code
	</select>

	<!-- 住院人次-(收治人次，出院人次，手术人次，同比，环比) -->
	<select id="getHospitalizationPersonTime" resultType="hashmap" parameterType="hashmap">
		select nvl(sum(rc), 0) rc,'收治患者人次' as text,
		case when sum(rc2) <![CDATA[ <> ]]> 0 then round((sum(rc) - sum(rc2)) / sum(rc2), 4) 
		else 0 end as yearOnYear,
		case when sum(rc3) <![CDATA[ <> ]]> 0 then round((sum(rc) - sum(rc3)) / sum(rc3), 4)
		else 0 end as ringRatio 
		from (
			select case when flag = 1 then sum(rc) else 0 end rc,
			case when flag = 2 then sum(rc) else 0 end rc2,
			case when flag = 3 then
			sum(rc) else 0 end rc3 
			from (
				select sum(${sz_br.indbName_value}) rc, 1 as flag 
				from ${sz_br.indbName_value} t1 where t1.${sz_br.dimSzbrType}='0'
				<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
					<if test='startDate != null'>
						and t1.${sz_br.dimTime} >= #{startDate,jdbcType=VARCHAR}
					</if>
					<if test='endDate != null'>and
						t1.${sz_br.dimTime} <![CDATA[ <= ]]> #{endDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${sz_br.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yf != null'>
						and t1.${sz_br.dimMonth} = #{yf,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${sz_br.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				union
				
				select sum(${sz_br.indbName_value}) rc, 1 as flag from ${sz_br.indbName_value} t1 where t1.${sz_br.dimSzbrType}='1'
				<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
					<if test='startDate != null'>
						and t1.${sz_br.dimTime} >= #{startDate,jdbcType=VARCHAR}
					</if>
					<if test='endDate != null'>and
						t1.${sz_br.dimTime} <![CDATA[ <= ]]> #{endDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${sz_br.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yf != null'>
						and t1.${sz_br.dimMonth} = #{yf,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${sz_br.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				union
				select sum(${sz_br.indbName_value}) rc, 2 as flag
				from ${sz_br.indbName_value} t1
				where t1.${sz_br.dimSzbrType}='0'
				<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
					<if test='yearOnYearStartDate != null'>
						and t1.${sz_br.dimTime} >=#{yearOnYearStartDate,jdbcType=VARCHAR}
					</if>
					<if test='yearOnYearEndDate != null'>and
						t1.${sz_br.dimTime} <![CDATA[ <= ]]> #{yearOnYearEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${sz_br.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yearOnYearMonth != null'>
						and t1.${sz_br.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${sz_br.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				
				union
				select sum(${sz_br.indbName_value}) rc, 2 as flag
				from ${sz_br.indbName_value} t1
				where t1.${sz_br.dimSzbrType}='1'
				<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
					<if test='yearOnYearStartDate != null'>
						and t1.${sz_br.dimTime} >=#{yearOnYearStartDate,jdbcType=VARCHAR}
					</if>
					<if test='yearOnYearEndDate != null'>and
						t1.${sz_br.dimTime} <![CDATA[ <= ]]>#{yearOnYearEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${sz_br.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yearOnYearMonth != null'>
						and t1.${sz_br.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${sz_br.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				
				union
				select sum(${sz_br.indbName_value}) rc, 3 as flag
				from ${sz_br.indbName_value} t1
				where t1.${sz_br.dimSzbrType}='0'
				<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
					<if test='ringRatioStartDate != null'>
						and t1.${sz_br.dimTime} >=#{ringRatioStartDate,jdbcType=VARCHAR}
					</if>
					<if test='ringRatioEndDate != null'>and
						t1.${sz_br.dimTime} <![CDATA[ <= ]]>#{ringRatioEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${sz_br.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='ringRatioMonth != null'>
						and t1.${sz_br.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${sz_br.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				
				union
				select sum(${sz_br.indbName_value}) rc, 3 as flag
				from ${sz_br.indbName_value} t1
				where t1.${sz_br.dimSzbrType}='1'
				<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
					<if test='ringRatioStartDate != null'>
						and t1.${sz_br.dimTime} >=#{ringRatioStartDate,jdbcType=VARCHAR}
					</if>
					<if test='ringRatioEndDate != null'>and
						t1.${sz_br.dimTime} <![CDATA[ <= ]]>#{ringRatioEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${sz_br.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='ringRatioMonth != null'>
						and t1.${sz_br.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${sz_br.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) group by flag
		)

		union all

		select nvl(sum(rc), 0) rc,'出院人次' as text,
		case when sum(rc2) <![CDATA[ <> ]]> 0 then round((sum(rc) - sum(rc2)) / sum(rc2), 4)
		else 0 end as yearOnYear,
		case when sum(rc3) <![CDATA[ <> ]]> 0 then round((sum(rc) - sum(rc3)) / sum(rc3), 4)
		else 0 end as ringRatio
		from (
			select case when flag = 1 then sum(rc) else 0 end rc,
			case when flag = 2 then sum(rc) else 0 end rc2,
			case when flag = 3 then sum(rc) else 0 end rc3
			from (
				select sum(${zy_jzrc.indbName_value}) rc, 1 as flag
				from ${zy_jzrc.indbName_value} t1 where 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
					<include refid="sql_now_where2_RC" />
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<include refid="sql_nowMonth_where2_RC" />
				</if>

				union
				select sum(${zy_jzrc.indbName_value}) rc, 2 as flag from ${zy_jzrc.indbName_value} t1
				where 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
					<include refid="sql_yearOnYear_where2_RC" />
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<include refid="sql_yearOnYearMonth_where2_RC" />
				</if>
		
				union
				select sum(${zy_jzrc.indbName_value}) rc, 3 as flag
				from ${zy_jzrc.indbName_value} t1
				where 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
					<include refid="sql_ringRatio_where2_RC" />
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<include refid="sql_ringRatioMonth_where2_RC" />
				</if>
			) group by flag
		)

		union all

		select nvl(sum(rc), 0) rc,'手术人次' as text,
		case when sum(rc2) <![CDATA[ <> ]]> 0 then round((sum(rc) - sum(rc2)) / sum(rc2), 4) 
		else 0 end as yearOnYear,
		case when sum(rc3) <![CDATA[ <> ]]> 0 then round((sum(rc) - sum(rc3)) / sum(rc3), 4)
		else 0 end as ringRatio
		from (
			select case when flag = 1 then sum(rc) else 0 end rc,
			case when flag = 2 then sum(rc) else 0 end rc2,
			case when flag = 3 then
			sum(rc) else 0 end rc3
			from (
				select sum(${ss_jzrc.indbName_value}) rc, 1 as flag from ${ss_jzrc.indbName_value} t1
				where 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
					<if test='startDate != null'>
						and t1.${ss_jzrc.dimTime} >= #{startDate,jdbcType=VARCHAR}
					</if>
					<if test='endDate != null'>
						and t1.${ss_jzrc.dimTime} <![CDATA[ <= ]]>#{endDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${ss_jzrc.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yf != null'>
						and t1.${ss_jzrc.dimMonth} = #{yf,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${ss_jzrc.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				
				union
				select sum(${ss_jzrc.indbName_value}) rc, 2 as flag from ${ss_jzrc.indbName_value} t1 where 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
					<if test='yearOnYearStartDate != null'>
						and t1.${ss_jzrc.dimTime} >=#{yearOnYearStartDate,jdbcType=VARCHAR}
					</if>
					<if test='yearOnYearEndDate != null'>and
						t1.${ss_jzrc.dimTime} <![CDATA[ <= ]]>#{yearOnYearEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${ss_jzrc.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yearOnYearMonth != null'>
						and t1.${ss_jzrc.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${ss_jzrc.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			
				union
				select sum(${ss_jzrc.indbName_value}) rc, 3 as flag from ${ss_jzrc.indbName_value} t1 where 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
					<if test='ringRatioStartDate != null'>
						and t1.${ss_jzrc.dimTime} >=#{ringRatioStartDate,jdbcType=VARCHAR}
					</if>
					<if test='ringRatioEndDate != null'>and
						t1.${ss_jzrc.dimTime} <![CDATA[ <= ]]>#{ringRatioEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${ss_jzrc.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='ringRatioMonth != null'>
						and t1.${ss_jzrc.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${ss_jzrc.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) group by flag
		)
	</select>

	<select id="getDrugOccupationRatioByOutpatient" resultType="hashmap"
		parameterType="hashmap">
		select
		case when zfy4 <![CDATA[ <> ]]> 0 then round(sum(zfy)/ zfy4, 4) else 0 end as zb,
		case when zfy5 <![CDATA[ <> ]]> 0 then round(sum(zfy2) / zfy5 , 4) else 0 end as yearOnYear,
		case when zfy6 <![CDATA[ <> ]]> 0 then round(sum(zfy3) / zfy6 , 4) else 0 end as ringRatio,
		code,text
		from (
		select case when flag = 1 then sum(zfy) else 0 end zfy,
		case when flag = 2 then sum(zfy) else 0 end zfy2,
		case when flag = 3 then sum(zfy) else 0 end zfy3,
		code,text,
		(
		<if test=" CWorYW !='CW' ">
			select sum(${yw_mzxx.indbName_value}) from ${yw_mzxx.indbName_value} t1,
			${yw_mzxx.dimExpenseType} t2
			where 1=1 and
			t1.${yw_mzxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			) as zfy4,
			( 
			select sum(${yw_mzxx.indbName_value}) from ${yw_mzxx.indbName_value} t1,
			${yw_mzxx.dimExpenseType} t2
			where 1=1 and
			t1.${yw_mzxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			) as zfy5,
			( 
			select sum(${yw_mzxx.indbName_value}) from ${yw_mzxx.indbName_value} t1,
			${yw_mzxx.dimExpenseType} t2
			where 1=1 and
			t1.${yw_mzxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			) as zfy6
			from (
			select sum(${yw_mzxx.indbName_value}) zfy, t2.code,t2.text,1 as flag
			from ${yw_mzxx.indbName_value}
			t1,${yw_mzxx.dimExpenseType} t2
			where 1=1
			and t1.${yw_mzxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>

			group by t2.code,t2.text
			union
			select sum(${yw_mzxx.indbName_value}) zfy, t2.code,t2.text,2 as flag
			from ${yw_mzxx.indbName_value}
			t1,${yw_mzxx.dimExpenseType} t2
			where 1=1
			and t1.${yw_mzxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			group by t2.code,t2.text
			union
			select sum(${yw_mzxx.indbName_value}) zfy, t2.code,t2.text,3 as flag
			from ${yw_mzxx.indbName_value}
			t1,${yw_mzxx.dimExpenseType} t2
			where 1=1
			and t1.${yw_mzxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			group by t2.code,t2.text
		</if>
		
		<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
			select sum(${cw_mzxx.indbName_value}) from ${cw_mzxx.indbName_value} t1,
			${cw_mzxx.dimExpenseType} t2
			where 1=1 and
			t1.${cw_mzxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			) as zfy4,
			( 
			select sum(${cw_mzxx.indbName_value}) from ${cw_mzxx.indbName_value} t1,
			${cw_mzxx.dimExpenseType} t2
			where 1=1 and
			t1.${cw_mzxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			) as zfy5,
			( 
			select sum(${cw_mzxx.indbName_value}) from ${cw_mzxx.indbName_value} t1,
			${cw_mzxx.dimExpenseType} t2
			where 1=1 and
			t1.${cw_mzxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			) as zfy6
			from (
			select sum(${cw_mzxx.indbName_value}) zfy, t2.code,t2.text,1 as flag
			from ${cw_mzxx.indbName_value}
			t1,${cw_mzxx.dimExpenseType} t2
			where 1=1
			and t1.${cw_mzxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			group by t2.code,t2.text
			union
			select sum(${cw_mzxx.indbName_value}) zfy, t2.code,t2.text,2 as flag
			from ${cw_mzxx.indbName_value}
			t1,${cw_mzxx.dimExpenseType} t2
			where 1=1
			and t1.${cw_mzxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			group by t2.code,t2.text
			union
			select sum(${cw_mzxx.indbName_value}) zfy, t2.code,t2.text,3 as flag
			from ${cw_mzxx.indbName_value}
			t1,${cw_mzxx.dimExpenseType} t2
			where 1=1
			and t1.${cw_mzxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			group by t2.code,t2.text
		</if>
		)group by flag,code,text)group by code,text,zfy4,zfy5,zfy6
		<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
			order by text
		</if>
		<if test="  CWorYW !='CW' ">
			order by code
		</if>
	</select>
	<select id="getCountDrugOccupationRatioByOutpatient" resultType="hashmap"
		parameterType="hashmap">
		select '门诊药占比' as text,
		case
		when sum(bqzfy) = 0 then 0
		else
		round(sum(bqypzfy) / sum(bqzfy), 4)
		end as zb,
		case
		when sum(tqzfy) = 0
		then 0 else
		round((sum(tqypzfy)) / sum(tqzfy), 4)
		end as yearOnYear,
		case
		when sum(syzfy) = 0 then 0 else
		round((sum(syypzfy)) / sum(syzfy),
		4)
		end as ringRatio
		from (select case
		when flag = 1 then
		sum(zfy)
		else
		0
		end
		bqypzfy,
		case
		when flag = 2 then
		sum(zfy)
		else
		0
		end tqypzfy,
		case
		when flag =
		3 then
		sum(zfy)
		else
		0
		end syypzfy,
		case
		when flag = 4 then
		sum(zfy)
		else
		0
		end
		bqzfy,
		case
		when flag = 5 then
		sum(zfy)
		else
		0
		end tqzfy,
		case
		when flag = 6
		then
		sum(zfy)
		else
		0
		end syzfy
		from (
		<if test=" CWorYW !='CW' ">
			select sum(${yw_mzxx.indbName_value}) zfy, 1 as flag
			from 
			${yw_mzxx.indbName_value} t1, ${yw_mzxx.dimExpenseType} t2
			where 1 = 1
			and t1.${yw_mzxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			union
			select sum(${yw_mzxx.indbName_value}) zfy, 2 as flag
			from ${yw_mzxx.indbName_value} t1,
			${yw_mzxx.dimExpenseType} t2
			where 1 = 1
			and t1.${yw_mzxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			union
			select sum(${yw_mzxx.indbName_value}) zfy, 3 as flag
			from ${yw_mzxx.indbName_value} t1,
			${yw_mzxx.dimExpenseType} t2
			where 1 = 1
			and t1.${yw_mzxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			union
			select sum(${yw_mzxx.indbName_value}) zfy, 4 as flag
			from ${yw_mzxx.indbName_value} t1,
			${yw_mzxx.dimExpenseType} t2
			where 1 = 1
			and t1.${yw_mzxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			union
			select sum(${yw_mzxx.indbName_value}) zfy, 5 as flag
			from ${yw_mzxx.indbName_value} t1,
			${yw_mzxx.dimExpenseType} t2
			where 1 = 1
			and t1.${yw_mzxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			union
			select sum(${yw_mzxx.indbName_value}) zfy, 6 as flag
			from ${yw_mzxx.indbName_value} t1,
			${yw_mzxx.dimExpenseType} t2
			where 1 = 1
			and t1.${yw_mzxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
		</if>
		<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
			select sum(${cw_mzxx.indbName_value}) zfy, 1 as flag
			from ${cw_mzxx.indbName_value} t1, ${cw_mzxx.dimExpenseType}
			t2
			where 1 = 1
			and t1.${cw_mzxx.dimExpenseType} = t2.code
			and t2.code in
			('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			union
			select sum(${cw_mzxx.indbName_value}) zfy, 2 as flag
			from ${cw_mzxx.indbName_value} t1,
			${cw_mzxx.dimExpenseType} t2
			where 1 = 1
			and t1.${cw_mzxx.dimExpenseType} = t2.code
			and t2.code in
			('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			union
			select sum(${cw_mzxx.indbName_value}) zfy, 3 as flag
			from ${cw_mzxx.indbName_value} t1,
			${cw_mzxx.dimExpenseType} t2
			where 1 = 1
			and t1.${cw_mzxx.dimExpenseType} = t2.code
			and t2.code in
			('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			union
			select sum(${cw_mzxx.indbName_value}) zfy, 4 as flag
			from ${cw_mzxx.indbName_value} t1,
			${cw_mzxx.dimExpenseType} t2
			where 1 = 1
			and t1.${cw_mzxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			union
			select sum(${cw_mzxx.indbName_value}) zfy, 5 as flag
			from ${cw_mzxx.indbName_value} t1,
			${cw_mzxx.dimExpenseType} t2
			where 1 = 1
			and t1.${cw_mzxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>

			union
			select sum(${cw_mzxx.indbName_value}) zfy, 6 as flag
			from ${cw_mzxx.indbName_value} t1,
			${cw_mzxx.dimExpenseType} t2
			where 1 = 1
			and t1.${cw_mzxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
		</if>
		)
		group by flag)

	</select>

	<select id="getDrugOccupationRatioByHospitalization" resultType="hashmap"
		parameterType="hashmap">
		select case when zfy4 <![CDATA[ <> ]]>
		0 then round(sum(zfy)/zfy4,4) else 0 end as zb,
		case when zfy5  <![CDATA[ <> ]]>
		0 then round( sum(zfy2) / zfy5, 4) else 0 end as
		yearOnYear,
		case when
		zfy6 <![CDATA[ <> ]]>
		0 then round( sum(zfy3) / zfy6, 4) else 0 end as
		ringRatio,
		code,text
		from (select case when flag = 1 then sum(zfy) else 0 end zfy,
		case when
		flag = 2 then sum(zfy) else 0 end zfy2,
		case when flag = 3 then
		sum(zfy) else 0 end zfy3,
		code,text,
		(
		<if test="  CWorYW !='CW' ">
			select sum(${yw_zyxx.indbName_value}) from 
			${yw_zyxx.indbName_value} t1 ,${yw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${yw_zyxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			) zfy4,
			(
			select sum(${yw_zyxx.indbName_value}) from 
			${yw_zyxx.indbName_value} t1 ,${yw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${yw_zyxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			) zfy5,
			(
			select sum(${yw_zyxx.indbName_value}) from 
			${yw_zyxx.indbName_value} t1 ,${yw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${yw_zyxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			) zfy6
			from (
			select sum(${yw_zyxx.indbName_value}) zfy, t2.code,t2.text,1 as flag
			from ${yw_zyxx.indbName_value}
			t1,${yw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${yw_zyxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			group by t2.code,t2.text
			union
			select sum(${yw_zyxx.indbName_value}) zfy, t2.code,t2.text,2 as flag
			from ${yw_zyxx.indbName_value}
			t1,${yw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${yw_zyxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			group by t2.code,t2.text
			union
			select sum(${yw_zyxx.indbName_value}) zfy, t2.code,t2.text,3 as flag
			from ${yw_zyxx.indbName_value}
			t1,${yw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${yw_zyxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			group by t2.code,t2.text
		</if>
		<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
			select sum(${cw_zyxx.indbName_value}) from ${cw_zyxx.indbName_value} t1,
			${cw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${cw_zyxx.dimExpenseType} = t2.code
			
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			) zfy4,
			(
			select sum(${cw_zyxx.indbName_value}) from ${cw_zyxx.indbName_value} t1,
			${cw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${cw_zyxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			) zfy5,
			(
			select sum(${cw_zyxx.indbName_value}) from ${cw_zyxx.indbName_value} t1,
			${cw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${cw_zyxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			) zfy6
			from (
			select sum(${cw_zyxx.indbName_value}) zfy, t2.code,t2.text,1 as flag
			from ${cw_zyxx.indbName_value}
			t1,${cw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${cw_zyxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			group by t2.code,t2.text
			union
			select sum(${cw_zyxx.indbName_value}) zfy, t2.code,t2.text,2 as flag
			from ${cw_zyxx.indbName_value}
			t1,${cw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${cw_zyxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			group by t2.code,t2.text
			union
			select sum(${cw_zyxx.indbName_value}) zfy, t2.code,t2.text,3 as flag
			from ${cw_zyxx.indbName_value}
			t1,${cw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${cw_zyxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			group by t2.code,t2.text
		</if>
		)group by flag,code,text)group by code,text,zfy4,zfy5,zfy6
		<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
			order by text
		</if>
		<if test="  CWorYW !='CW' ">
			order by code
		</if>
	</select>
	<select id="getCountDrugOccupationRatioByHospitalization"
		resultType="hashmap" parameterType="hashmap">
		select '住院药占比' as text,
		case when sum(zfy4) <![CDATA[ <> ]]>
		0 then round(sum(zfy)/sum(zfy4),4) else 0 end as zb,
		case when
		sum(zfy5) <![CDATA[ <> ]]>
		0 then round( sum(zfy2) / sum(zfy5), 4) else 0 end as
		yearOnYear,
		case
		when sum(zfy6) <![CDATA[ <> ]]>
		0 then round( sum(zfy3) / sum(zfy6), 4) else 0 end as ringRatio
		from
		(select case when flag = 1 then sum(zfy) else 0 end zfy,
		case when flag
		= 2 then sum(zfy) else 0 end zfy2,
		case when flag = 3 then sum(zfy)
		else 0 end zfy3,
		case when flag = 4 then sum(zfy) else 0 end zfy4,
		case
		when flag = 5 then sum(zfy) else 0 end zfy5,
		case when flag = 6 then
		sum(zfy) else 0 end zfy6
		from (
		<if test="  CWorYW !='CW' ">
			select sum(${yw_zyxx.indbName_value}) zfy, 1 as flag from ${yw_zyxx.indbName_value} t1,
			${yw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${yw_zyxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			union
			select sum(${yw_zyxx.indbName_value}) zfy, 2 as flag from ${yw_zyxx.indbName_value} t1,
			${yw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${yw_zyxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			union
			select sum(${yw_zyxx.indbName_value}) zfy, 3 as flag from ${yw_zyxx.indbName_value} t1,
			${yw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${yw_zyxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			union
			select sum(${yw_zyxx.indbName_value}) zfy, 4 as flag from 
			${yw_zyxx.indbName_value} t1,
			${yw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${yw_zyxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			union
			select sum(${yw_zyxx.indbName_value}) zfy, 5 as flag from 
			${yw_zyxx.indbName_value} t1,
			${yw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${yw_zyxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			union
			select sum(${yw_zyxx.indbName_value}) zfy, 6 as flag from 
			${yw_zyxx.indbName_value} t1,
			${yw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${yw_zyxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
		</if>
		<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
			select sum(${cw_zyxx.indbName_value}) zfy, 1 as flag from 
			${cw_zyxx.indbName_value} t1,${cw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${cw_zyxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			union
			select sum(${cw_zyxx.indbName_value}) zfy, 2 as flag from 
			${cw_zyxx.indbName_value} t1,${cw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${cw_zyxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			union
			select sum(${cw_zyxx.indbName_value}) zfy, 3 as flag from 
			${cw_zyxx.indbName_value} t1,${cw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${cw_zyxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			union
			select sum(${cw_zyxx.indbName_value}) zfy, 4 as flag from 
			${cw_zyxx.indbName_value} t1,
			${cw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${cw_zyxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			union
			select sum(${cw_zyxx.indbName_value}) zfy, 5 as flag from 
			${cw_zyxx.indbName_value} t1,
			${cw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${cw_zyxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			union
			select sum(${cw_zyxx.indbName_value}) zfy, 6 as flag from 
			${cw_zyxx.indbName_value} t1,
			${cw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${cw_zyxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
		</if>
		)group by flag)
	</select>
	<!--门诊药品收入-->
	<select id="cxmzypsr" resultType="hashmap" parameterType="hashmap">
		select sum(indb001769)  mzypsr, dim0000865 ypfl from indb001769
		where dim0000001 <![CDATA[>=]]> #{dateBegin} and dim0000001 <![CDATA[ <= ]]> #{dateEnd}
		and dim0000865 in ('88','85','86')
		group by dim0000865
	</select>

	<!--门诊收入-->
	<select id="cxmzsr" resultType="hashmap" parameterType="hashmap">
		select sum(indb002247)  mzsr from indb002247
		where dim0000001 <![CDATA[>=]]> #{dateBegin} and dim0000001 <![CDATA[ <= ]]> #{dateEnd}
	</select>

	<!--住院药品收入， 结果中需要按照 药品类型分类-->
	<select id="cxzyypsr" resultType="hashmap" parameterType="hashmap">
		select sum(indb001762)  zyypsr, dim0000865 ypfl from indb001762
		where dim0000001 <![CDATA[>=]]> #{dateBegin} and dim0000001 <![CDATA[ <= ]]> #{dateEnd}
		and dim0000865 in ('88','85','86')
		group by dim0000865
	</select>

	<!--住院收入-->
	<select id="cxzysr" resultType="hashmap" parameterType="hashmap">
		select sum(indb002248)  zysr from indb002248
		where dim0000001 <![CDATA[>=]]> #{dateBegin} and dim0000001 <![CDATA[ <= ]]> #{dateEnd}
	</select>
	
	<!-- 当月总药占比 -->
	<select id="getCountDrugOccupationRatio" resultType="hashmap" parameterType="hashmap">
		<if test='TJCX != true '>
			select text,zb,
			case when yearOnYear <![CDATA[ <> ]]> 0 then round((zb - yearOnYear) / yearOnYear, 4) else 0 end as yearOnYear,
			case when ringRatio <![CDATA[ <> ]]> 0 then round((zb - ringRatio) / ringRatio, 4) else 0 end as ringRatio
			from (
			select '药占比' as text,
			case when sum(zfy4) <![CDATA[ <> ]]> 0 then round(sum(zfy) / sum(zfy4), 4) else 0 end as zb,
			case when sum(zfy5) <![CDATA[ <> ]]> 0 then round(sum(zfy2) / sum(zfy5), 4) else 0 end as yearOnYear,
			case when sum(zfy6) <![CDATA[ <> ]]> 0 then round((sum(zfy3)) / sum(zfy6), 4) else 0 end as ringRatio
			from(
			select case when flag = 1 then sum(zfy) else 0 end zfy,	<!-- 门诊住院药品总收入 -->
			case when flag = 2 then sum(zfy) else 0 end zfy2,	<!-- 门诊住院药品同值 -->
			case when flag = 3 then sum(zfy) else 0 end zfy3,	<!-- 门诊住院药品环值 -->
			case when flag = 4 then sum(zfy) else 0 end zfy4,	<!-- 门诊住院业务总收入 -->
			case when flag = 5 then sum(zfy) else 0 end zfy5,	<!-- 门诊住院业务同值 -->
			case when flag = 6 then sum(zfy) else 0 end zfy6	<!-- 门诊住院业务环值 -->
			from (
			<!-- 门诊、住院药品总收入 -->
			select ( select sum(${mz_ypsr.indbName_value}) zfy from ${mz_ypsr.indbName_value} t1
					<!-- ,${mz_ypsr.dimChargeType} t2 -->
					where 1 = 1
					<!-- and t1.${mz_ypsr.dimChargeType} = t2.code -->
					<include refid="sql_nowMonth_where_mz_ypsr" />
					) +
					( select sum(${zy_ypsr.indbName_value}) zfy from ${zy_ypsr.indbName_value} t1
						<!-- , ${zy_ypsr.dimChargeType} t2 -->
						where 1 = 1
						<!-- and t1.${zy_ypsr.dimChargeType} = t2.code -->
						<include refid="sql_nowMonth_where_zy_ypsr" />
					) as zfy, 1 as flag from dual
			union
			<!-- 门诊、住院药品同比 -->
			select ( select sum(${mz_ypsr.indbName_value}) zfy from ${mz_ypsr.indbName_value} t1
					<!-- , ${mz_ypsr.dimChargeType} t2 -->
					where 1 = 1
					<!-- and t1.${mz_ypsr.dimChargeType} = t2.code -->
					<include refid="sql_yearOnYearMonth_where_mz_ypsr" />
					) +
					( select sum(${zy_ypsr.indbName_value}) zfy from ${zy_ypsr.indbName_value} t1
						<!-- , ${zy_ypsr.dimChargeType} t2 -->
						where 1 = 1
						<!-- and t1.${zy_ypsr.dimChargeType} = t2.code -->
						<include refid="sql_yearOnYearMonth_where_zy_ypsr" />
					) as zfy, 2 as flag from dual
			union
			<!-- 门诊、住院药品环比 -->
			select ( select sum(${mz_ypsr.indbName_value}) zfy from ${mz_ypsr.indbName_value} t1
						<!-- , ${mz_ypsr.dimChargeType} t2 -->
						where 1 = 1
						<!-- and t1.${mz_ypsr.dimChargeType} = t2.code -->
						<include refid="sql_ringRatioMonth_where_mz_ypsr" />
					) +
					( select sum(${zy_ypsr.indbName_value}) zfy from ${zy_ypsr.indbName_value} t1
						<!-- , ${zy_ypsr.dimChargeType} t2 -->
						where 1 = 1
						<!-- and t1.${zy_ypsr.dimChargeType} = t2.code -->
						<include refid="sql_ringRatioMonth_where_zy_ypsr" />
					) as zfy, 3 as flag from dual
			union
			<!-- 业务门诊住院总收入 -->
			select ( select sum(${yw_mzxx.indbName_value}) from ${yw_mzxx.indbName_value} t1
					<!-- , ${yw_mzxx.dimExpenseType} t2 -->
					where 1 = 1
					<!-- and t1.${yw_mzxx.dimExpenseType} = t2.code -->
					<include refid="sql_nowMonth_where2_yw_mzxx" />
				  ) +
				 ( select sum(${yw_zyxx.indbName_value}) from ${yw_zyxx.indbName_value} t1
					<!-- , ${yw_mzxx.dimExpenseType} t2 -->
					where 1 = 1
					<!-- and t1.${yw_mzxx.dimExpenseType} = t2.code -->
					<include refid="sql_nowMonth_where2_yw_zyxx" />
				 ) zfy, 4 as flag from dual
			union
			<!-- 业务门诊住院同比 -->
			select ( select sum(${yw_mzxx.indbName_value}) from ${yw_mzxx.indbName_value} t1
						<!-- , ${yw_mzxx.dimExpenseType} t2 -->
						where 1 = 1
						<!-- and t1.${yw_mzxx.dimExpenseType} = t2.code -->
						<if test='yearOnYearMonth != null'> and t1.${yw_mzxx.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
						</if>
						<if test="size != 0">
							and t1.${yw_mzxx.dimOrganization} in
							<foreach item="item" collection="jgidList" open="(" separator="," close=")">
								#{item.jgid,jdbcType=VARCHAR}
							</foreach>
						</if>
					) +
					( select sum(${yw_zyxx.indbName_value}) from ${yw_zyxx.indbName_value} t1
						<!-- , ${yw_zyxx.dimExpenseType} t2 -->
						where 1 =1
						<!-- and t1. ${yw_zyxx.dimExpenseType} = t2.code -->
						<if test='yearOnYearMonth != null'> and t1.${yw_zyxx.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
						</if>
						<if test="size != 0">
							and t1.${yw_zyxx.dimOrganization} in
							<foreach item="item" collection="jgidList" open="(" separator="," close=")">
								#{item.jgid,jdbcType=VARCHAR}
							</foreach>
						</if>
					) zfy, 5 as flag from dual
			union
			<!-- 业务门诊住院环比 -->
			select ( select sum(${yw_mzxx.indbName_value}) from ${yw_mzxx.indbName_value} t1
						<!-- , ${yw_mzxx.dimExpenseType} t2 -->
						where 1 = 1
						<!-- and t1.${yw_mzxx.dimExpenseType} = t2.code -->
						<if test='ringRatioMonth != null'>and t1.${yw_mzxx.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
						</if>
						<if test="size != 0">
							and t1.${yw_mzxx.dimOrganization} in
							<foreach item="item" collection="jgidList" open="(" separator="," close=")">
								#{item.jgid,jdbcType=VARCHAR}
							</foreach>
						</if>
					) +
					( select sum(${yw_zyxx.indbName_value}) from ${yw_zyxx.indbName_value} t1, ${yw_zyxx.dimExpenseType} t2
						where 1 = 1 and t1.${yw_zyxx.dimExpenseType} = t2.code
						<if test='ringRatioMonth != null'>and t1.${yw_zyxx.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
						</if>
						<if test="size != 0">
							and t1.${yw_zyxx.dimOrganization} in
							<foreach item="item" collection="jgidList" open="(" separator="," close=")">
								#{item.jgid,jdbcType=VARCHAR}
							</foreach>
						</if>
					) zfy, 6 as flag from dual 
			 	)group by flag
			 )
		)
		</if>
		<if test='TJCX != null'>
			select '药占比' text,
			case when zfy4 <![CDATA[ <> ]]> 0 then round(sum(zfy)/zfy4,4) else 0 end as zb,
			case when zfy5  <![CDATA[ <> ]]> 0 then round( sum(zfy2) / zfy5, 4) else 0 end as yearOnYear,
			case when zfy6  <![CDATA[ <> ]]> 0 then round( sum(zfy3) / zfy6, 4) else 0 end as ringRatio
			from (select case when flag = 1 then sum(zfy) else 0 end zfy,
			case when flag = 2 then sum(zfy) else 0 end zfy2,
			case when flag = 3 then sum(zfy) else 0 end zfy3,
			(
			<if test=" CWorYW !='CW' ">
				select ( select sum(${yw_mzxx.indbName_value}) from ${yw_mzxx.indbName_value} t1
							where 1 = 1
							<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
								<if test='startDate != null'> and t1.${yw_mzxx.dimTime} >= #{startDate,jdbcType=VARCHAR}</if>
								<if test='endDate != null'>and t1.${yw_mzxx.dimTime} <![CDATA[ <= ]]> #{endDate,jdbcType=VARCHAR}
								</if>
								<if test="size != 0">
									and t1.${yw_mzxx.dimOrganization} in
									<foreach item="item" collection="jgidList" open="(" separator="," close=")">
										#{item.jgid,jdbcType=VARCHAR}
									</foreach>
								</if>
							</if>
							<if test=" aycx != null and aycx ==1 ">
								<if test='yf != null'> and t1.${yw_mzxx.dimMonth} = #{yf,jdbcType=VARCHAR}</if>
								<if test="size != 0">
									and t1.${yw_mzxx.dimOrganization} in
									<foreach item="item" collection="jgidList" open="(" separator="," close=")">
										#{item.jgid,jdbcType=VARCHAR}
									</foreach>
								</if>
							</if>
					) + 
					(   select sum(${yw_zyxx.indbName_value}) from ${yw_zyxx.indbName_value} t1
						where 1 = 1
						<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
							<if test='startDate != null'> and t1.${yw_zyxx.dimTime} >= #{startDate,jdbcType=VARCHAR}</if>
							<if test='endDate != null'>and
								t1.${yw_zyxx.dimTime} <![CDATA[ <= ]]> #{endDate,jdbcType=VARCHAR}
							</if>
							<if test="size != 0">
								and t1.${yw_zyxx.dimOrganization} in
								<foreach item="item" collection="jgidList" open="("
									separator="," close=")">
									#{item.jgid,jdbcType=VARCHAR}
								</foreach>
							</if>
						</if>
						<if test=" aycx != null and aycx ==1 ">
							<if test='yf != null'> and t1.${yw_zyxx.dimMonth} = #{yf,jdbcType=VARCHAR}</if>
							<if test="size != 0">
								and t1.${yw_zyxx.dimOrganization} in
								<foreach item="item" collection="jgidList" open="("
									separator="," close=")">
									#{item.jgid,jdbcType=VARCHAR}
								</foreach>
							</if>
						</if>
					) zfy from dual
			) as zfy4,
				( select 
					( select sum(${yw_mzxx.indbName_value}) from ${yw_mzxx.indbName_value} t1
						where 1 = 1
						<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
							<if test='yearOnYearStartDate != null'>and t1.${yw_mzxx.dimTime} >= #{yearOnYearStartDate,jdbcType=VARCHAR}
							</if>
							<if test='yearOnYearEndDate != null'>and t1.${yw_mzxx.dimTime} <![CDATA[ <= ]]> #{yearOnYearEndDate,jdbcType=VARCHAR}
							</if>
							<if test="size != 0">
								and t1.${yw_mzxx.dimOrganization} in
								<foreach item="item" collection="jgidList" open="(" separator="," close=")">
									#{item.jgid,jdbcType=VARCHAR}
								</foreach>
							</if>
						</if>
						<if test=" aycx != null and aycx ==1 ">
							<if test='yearOnYearMonth != null'> and t1.${yw_mzxx.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
							</if>
							<if test="size != 0">
								and t1.${yw_mzxx.dimOrganization} in
								<foreach item="item" collection="jgidList" open="(" separator="," close=")">
									#{item.jgid,jdbcType=VARCHAR}
								</foreach>
							</if>
						</if>
					) + 
					( select sum(${yw_zyxx.indbName_value}) from ${yw_zyxx.indbName_value} t1
						where 1 = 1
						<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
							<if test='yearOnYearStartDate != null'>
								and t1.${yw_zyxx.dimTime} >= #{yearOnYearStartDate,jdbcType=VARCHAR}
							</if>
							<if test='yearOnYearEndDate != null'>
								and t1.${yw_zyxx.dimTime} <![CDATA[ <= ]]> #{yearOnYearEndDate,jdbcType=VARCHAR}
							</if>
							<if test="size != 0">
								and t1.${yw_zyxx.dimOrganization} in
								<foreach item="item" collection="jgidList" open="(" separator="," close=")">
									#{item.jgid,jdbcType=VARCHAR}
								</foreach>
							</if>
						</if>
						<if test=" aycx != null and aycx ==1 ">
							<if test='yearOnYearMonth != null'> and t1.${yw_zyxx.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
							</if>
							<if test="size != 0">
								and t1.${yw_zyxx.dimOrganization} in
								<foreach item="item" collection="jgidList" open="(" separator="," close=")">
									#{item.jgid,jdbcType=VARCHAR}
								</foreach>
							</if>
						</if>
					) zfy from dual
				) as zfy5,
				( select ( select sum(${yw_mzxx.indbName_value}) from ${yw_mzxx.indbName_value} t1
							where 1 = 1
							<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
								<if test='ringRatioStartDate != null'>and t1.${yw_mzxx.dimTime} >= #{ringRatioStartDate,jdbcType=VARCHAR}
								</if>
								<if test='ringRatioEndDate != null'>and t1.${yw_mzxx.dimTime} <![CDATA[ <= ]]> #{ringRatioEndDate,jdbcType=VARCHAR}
								</if>
								<if test="size != 0">
									and t1.${yw_mzxx.dimOrganization} in
									<foreach item="item" collection="jgidList" open="(" separator="," close=")">
										#{item.jgid,jdbcType=VARCHAR}
									</foreach>
								</if>
							</if>
							<if test=" aycx != null and aycx ==1 ">
								<if test='ringRatioMonth != null'>and t1.${yw_mzxx.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
								</if>
								<if test="size != 0">
									and t1.${yw_mzxx.dimOrganization} in
									<foreach item="item" collection="jgidList" open="(" separator="," close=")">
										#{item.jgid,jdbcType=VARCHAR}
									</foreach>
								</if>
							</if>
						) + ( select sum(${yw_zyxx.indbName_value}) from ${yw_zyxx.indbName_value} t1
								where 1 = 1
								<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
									<if test='ringRatioStartDate != null'>and t1.${yw_zyxx.dimTime} >= #{ringRatioStartDate,jdbcType=VARCHAR}
									</if>
									<if test='ringRatioEndDate != null'>and t1.${yw_zyxx.dimTime} <![CDATA[ <= ]]> #{ringRatioEndDate,jdbcType=VARCHAR}
									</if>
									<if test="size != 0">
										and t1.${yw_zyxx.dimOrganization} in
										<foreach item="item" collection="jgidList" open="(" separator="," close=")">
											#{item.jgid,jdbcType=VARCHAR}
										</foreach>
									</if>
								</if>
								<if test=" aycx != null and aycx ==1 ">
									<if test='ringRatioMonth != null'>and t1.${yw_zyxx.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
									</if>
									<if test="size != 0">
										and t1.${yw_zyxx.dimOrganization} in
										<foreach item="item" collection="jgidList" open="("
											separator="," close=")">
											#{item.jgid,jdbcType=VARCHAR}
										</foreach>
									</if>
								</if>
							) zfy from dual
				) as zfy6,code,text
				from (
				--当前
				select sum(zfy) as zfy,code,text,1 as flag 
				from (
						( select sum(${yw_mzxx.indbName_value}) zfy,t2.code,t2.text from ${yw_mzxx.indbName_value} t1, ${yw_mzxx.dimExpenseType} t2
							where 1 = 1 and t1.${yw_mzxx.dimExpenseType} = t2.code and t2.code in ('12','13','14')
							<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
								<if test='startDate != null'> and t1.${yw_mzxx.dimTime} >= #{startDate,jdbcType=VARCHAR}</if>
								<if test='endDate != null'>and t1.${yw_mzxx.dimTime} <![CDATA[ <= ]]> #{endDate,jdbcType=VARCHAR}
								</if>
								<if test="size != 0">
									and t1.${yw_mzxx.dimOrganization} in
									<foreach item="item" collection="jgidList" open="(" separator="," close=")">
										#{item.jgid,jdbcType=VARCHAR}
									</foreach>
								</if>
							</if>
							<if test=" aycx != null and aycx ==1 ">
								<include refid="sql_nowMonth_where2_yw_mzxx" />
							</if>
							group by t2.code,t2.text )
						union
						( select sum(${yw_zyxx.indbName_value}) zfy,t2.code,t2.text from ${yw_zyxx.indbName_value} t1, ${yw_zyxx.dimExpenseType} t2
							where 1 = 1 and t1.${yw_zyxx.dimExpenseType} = t2.code and t2.code in ('12','13','14')
							<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
								<if test='startDate != null'> and t1.${yw_zyxx.dimTime} >= #{startDate,jdbcType=VARCHAR}</if>
								<if test='endDate != null'>and
									t1.${yw_zyxx.dimTime} <![CDATA[ <= ]]> #{endDate,jdbcType=VARCHAR}
								</if>
								<if test="size != 0">
									and t1.${yw_zyxx.dimOrganization} in
									<foreach item="item" collection="jgidList" open="("
										separator="," close=")">
										#{item.jgid,jdbcType=VARCHAR}
									</foreach>
								</if>
							</if>
							<if test=" aycx != null and aycx ==1 ">
								<include refid="sql_nowMonth_where2_yw_zyxx" />
							</if>
							group by t2.code,t2.text )
					) group by code,text
				--同比
				union
				select sum(zfy) as zfy, code, text, 2 as flag 
				from (
						( select sum(${yw_mzxx.indbName_value}) zfy, t2.code, t2.text
							from ${yw_mzxx.indbName_value} t1, ${yw_mzxx.dimExpenseType} t2
							where 1 = 1 and t1.${yw_mzxx.dimExpenseType} = t2.code and t2.code in ('12','13','14')
							<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
								<if test='yearOnYearStartDate != null'>and t1.${yw_mzxx.dimTime} >= #{yearOnYearStartDate,jdbcType=VARCHAR}
								</if>
								<if test='yearOnYearEndDate != null'>and
									t1.${yw_mzxx.dimTime} <![CDATA[ <= ]]> #{yearOnYearEndDate,jdbcType=VARCHAR}
								</if>
								<if test="size != 0">
									and t1.${yw_mzxx.dimOrganization} in
									<foreach item="item" collection="jgidList" open="(" separator="," close=")">
										#{item.jgid,jdbcType=VARCHAR}
									</foreach>
								</if>
							</if>
							<if test=" aycx != null and aycx ==1 ">
								<if test='yearOnYearMonth != null'> and t1.${yw_mzxx.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
								</if>
								<if test="size != 0">
									and t1.${yw_mzxx.dimOrganization} in
									<foreach item="item" collection="jgidList" open="(" separator="," close=")">
										#{item.jgid,jdbcType=VARCHAR}
									</foreach>
								</if>
							</if>
							group by t2.code, t2.text ) 
						union
						( select sum(${yw_zyxx.indbName_value}) zfy, t2.code, t2.text from ${yw_zyxx.indbName_value} t1, ${yw_zyxx.dimExpenseType} t2
							where 1 = 1 and t1.${yw_zyxx.dimExpenseType} = t2.code and t2.code in ('12','13','14')
							<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
								<if test='yearOnYearStartDate != null'>and t1.${yw_zyxx.dimTime} >= #{yearOnYearStartDate,jdbcType=VARCHAR}
								</if>
								<if test='yearOnYearEndDate != null'>and t1.${yw_zyxx.dimTime} <![CDATA[ <= ]]> #{yearOnYearEndDate,jdbcType=VARCHAR}
								</if>
								<if test="size != 0">
									and t1.${yw_zyxx.dimOrganization} in
									<foreach item="item" collection="jgidList" open="(" separator="," close=")">
										#{item.jgid,jdbcType=VARCHAR}
									</foreach>
								</if>
							</if>
							<if test=" aycx != null and aycx ==1 ">
								<if test='yearOnYearMonth != null'> and t1.${yw_zyxx.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
								</if>
								<if test="size != 0">
									and t1.${yw_zyxx.dimOrganization} in
									<foreach item="item" collection="jgidList" open="(" separator="," close=")">
										#{item.jgid,jdbcType=VARCHAR}
									</foreach>
								</if>
							</if>
							group by t2.code, t2.text )
					) group by code, text
					--环比
					union
					select sum(zfy)as zfy,code,text,3 as flag
					from (
							( select sum(${yw_mzxx.indbName_value}) zfy,t2.code,t2.text from ${yw_mzxx.indbName_value} t1, 
								${yw_mzxx.dimExpenseType} t2 where 1 = 1 and t1.${yw_mzxx.dimExpenseType} = t2.code and t2.code in ('12','13','14')
								<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
									<if test='ringRatioStartDate != null'>and t1.${yw_mzxx.dimTime} >= #{ringRatioStartDate,jdbcType=VARCHAR}
									</if>
									<if test='ringRatioEndDate != null'>and t1.${yw_mzxx.dimTime} <![CDATA[ <= ]]> #{ringRatioEndDate,jdbcType=VARCHAR}
									</if>
									<if test="size != 0">
										and t1.${yw_mzxx.dimOrganization} in
										<foreach item="item" collection="jgidList" open="(" separator="," close=")">
											#{item.jgid,jdbcType=VARCHAR}
										</foreach>
									</if>
								</if>
								<if test=" aycx != null and aycx ==1 ">
									<if test='ringRatioMonth != null'>and t1.${yw_mzxx.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
									</if>
									<if test="size != 0">
										and t1.${yw_mzxx.dimOrganization} in
										<foreach item="item" collection="jgidList" open="(" separator="," close=")">
											#{item.jgid,jdbcType=VARCHAR}
										</foreach>
									</if>
								</if>
								group by t2.code,t2.text
							)
							union
							( select sum(${yw_zyxx.indbName_value}) zfy, t2.code, t2.text
								from ${yw_zyxx.indbName_value} t1, ${yw_zyxx.dimExpenseType} t2
								where 1 = 1 and t1.${yw_zyxx.dimExpenseType} = t2.code and t2.code in ('12','13','14')
								<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
									<if test='ringRatioStartDate != null'>and t1.${yw_zyxx.dimTime} >= #{ringRatioStartDate,jdbcType=VARCHAR}
									</if>
									<if test='ringRatioEndDate != null'>and t1.${yw_zyxx.dimTime} <![CDATA[ <= ]]> #{ringRatioEndDate,jdbcType=VARCHAR}
									</if>
									<if test="size != 0">
										and t1.${yw_zyxx.dimOrganization} in
										<foreach item="item" collection="jgidList" open="(" separator="," close=")">
											#{item.jgid,jdbcType=VARCHAR}
										</foreach>
									</if>
								</if>
								<if test=" aycx != null and aycx ==1 ">
									<if test='ringRatioMonth != null'>and t1.${yw_zyxx.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
									</if>
									<if test="size != 0">
										and t1.${yw_zyxx.dimOrganization} in
										<foreach item="item" collection="jgidList" open="(" separator="," close=")">
											#{item.jgid,jdbcType=VARCHAR}
										</foreach>
									</if>
								</if>
								group by t2.code,t2.text)
						) group by code,text
			</if>
			<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
				select ( select sum(${cw_mzxx.indbName_value}) from ${cw_mzxx.indbName_value} t1
						where 1 = 1
						<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
							<if test='startDate != null'> and t1.${cw_mzxx.dimTime} >= #{startDate,jdbcType=VARCHAR}</if>
							<if test='endDate != null'>and t1.${cw_mzxx.dimTime} <![CDATA[ <= ]]> #{endDate,jdbcType=VARCHAR}
							</if>
							<if test="size != 0">
								and t1.${cw_mzxx.dimOrganization} in
								<foreach item="item" collection="jgidList" open="(" separator="," close=")">
									#{item.jgid,jdbcType=VARCHAR}
								</foreach>
							</if>
						</if>
						<if test=" aycx != null and aycx ==1 ">
							<if test='yf != null'> and t1.${cw_mzxx.dimMonth} = #{yf,jdbcType=VARCHAR}</if>
							<if test="size != 0">
								and t1.${cw_mzxx.dimOrganization} in
								<foreach item="item" collection="jgidList" open="(" separator="," close=")">
									#{item.jgid,jdbcType=VARCHAR}
								</foreach>
							</if>
						</if>
					) + ( select sum(${cw_zyxx.indbName_value}) from ${cw_zyxx.indbName_value} t1
							where 1 = 1
							<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
								<if test='startDate != null'> and t1.${cw_zyxx.dimTime} >= #{startDate,jdbcType=VARCHAR}</if>
								<if test='endDate != null'>and t1.${cw_zyxx.dimTime} <![CDATA[ <= ]]> #{endDate,jdbcType=VARCHAR}
								</if>
								<if test="size != 0">
									and t1.${cw_zyxx.dimOrganization} in
									<foreach item="item" collection="jgidList" open="(" separator="," close=")">
										#{item.jgid,jdbcType=VARCHAR}
									</foreach>
								</if>
							</if>
							<if test=" aycx != null and aycx ==1 ">
								<if test='yf != null'> and t1.${cw_zyxx.dimMonth} = #{yf,jdbcType=VARCHAR}</if>
								<if test="size != 0">
									and t1.${cw_zyxx.dimOrganization} in
									<foreach item="item" collection="jgidList" open="(" separator="," close=")">
										#{item.jgid,jdbcType=VARCHAR}
									</foreach>
								</if>
							</if>
						) zfy from dual
				) as zfy4,
				( select ( select sum(${cw_mzxx.indbName_value}) from ${cw_mzxx.indbName_value} t1
							where 1 = 1
							<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
								<if test='yearOnYearStartDate != null'>and t1.${cw_mzxx.dimTime} >= #{yearOnYearStartDate,jdbcType=VARCHAR}
								</if>
								<if test='yearOnYearEndDate != null'>and t1.${cw_mzxx.dimTime} <![CDATA[ <= ]]> #{yearOnYearEndDate,jdbcType=VARCHAR}
								</if>
								<if test="size != 0">
									and t1.${cw_mzxx.dimOrganization} in
									<foreach item="item" collection="jgidList" open="(" separator="," close=")">
										#{item.jgid,jdbcType=VARCHAR}
									</foreach>
								</if>
							</if>
							<if test=" aycx != null and aycx ==1 ">
								<if test='yearOnYearMonth != null'> and t1.${cw_mzxx.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
								</if>
								<if test="size != 0">
									and t1.${cw_mzxx.dimOrganization} in
									<foreach item="item" collection="jgidList" open="(" separator="," close=")">
										#{item.jgid,jdbcType=VARCHAR}
									</foreach>
								</if>
							</if>
						) + ( select sum(${cw_zyxx.indbName_value})
								from ${cw_zyxx.indbName_value} t1
								where 1 = 1
								<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
									<if test='yearOnYearStartDate != null'>and t1.${cw_zyxx.dimTime} >= #{yearOnYearStartDate,jdbcType=VARCHAR}
									</if>
									<if test='yearOnYearEndDate != null'>and t1.${cw_zyxx.dimTime} <![CDATA[ <= ]]> #{yearOnYearEndDate,jdbcType=VARCHAR}
									</if>
									<if test="size != 0">
										and t1.${cw_zyxx.dimOrganization} in
										<foreach item="item" collection="jgidList" open="(" separator="," close=")">
											#{item.jgid,jdbcType=VARCHAR}
										</foreach>
									</if>
								</if>
								<if test=" aycx != null and aycx ==1 ">
									<if test='yearOnYearMonth != null'> and t1.${cw_zyxx.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
									</if>
									<if test="size != 0">
										and t1.${cw_zyxx.dimOrganization} in
										<foreach item="item" collection="jgidList" open="(" separator="," close=")">
											#{item.jgid,jdbcType=VARCHAR}
										</foreach>
									</if>
								</if>
							) zfy from dual
				) as zfy5,
				( select ( select sum(${cw_mzxx.indbName_value})
							from ${cw_mzxx.indbName_value} t1
							where 1 = 1
							<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
								<if test='ringRatioStartDate != null'>and t1.${cw_mzxx.dimTime} >= #{ringRatioStartDate,jdbcType=VARCHAR}
								</if>
								<if test='ringRatioEndDate != null'>and t1.${cw_mzxx.dimTime} <![CDATA[ <= ]]> #{ringRatioEndDate,jdbcType=VARCHAR}
								</if>
								<if test="size != 0">
									and t1.${cw_mzxx.dimOrganization} in
									<foreach item="item" collection="jgidList" open="(" separator="," close=")">
										#{item.jgid,jdbcType=VARCHAR}
									</foreach>
								</if>
							</if>
							<if test=" aycx != null and aycx ==1 ">
								<if test='ringRatioMonth != null'>and t1.${cw_mzxx.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
								</if>
								<if test="size != 0">
									and t1.${cw_mzxx.dimOrganization} in
									<foreach item="item" collection="jgidList" open="(" separator="," close=")">
										#{item.jgid,jdbcType=VARCHAR}
									</foreach>
								</if>
							</if>
						) + (
								select sum(${cw_zyxx.indbName_value}) from ${cw_zyxx.indbName_value} t1
								where 1 = 1
								<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
									<if test='ringRatioStartDate != null'>and t1.${cw_zyxx.dimTime} >= #{ringRatioStartDate,jdbcType=VARCHAR}
									</if>
									<if test='ringRatioEndDate != null'>and t1.${cw_zyxx.dimTime} <![CDATA[ <= ]]> #{ringRatioEndDate,jdbcType=VARCHAR}
									</if>
									<if test="size != 0">
										and t1.${cw_zyxx.dimOrganization} in
										<foreach item="item" collection="jgidList" open="(" separator="," close=")">
											#{item.jgid,jdbcType=VARCHAR}
										</foreach>
									</if>
								</if>
								<if test=" aycx != null and aycx ==1 ">
									<if test='ringRatioMonth != null'>and t1.${cw_zyxx.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
									</if>
									<if test="size != 0">
										and t1.${cw_zyxx.dimOrganization} in
										<foreach item="item" collection="jgidList" open="(" separator="," close=")">
											#{item.jgid,jdbcType=VARCHAR}
										</foreach>
									</if>
								</if>
							) zfy from dual
				) as zfy6,code,text from (
				--当前
				select sum(zfy) as zfy,code,text,1 as flag 
				from (
						( select sum(${cw_mzxx.indbName_value}) zfy,t2.code,t2.text from ${cw_mzxx.indbName_value} t1, 
							${cw_mzxx.dimExpenseType} t2
							where 1 = 1 and t1.${cw_mzxx.dimExpenseType} = t2.code and t2.code in ('12','13','14')
							<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
								<if test='startDate != null'> and t1.${cw_mzxx.dimTime} >= #{startDate,jdbcType=VARCHAR}</if>
								<if test='endDate != null'>and t1.${cw_mzxx.dimTime} <![CDATA[ <= ]]> #{endDate,jdbcType=VARCHAR}
								</if>
								<if test="size != 0">
									and t1.${cw_mzxx.dimOrganization} in
									<foreach item="item" collection="jgidList" open="(" separator="," close=")">
										#{item.jgid,jdbcType=VARCHAR}
									</foreach>
								</if>
							</if>
							<if test=" aycx != null and aycx ==1 ">
								<if test='yf != null'> and t1.${cw_mzxx.dimMonth} = #{yf,jdbcType=VARCHAR}</if>
								<if test="size != 0">
									and t1.${cw_mzxx.dimOrganization} in
									<foreach item="item" collection="jgidList" open="(" separator="," close=")">
										#{item.jgid,jdbcType=VARCHAR}
									</foreach>
								</if>
							</if>
						group by t2.code,t2.text)
						union
						( select sum(${cw_zyxx.indbName_value}) zfy,t2.code,t2.text from ${cw_zyxx.indbName_value} t1, ${cw_zyxx.dimExpenseType} t2
							where 1 = 1 and t1.${cw_zyxx.dimExpenseType} = t2.code and t2.code in ('12','13','14')
							<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
								<if test='startDate != null'> and t1.${cw_zyxx.dimTime} >= #{startDate,jdbcType=VARCHAR}</if>
								<if test='endDate != null'>and t1.${cw_zyxx.dimTime} <![CDATA[ <= ]]> #{endDate,jdbcType=VARCHAR}
								</if>
								<if test="size != 0">
									and t1.${cw_zyxx.dimOrganization} in
									<foreach item="item" collection="jgidList" open="(" separator="," close=")">
										#{item.jgid,jdbcType=VARCHAR}
									</foreach>
								</if>
								
							</if>
							<if test=" aycx != null and aycx ==1 ">
								<if test='yf != null'> and t1.${cw_zyxx.dimMonth} = #{yf,jdbcType=VARCHAR}</if>
								<if test="size != 0">
									and t1.${cw_zyxx.dimOrganization} in
									<foreach item="item" collection="jgidList" open="(" separator="," close=")">
										#{item.jgid,jdbcType=VARCHAR}
									</foreach>
								</if>
							</if>
							group by t2.code,t2.text )
					) group by code,text
					--同比
					union
					select sum(zfy) as zfy, code, text, 2 as flag
					from ( 
							( select sum(${cw_mzxx.indbName_value}) zfy, t2.code, t2.text
								from ${cw_mzxx.indbName_value} t1, ${cw_mzxx.dimExpenseType} t2
								where 1 = 1 and t1.${cw_mzxx.dimExpenseType} = t2.code and t2.code in ('12','13','14')
								<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
									<if test='yearOnYearStartDate != null'>and t1.${cw_mzxx.dimTime} >= #{yearOnYearStartDate,jdbcType=VARCHAR}
									</if>
									<if test='yearOnYearEndDate != null'>and t1.${cw_mzxx.dimTime} <![CDATA[ <= ]]> #{yearOnYearEndDate,jdbcType=VARCHAR}
									</if>
									<if test="size != 0">
										and t1.${cw_mzxx.dimOrganization} in
										<foreach item="item" collection="jgidList" open="(" separator="," close=")">
											#{item.jgid,jdbcType=VARCHAR}
										</foreach>
									</if>
								</if>
								<if test=" aycx != null and aycx ==1 ">
									<if test='yearOnYearMonth != null'> and t1.${cw_mzxx.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
									</if>
									<if test="size != 0">
										and t1.${cw_mzxx.dimOrganization} in
										<foreach item="item" collection="jgidList" open="(" separator="," close=")">
											#{item.jgid,jdbcType=VARCHAR}
										</foreach>
									</if>
								</if>
								group by t2.code, t2.text) 
								union
								( select sum(${cw_zyxx.indbName_value}) zfy, t2.code, t2.text
								from ${cw_zyxx.indbName_value} t1, ${cw_zyxx.dimExpenseType} t2
								where 1 = 1 and t1.${cw_zyxx.dimExpenseType} = t2.code and t2.code in ('12','13','14')
								<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
									<if test='yearOnYearStartDate != null'>and t1.${cw_zyxx.dimTime} >= #{yearOnYearStartDate,jdbcType=VARCHAR}
									</if>
									<if test='yearOnYearEndDate != null'>and t1.${cw_zyxx.dimTime} <![CDATA[ <= ]]> #{yearOnYearEndDate,jdbcType=VARCHAR}
									</if>
									<if test="size != 0">
										and t1.${cw_zyxx.dimOrganization} in
										<foreach item="item" collection="jgidList" open="(" separator="," close=")">
											#{item.jgid,jdbcType=VARCHAR}
										</foreach>
									</if>
								</if>
								<if test=" aycx != null and aycx ==1 ">
									<if test='yearOnYearMonth != null'> and t1.${cw_zyxx.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
									</if>
									<if test="size != 0">
										and t1.${cw_zyxx.dimOrganization} in
										<foreach item="item" collection="jgidList" open="(" separator="," close=")">
											#{item.jgid,jdbcType=VARCHAR}
										</foreach>
									</if>
								</if>
								group by t2.code, t2.text)
						) group by code, text
						--环比
						union
						select sum(zfy)as zfy,code,text,3 as flag 
						from (
								( select sum(${cw_mzxx.indbName_value}) zfy,t2.code,t2.text from ${cw_mzxx.indbName_value} t1, ${cw_mzxx.dimExpenseType} t2
										where 1 = 1 and t1.${cw_mzxx.dimExpenseType} = t2.code and t2.code in ('12','13','14')
										<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
											<if test='ringRatioStartDate != null'>and t1.${cw_mzxx.dimTime} >= #{ringRatioStartDate,jdbcType=VARCHAR}
											</if>
											<if test='ringRatioEndDate != null'>and t1.${cw_mzxx.dimTime} <![CDATA[ <= ]]> #{ringRatioEndDate,jdbcType=VARCHAR}
											</if>
											<if test="size != 0">
												and t1.${cw_mzxx.dimOrganization} in
												<foreach item="item" collection="jgidList" open="(" separator="," close=")">
													#{item.jgid,jdbcType=VARCHAR}
												</foreach>
											</if>
										</if>
										<if test=" aycx != null and aycx ==1 ">
											<if test='ringRatioMonth != null'>and t1.${cw_mzxx.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
											</if>
											<if test="size != 0">
												and t1.${cw_mzxx.dimOrganization} in
												<foreach item="item" collection="jgidList" open="(" separator="," close=")">
													#{item.jgid,jdbcType=VARCHAR}
												</foreach>
											</if>
										</if>
										group by t2.code,t2.text)
									union
									( select sum(${cw_zyxx.indbName_value}) zfy, t2.code, t2.text from ${cw_zyxx.indbName_value} t1, ${cw_zyxx.dimExpenseType} t2
										where 1 = 1 and t1.${cw_zyxx.dimExpenseType} = t2.code and t2.code in ('12','13','14')
										<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
											<if test='ringRatioStartDate != null'>and t1.${cw_zyxx.dimTime} >= #{ringRatioStartDate,jdbcType=VARCHAR}
											</if>
											<if test='ringRatioEndDate != null'>and t1.${cw_zyxx.dimTime} <![CDATA[ <= ]]> #{ringRatioEndDate,jdbcType=VARCHAR}
											</if>
											<if test="size != 0">
												and t1.${cw_zyxx.dimOrganization} in
												<foreach item="item" collection="jgidList" open="(" separator="," close=")">
													#{item.jgid,jdbcType=VARCHAR}
												</foreach>
											</if>
										</if>
										<if test=" aycx != null and aycx ==1 ">
											<if test='ringRatioMonth != null'>and t1.${cw_zyxx.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
											</if>
											<if test="size != 0">
												and t1.${cw_zyxx.dimOrganization} in
												<foreach item="item" collection="jgidList" open="(" separator="," close=")">
													#{item.jgid,jdbcType=VARCHAR}
												</foreach>
											</if>
										</if>
										group by t2.code,t2.text)
								) group by code,text
			</if>
			)group by flag, code,text
			)group by zfy4,zfy5,zfy6
		</if>
	</select>
	
	
	<select id="getDrugOccupationRatio" resultType="hashmap"
		parameterType="hashmap">
		select code,text,
		case when zfy4 <![CDATA[ <> ]]>
		0 then round(sum(zfy)/zfy4,4) else 0 end as zb,
		case when zfy5 <![CDATA[ <> ]]>
		0 then round(sum(zfy2) / zfy5 , 4) else 0 end as
		yearOnYear,
		case when
		zfy6 <![CDATA[ <> ]]>
		0 then round(sum(zfy3) / zfy6 , 4) else 0 end as
		ringRatio
		from (select
		case when flag = 1 then sum(zfy) else 0 end zfy,
		case when flag = 2
		then sum(zfy) else 0 end zfy2,
		case when flag = 3 then sum(zfy) else 0
		end zfy3,
		(
		<if test="  CWorYW !='CW' ">
			select (select sum(${yw_mzxx.indbName_value})
			from ${yw_mzxx.indbName_value} t1
			where 1 = 1
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			) + (
			select sum(${yw_zyxx.indbName_value})
			from ${yw_zyxx.indbName_value} t1
			where 1 = 1
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
<!-- 				<include refid="sql_now_where" /> -->
				<include refid="sql_now_where_yw_zyxx" />
				
			</if>
			<if test=" aycx != null and aycx ==1 ">
<!-- 				<include refid="sql_nowMonth_where" /> -->
				<include refid="sql_nowMonth_where_yw_zyxx" />
				
			</if>
			)
			zfy from dual) as zfy4,
			(select (select sum(${yw_mzxx.indbName_value})
			from
			${yw_mzxx.indbName_value} t1
			where 1 = 1
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			) + (
			select sum(${yw_zyxx.indbName_value})
			from ${yw_zyxx.indbName_value} t1
			where 1 = 1
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where_yw_zyxx" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where_yw_zyxx" />
			</if>
			)
			zfy from dual) as zfy5,
			(select (select sum(${yw_mzxx.indbName_value})
			from
			${yw_mzxx.indbName_value} t1
			where 1 = 1
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			) + (
			select sum(${yw_zyxx.indbName_value})
			from ${yw_zyxx.indbName_value} t1
			where 1 = 1
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where_yw_zyxx" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where_yw_zyxx" />
			</if>
			)
			zfy from dual) as zfy6,code,text
			from (
			--当前
			select sum(zfy) as
			zfy,code,text,1 as flag from (
			(select sum(${yw_mzxx.indbName_value})
			zfy,t2.code,t2.text from ${yw_mzxx.indbName_value} t1, 
			${yw_mzxx.dimExpenseType}
			t2
			where 1 = 1 and
			t1.${yw_mzxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			group by t2.code,t2.text)
			union
			(select sum(${yw_zyxx.indbName_value})
			zfy,t2.code,t2.text from ${yw_zyxx.indbName_value} t1, 
			${yw_zyxx.dimExpenseType}
			t2
			where 1 = 1 and
			t1.${yw_zyxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where_yw_zyxx" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where_yw_zyxx" />
			</if>
			group by t2.code,t2.text )
			) group by code,text
			--同比
			union
			select
			sum(zfy) as zfy, code, text, 2 as flag
			from ((select sum(${yw_mzxx.indbName_value})
			zfy, t2.code, t2.text
			from ${yw_mzxx.indbName_value} t1, ${yw_mzxx.dimExpenseType} t2
			where 1 = 1
			and
			t1.${yw_mzxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			group by t2.code, t2.text) union
			(select sum(${yw_zyxx.indbName_value}) zfy, t2.code,
			t2.text
			from ${yw_zyxx.indbName_value} t1, ${yw_zyxx.dimExpenseType} t2
			where 1 = 1
			and t1.${yw_zyxx.dimExpenseType}
			= t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where_yw_zyxx" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where_yw_zyxx" />
			</if>
			group by t2.code, t2.text))
			group by code, text
			--环比
			union
			select
			sum(zfy)as zfy,code,text,3 as flag from (
			(select sum(${yw_mzxx.indbName_value})
			zfy,t2.code,t2.text from ${yw_mzxx.indbName_value} t1, ${yw_mzxx.dimExpenseType}
			t2
			where 1 = 1 and
			t1.${yw_mzxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			group by t2.code,t2.text)
			union
			(select sum(${yw_zyxx.indbName_value}) zfy, t2.code,
			t2.text
			from ${yw_zyxx.indbName_value} t1, ${yw_zyxx.dimExpenseType} t2
			where 1 = 1
			and t1.${yw_zyxx.dimExpenseType}
			= t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where_yw_zyxx" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where_yw_zyxx" />
			</if>
			group by t2.code,t2.text)
		</if>
		<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
			select (select sum(${cw_mzxx.indbName_value})
			from ${cw_mzxx.indbName_value} t1
			where 1 = 1
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			) + (
			select sum(${cw_zyxx.indbName_value})
			from ${cw_zyxx.indbName_value} t1
			where 1 = 1
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where_cw_zyxx" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where_cw_zyxx" />
			</if>
			)
			zfy from dual) as zfy4,
			(select (select sum(${cw_mzxx.indbName_value})
			from
			${cw_mzxx.indbName_value} t1
			where 1 = 1
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			) + (
			select sum(${cw_zyxx.indbName_value})
			from ${cw_zyxx.indbName_value} t1
			where 1 = 1
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where_cw_zyxx" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where_cw_zyxx" />
			</if>
			)
			zfy from dual) as zfy5,
			(select (select sum(${cw_mzxx.indbName_value})
			from
			${cw_mzxx.indbName_value} t1
			where 1 = 1
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			) + (
			select sum(${cw_zyxx.indbName_value})
			from ${cw_zyxx.indbName_value} t1
			where 1 = 1
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where_cw_zyxx" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where_cw_zyxx" />
			</if>
			)
			zfy from dual) as zfy6,code,text
			from (
			--当前
			select sum(zfy) as
			zfy,code,text,1 as flag from (
			(select sum(${cw_mzxx.indbName_value})
			zfy,t2.code,t2.text from ${cw_mzxx.indbName_value} t1, 
			${cw_mzxx.dimExpenseType}
			t2
			where 1 = 1 and
			t1.${cw_mzxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			group by t2.code,t2.text)
			union
			(select sum(${cw_zyxx.indbName_value})
			zfy,t2.code,t2.text from ${cw_zyxx.indbName_value} t1, 
			${cw_zyxx.dimExpenseType}
			t2
			where 1 = 1 and
			t1.${cw_zyxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where_cw_zyxx" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where_cw_zyxx" />
			</if>
			group by t2.code,t2.text )
			) group by code,text
			--同比
			union
			select
			sum(zfy) as zfy, code, text, 2 as flag
			from ((select sum(${cw_mzxx.indbName_value})
			zfy, t2.code, t2.text
			from ${cw_mzxx.indbName_value} t1, ${cw_mzxx.dimExpenseType} t2
			where 1 = 1
			and
			t1.${cw_mzxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			group by t2.code, t2.text) union
			(select sum(${cw_zyxx.indbName_value}) zfy, t2.code,
			t2.text
			from ${cw_zyxx.indbName_value} t1, ${cw_zyxx.dimExpenseType} t2
			where 1 = 1
			and t1.${cw_zyxx.dimExpenseType}
			= t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where_cw_zyxx" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where_cw_zyxx" />
			</if>
			group by t2.code, t2.text))
			group by code, text
			--环比
			union
			select
			sum(zfy)as zfy,code,text,3 as flag from (
			(select sum(${cw_mzxx.indbName_value})
			zfy,t2.code,t2.text from ${cw_mzxx.indbName_value} t1, 
			${cw_mzxx.dimExpenseType}
			t2
			where 1 = 1 and
			t1.${cw_mzxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			group by t2.code,t2.text)
			union
			(select sum(${cw_zyxx.indbName_value}) zfy, t2.code,
			t2.text
			from ${cw_zyxx.indbName_value} t1, ${cw_zyxx.dimExpenseType} t2
			where 1 = 1
			and t1.${cw_zyxx.dimExpenseType}
			= t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where_cw_zyxx" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where_cw_zyxx" />
			</if>
			group by t2.code,t2.text)
		</if>
		) group by code,text
		)group by flag, code,text)group by
		code,text,zfy4,zfy5,zfy6
		<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
			order by text
		</if>
		<if test="  CWorYW !='CW' ">
			order by code
		</if>

	</select>
	
	<!-- 材料费占比 -->
	<select id="getCountMaterialOccupationRatio" resultType="hashmap" parameterType="hashmap">
		select text, zb,
		case when yearOnYear  <![CDATA[ <> ]]> 0 then round((zb - yearOnYear) / yearOnYear, 4) else 0 end as yearOnYear,
		case when ringRatio  <![CDATA[ <> ]]> 0 then round((zb - ringRatio) / ringRatio, 4) else 0 end as ringRatio
		from
		(select '材料占比' as text,
		case when sum(zfy4) = 0 then 0 else round(sum(zfy) / sum(zfy4), 4) end as zb,
		case when sum(zfy5)  <![CDATA[ <> ]]> 0 then round(sum(zfy2) / sum(zfy5), 4) else 0 end as yearOnYear,
		case when sum(zfy6)  <![CDATA[ <> ]]> 0 then round(sum(zfy3) / sum(zfy6), 4) else 0 end as ringRatio
		from (select case when flag = 1 then
		sum(zfy) else 0 end zfy,
		case when flag = 2 then sum(zfy) else 0 end zfy2,
		case when flag = 3 then sum(zfy) else 0 end zfy3,
		case when flag = 4 then sum(zfy) else 0 end zfy4,
		case when flag = 5 then sum(zfy) else 0 end zfy5,
		case when flag = 6 then sum(zfy) else 0 end zfy6
		from
		(select (select sum(${mz_clsr.indbName_value}) zfy
		from ${mz_clsr.indbName_value} t1
		where 1 = 1
		<if test='yf != null'> and t1.${mz_clsr.dimMonth} = #{yf,jdbcType=VARCHAR}</if>
		<if test="size != 0">
			and t1.${mz_clsr.dimOrganization} in
			<foreach item="item" collection="jgidList" open="(" separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		) +
		(select sum(${zy_clsr.indbName_value}) zfy from ${zy_clsr.indbName_value} t1
		where 1 = 1
			<if test='yf != null'> and t1.${zy_clsr.dimMonth} = #{yf,jdbcType=VARCHAR}</if>
			<if test="size != 0">
				and t1.${zy_clsr.dimOrganization} in
				<foreach item="item" collection="jgidList" open="(" separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
		) as zfy, 1 as flag from dual
		union
		select (select sum(${mz_clsr.indbName_value}) zfy from ${mz_clsr.indbName_value} t1
		where 1 = 1
		<if test='yearOnYearMonth != null'> and t1.${mz_clsr.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${mz_clsr.dimOrganization} in
			<foreach item="item" collection="jgidList" open="(" separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		) +
		(select sum(${zy_clsr.indbName_value}) zfy
		from ${zy_clsr.indbName_value} t1
		where 1 = 1
		<if test='yearOnYearMonth != null'> and t1.${zy_clsr.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${zy_clsr.dimOrganization} in
			<foreach item="item" collection="jgidList" open="(" separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		) as zfy, 2 as flag from dual
		union
		select (select sum(${mz_clsr.indbName_value}) zfy
		from ${mz_clsr.indbName_value} t1
		where 1 = 1
		<if test='ringRatioMonth != null'>and t1.${mz_clsr.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${mz_clsr.dimOrganization} in
			<foreach item="item" collection="jgidList" open="(" separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		) +
		(select sum(${zy_clsr.indbName_value}) zfy
		from ${zy_clsr.indbName_value} t1
		where 1 = 1
		<if test='ringRatioMonth != null'>and t1.${zy_clsr.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${zy_clsr.dimOrganization} in
			<foreach item="item" collection="jgidList" open="(" separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		) as zfy, 3 as flag from dual
		union
		select (select sum(${yw_mzxx.indbName_value}) from ${yw_mzxx.indbName_value} t1, ${yw_mzxx.dimExpenseType} t2
		where 1 = 1 and t1.${yw_mzxx.dimExpenseType} = t2.code
		<if test='yf != null'> and t1.${yw_mzxx.dimMonth} = #{yf,jdbcType=VARCHAR}</if>
		<if test="size != 0">
			and t1.${yw_mzxx.dimOrganization} in
			<foreach item="item" collection="jgidList" open="(" separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		) +
		(select sum(${yw_zyxx.indbName_value}) from ${yw_zyxx.indbName_value} t1, ${yw_zyxx.dimExpenseType} t2
		where 1 = 1 and t1.${yw_zyxx.dimExpenseType} = t2.code
			<if test='yf != null'> and t1.${yw_zyxx.dimMonth} = #{yf,jdbcType=VARCHAR}</if>
		<if test="size != 0">
			and t1.${yw_zyxx.dimOrganization} in
			<foreach item="item" collection="jgidList" open="(" separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		) zfy, 4 as flag from dual
		union
		select - (select sum(${mz_ypsr.indbName_value})
		from
		${mz_ypsr.indbName_value} t1, ${mz_ypsr.dimChargeType} t2
		where  t1.${mz_ypsr.dimChargeType} = t2.code and t2.code like '1000010%'
		<if test='yf != null'> and t1.${mz_ypsr.dimMonth} = #{yf,jdbcType=VARCHAR}</if>
		<if test="size != 0">
			and t1.${mz_ypsr.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		) +
		(select sum(${zy_ypsr.indbName_value})
		from ${zy_ypsr.indbName_value} t1, ${zy_ypsr.dimChargeType} t2
		where 1 = 1
		and t1.${zy_ypsr.dimChargeType} = t2.code
		and t2.code like '1000010%'
		<if test='yf != null'> and t1.${zy_ypsr.dimMonth} = #{yf,jdbcType=VARCHAR}</if>
		<if test="size != 0">
			and t1.${zy_ypsr.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		) zfy, 4 as flag from dual
		union
		select (select sum(${yw_mzxx.indbName_value})
		from ${yw_mzxx.indbName_value} t1, ${yw_mzxx.dimExpenseType} t2
		where  t1.${yw_mzxx.dimExpenseType} = t2.code
		<if test='yearOnYearMonth != null'> and t1.${yw_mzxx.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${yw_mzxx.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		) +
		(select sum(${yw_zyxx.indbName_value})
		from ${yw_zyxx.indbName_value} t1, ${yw_zyxx.dimExpenseType} t2
		where 1 = 1 and t1.${yw_zyxx.dimExpenseType} = t2.code
		<if test='yearOnYearMonth != null'> and t1.${yw_zyxx.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${yw_zyxx.dimOrganization} in
			<foreach item="item" collection="jgidList" open="(" separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		) zfy, 5 as flag from dual
		union
		select - (select sum(${mz_ypsr.indbName_value})
		from ${mz_ypsr.indbName_value} t1, ${mz_ypsr.dimChargeType} t2
		where 1 = 1 and t1.${mz_ypsr.dimChargeType} = t2.code
		and t2.code like '1000010%'
		<if test='yearOnYearMonth != null'> and t1.${mz_ypsr.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${mz_ypsr.dimOrganization} in
			<foreach item="item" collection="jgidList" open="(" separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		) +
		(select sum(${zy_ypsr.indbName_value})
		from ${zy_ypsr.indbName_value} t1, ${zy_ypsr.dimChargeType} t2
		where 1 = 1 and t1.${zy_ypsr.dimChargeType} = t2.code and t2.code like '1000010%'
		<if test='yearOnYearMonth != null'> and t1.${zy_ypsr.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${zy_ypsr.dimOrganization} in
			<foreach item="item" collection="jgidList" open="(" separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		) zfy, 5 as flag from dual
		union
		select (select sum(${yw_mzxx.indbName_value})
		from ${yw_mzxx.indbName_value} t1, ${yw_mzxx.dimExpenseType} t2
		where 1 = 1 and t1.${yw_mzxx.dimExpenseType} = t2.code
		<if test='ringRatioMonth != null'>and t1.${yw_mzxx.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${yw_mzxx.dimOrganization} in
			<foreach item="item" collection="jgidList" open="(" separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		) +
		(select sum(${yw_zyxx.indbName_value})
		from ${yw_zyxx.indbName_value} t1, ${yw_zyxx.dimExpenseType} t2
		where 1 = 1 and t1.${yw_zyxx.dimExpenseType} = t2.code
		<if test='ringRatioMonth != null'>and t1.${yw_zyxx.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${yw_zyxx.dimOrganization} in
			<foreach item="item" collection="jgidList" open="(" separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		) zfy, 6 as flag from dual
		union
		select - (select sum(${mz_ypsr.indbName_value})
		from
		${mz_ypsr.indbName_value} t1, ${mz_ypsr.dimChargeType} t2
		where  t1.${mz_ypsr.dimChargeType} = t2.code and t2.code like '1000010%'
		<if test='ringRatioMonth != null'>and t1.${mz_ypsr.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${mz_ypsr.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		) +
		(select sum(${zy_ypsr.indbName_value})
		from ${zy_ypsr.indbName_value} t1, ${zy_ypsr.dimChargeType} t2
		where  t1.${zy_ypsr.dimChargeType} = t2.code and t2.code like '1000010%'
		<if test='ringRatioMonth != null'>and t1.${zy_ypsr.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
		</if>
		<if test="size != 0">
			and t1.${zy_ypsr.dimOrganization} in
			<foreach item="item" collection="jgidList" open="(" separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		) zfy, 6 as flag from dual
		)
		group by flag))
	</select>
	
	<!-- 查询统计-均次费用 -->
	<select id="getAverageCost" resultType="hashmap" parameterType="hashmap">
		select '${text}' as text,round(sum(zfy),4) as jcfy,
		case when sum(zfy2) <![CDATA[ <> ]]>0 then round((sum(zfy) - sum(zfy2)) / sum(zfy2), 4) else 0 end as yearOnYear,
		case when sum(zfy3) <![CDATA[ <> ]]>0 then round((sum(zfy) - sum(zfy3)) / sum(zfy3), 4) else 0 end as ringRatio
		from (
		select
		case when flag = 1 then sum(zfy) else 0 end zfy,
		case when flag = 2 then sum(zfy) else 0 end zfy2,
		case when flag = 3
		then sum(zfy) else 0 end zfy3
		from (
		<choose>
	        <when test="CWorYW=='CW'">
	        	select ( --当前门诊、住院、手术费用
			select
			<choose>
		        <when test="MzorZyorSs=='MZ'">
		        	sum(${cw_mzxx.indbName_value})
					from ${cw_mzxx.indbName_value} t1
		        </when>
		        <when test="MzorZyorSs=='ZY'">
		       		 sum(${cw_zyxx.indbName_value})
					from ${cw_zyxx.indbName_value} t1
		        </when>
		        <when test="MzorZyorSs=='SS'">
		        	sum(${cw_ssfy.indbName_value})
					from ${cw_ssfy.indbName_value} t1
		        </when>
		    </choose>
			where 1 = 1
			<choose>
				<when
					test=' (whereType != null and whereType =="QueryByMonth") or (aycx != null and aycx ==1)'>
					<include refid="sql_nowMonth_where2_FY" />
				</when>
				<when
					test=' whereType != null and whereType =="QueryByTime" and (aycx == null or (aycx != null and aycx !=1 ))'>
					<include refid="sql_now_where2_FY" />
				</when>
			</choose>
		) / (--当前门诊、住院、手术人次
		<choose>
		        <when test="MzorZyorSs=='MZ'">
					select sum(${mz_jzrc.indbName_value})
					from ${mz_jzrc.indbName_value} t1
		        </when>
		        <when test="MzorZyorSs=='ZY'">
		       		 select sum(${zy_jzrc.indbName_value})
					from ${zy_jzrc.indbName_value} t1
		        </when>
		        <when test="MzorZyorSs=='SS'">
		        	select sum(${ss_jzrc.indbName_value})
					from ${ss_jzrc.indbName_value} t1
		        </when>
		    </choose>
		where 1 = 1
		<choose>
			<when
				test='(whereType != null and whereType =="QueryByMonth") or (aycx != null and aycx ==1)'>
				<include refid="sql_nowMonth_where2_RC" />
			</when>
			<when
				test='whereType != null and whereType =="QueryByTime" and (aycx == null or (aycx != null and aycx !=1 ))'>
				<include refid="sql_now_where2_RC" />
			</when>
		</choose>
		) as zfy,
		1 as flag
		from dual
		--同比
		union
		<choose>
		        <when test="MzorZyorSs=='MZ'">
					select (select sum(${cw_mzxx.indbName_value})
					zfy
					from ${cw_mzxx.indbName_value} t1
		        </when>
		        <when test="MzorZyorSs=='ZY'">
		       		select (select sum(${cw_zyxx.indbName_value})
					zfy
					from ${cw_zyxx.indbName_value} t1
		        </when>
		        <when test="MzorZyorSs=='SS'">
		        	select (select sum(${cw_ssfy.indbName_value})
					zfy
					from ${cw_ssfy.indbName_value} t1
		        </when>
		    </choose>
		where 1 = 1
		<choose>
			<when
				test='(whereType != null and whereType =="QueryByMonth") or (aycx != null and aycx ==1)'>
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</when>
			<when
				test='whereType != null and whereType =="QueryByTime" and (aycx == null or (aycx != null and aycx !=1 ))'>
				<include refid="sql_yearOnYear_where2_FY" />
			</when>
		</choose>
		) / ( --同比门诊、住院、手术人次
		<choose>
		        <when test="MzorZyorSs=='MZ'">
					select sum(${mz_jzrc.indbName_value})
					from ${mz_jzrc.indbName_value} t1
		        </when>
		        <when test="MzorZyorSs=='ZY'">
					select sum(${zy_jzrc.indbName_value})
					from ${zy_jzrc.indbName_value} t1
		        </when>
		        <when test="MzorZyorSs=='SS'">
					select sum(${ss_jzrc.indbName_value})
					from ${ss_jzrc.indbName_value} t1
		        </when>
		    </choose>
		where 1 = 1
		<choose>
			<when
				test='(whereType != null and whereType =="QueryByMonth") or (aycx != null and aycx ==1)'>
				<include refid="sql_yearOnYearMonth_where2_RC" />
			</when>
			<when
				test='whereType != null and whereType =="QueryByTime" and (aycx == null or (aycx != null and aycx !=1 ))'>
				<include refid="sql_yearOnYear_where2_RC" />
			</when>
		</choose>
		) as zfy,
		2 as flag
		from dual
		--环比
		union
		<choose>
		        <when test="MzorZyorSs=='MZ'">
		        select (select sum(${cw_mzxx.indbName_value})
				zfy
				from ${cw_mzxx.indbName_value} t1
		        </when>
		        <when test="MzorZyorSs=='ZY'">
		         select (select sum(${cw_zyxx.indbName_value})
				 zfy
				 from ${cw_zyxx.indbName_value} t1
		        </when>
		        <when test="MzorZyorSs=='SS'">
		         select (select sum(${cw_ssfy.indbName_value})
				 zfy
				 from ${cw_ssfy.indbName_value} t1
		        </when>
		    </choose>
		where 1 = 1
		<choose>
			<when
				test='(whereType != null and whereType =="QueryByMonth") or (aycx != null and aycx ==1)'>
				<include refid="sql_ringRatioMonth_where2_FY" />
			</when>
			<when
				test='whereType != null and whereType =="QueryByTime" and (aycx == null or (aycx != null and aycx !=1 ))'>
				<include refid="sql_ringRatio_where2_FY" />
			</when>
		</choose>
		) / ( --环比门诊、住院、手术人次
		<choose>
		        <when test="MzorZyorSs=='MZ'">
		        select sum(${mz_jzrc.indbName_value})
				from ${mz_jzrc.indbName_value} t1
		        </when>
		        <when test="MzorZyorSs=='ZY'">
		         select sum(${zy_jzrc.indbName_value})
				from ${zy_jzrc.indbName_value} t1
		        </when>
		        <when test="MzorZyorSs=='SS'">
		         select sum(${ss_jzrc.indbName_value})
				from ${ss_jzrc.indbName_value} t1
		        </when>
		    </choose>
		where 1 = 1
		<choose>
			<when
				test='(whereType != null and whereType =="QueryByMonth") or (aycx != null and aycx ==1)'>
				<include refid="sql_ringRatioMonth_where2_RC" />
			</when>
			<when
				test='whereType != null and whereType =="QueryByTime" and (aycx == null or (aycx != null and aycx !=1 ))'>
				<include refid="sql_ringRatio_where2_RC" />
			</when>
		</choose>
		) as zfy, 3 as flag from dual
	        </when>
	        <when test="CWorYW=='YW'">
	        	select ( --当前门诊、住院、手术费用
			select
			<choose>
		        <when test="MzorZyorSs=='MZ'">
		        	sum(${yw_mzxx.indbName_value})
					from ${yw_mzxx.indbName_value} t1
		        </when>
		        <when test="MzorZyorSs=='ZY'">
		       		 sum(${yw_zyxx.indbName_value})
					from ${yw_zyxx.indbName_value} t1
		        </when>
		        <when test="MzorZyorSs=='SS'">
		        	sum(${yw_ssfy.indbName_value})
					from ${yw_ssfy.indbName_value} t1
		        </when>
		    </choose>
			where 1 = 1
			<choose>
				<when
					test=' (whereType != null and whereType =="QueryByMonth") or (aycx != null and aycx ==1)'>
					<include refid="sql_nowMonth_where2_FY" />
				</when>
				<when
					test=' whereType != null and whereType =="QueryByTime" and (aycx == null or (aycx != null and aycx !=1 ))'>
					<include refid="sql_now_where2_FY" />
				</when>
			</choose>
		) / (--当前门诊、住院、手术人次
		<choose>
		        <when test="MzorZyorSs=='MZ'">
					select sum(${mz_jzrc.indbName_value})
					from ${mz_jzrc.indbName_value} t1
		        </when>
		        <when test="MzorZyorSs=='ZY'">
		       		 select sum(${zy_jzrc.indbName_value})
					from ${zy_jzrc.indbName_value} t1
		        </when>
		        <when test="MzorZyorSs=='SS'">
		        	select sum(${ss_jzrc.indbName_value})
					from ${ss_jzrc.indbName_value} t1
		        </when>
		    </choose>
		where 1 = 1
		<choose>
			<when
				test='(whereType != null and whereType =="QueryByMonth") or (aycx != null and aycx ==1)'>
				<include refid="sql_nowMonth_where2_RC" />
			</when>
			<when
				test='whereType != null and whereType =="QueryByTime" and (aycx == null or (aycx != null and aycx !=1 ))'>
				<include refid="sql_now_where2_RC" />
			</when>
		</choose>
		) as zfy,
		1 as flag
		from dual
		--同比
		union
		<choose>
		        <when test="MzorZyorSs=='MZ'">
					select (select sum(${yw_mzxx.indbName_value})
					zfy
					from ${yw_mzxx.indbName_value} t1
		        </when>
		        <when test="MzorZyorSs=='ZY'">
		       		select (select sum(${yw_zyxx.indbName_value})
					zfy
					from ${yw_zyxx.indbName_value} t1
		        </when>
		        <when test="MzorZyorSs=='SS'">
		        	select (select sum(${yw_ssfy.indbName_value})
					zfy
					from ${yw_ssfy.indbName_value} t1
		        </when>
		    </choose>
		where 1 = 1
		<choose>
			<when
				test='(whereType != null and whereType =="QueryByMonth") or (aycx != null and aycx ==1)'>
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</when>
			<when
				test='whereType != null and whereType =="QueryByTime" and (aycx == null or (aycx != null and aycx !=1 ))'>
				<include refid="sql_yearOnYear_where2_FY" />
			</when>
		</choose>
		) / ( --同比门诊、住院、手术人次
		<choose>
		        <when test="MzorZyorSs=='MZ'">
					select sum(${mz_jzrc.indbName_value})
					from ${mz_jzrc.indbName_value} t1
		        </when>
		        <when test="MzorZyorSs=='ZY'">
					select sum(${zy_jzrc.indbName_value})
					from ${zy_jzrc.indbName_value} t1
		        </when>
		        <when test="MzorZyorSs=='SS'">
					select sum(${ss_jzrc.indbName_value})
					from ${ss_jzrc.indbName_value} t1
		        </when>
		    </choose>
		where 1 = 1
		<choose>
			<when
				test='(whereType != null and whereType =="QueryByMonth") or (aycx != null and aycx ==1)'>
				<include refid="sql_yearOnYearMonth_where2_RC" />
			</when>
			<when
				test='whereType != null and whereType =="QueryByTime" and (aycx == null or (aycx != null and aycx !=1 ))'>
				<include refid="sql_yearOnYear_where2_RC" />
			</when>
		</choose>
		) as zfy,
		2 as flag
		from dual
		--环比
		union
		<choose>
		        <when test="MzorZyorSs=='MZ'">
		        select (select sum(${yw_mzxx.indbName_value})
				zfy
				from ${yw_mzxx.indbName_value} t1
		        </when>
		        <when test="MzorZyorSs=='ZY'">
		         select (select sum(${yw_zyxx.indbName_value})
				 zfy
				 from ${yw_zyxx.indbName_value} t1
		        </when>
		        <when test="MzorZyorSs=='SS'">
		         select (select sum(${yw_ssfy.indbName_value})
				 zfy
				 from ${yw_ssfy.indbName_value} t1
		        </when>
		    </choose>
		where 1 = 1
		<choose>
			<when
				test='(whereType != null and whereType =="QueryByMonth") or (aycx != null and aycx ==1)'>
				<include refid="sql_ringRatioMonth_where2_FY" />
			</when>
			<when
				test='whereType != null and whereType =="QueryByTime" and (aycx == null or (aycx != null and aycx !=1 ))'>
				<include refid="sql_ringRatio_where2_FY" />
			</when>
		</choose>
		) / ( --环比门诊、住院、手术人次
		<choose>
		        <when test="MzorZyorSs=='MZ'">
		        select sum(${mz_jzrc.indbName_value})
				from ${mz_jzrc.indbName_value} t1
		        </when>
		        <when test="MzorZyorSs=='ZY'">
		         select sum(${zy_jzrc.indbName_value})
				from ${zy_jzrc.indbName_value} t1
		        </when>
		        <when test="MzorZyorSs=='SS'">
		         select sum(${ss_jzrc.indbName_value})
				from ${ss_jzrc.indbName_value} t1
		        </when>
		    </choose>
		where 1 = 1
		<choose>
			<when
				test='(whereType != null and whereType =="QueryByMonth") or (aycx != null and aycx ==1)'>
				<include refid="sql_ringRatioMonth_where2_RC" />
			</when>
			<when
				test='whereType != null and whereType =="QueryByTime" and (aycx == null or (aycx != null and aycx !=1 ))'>
				<include refid="sql_ringRatio_where2_RC" />
			</when>
		</choose>
		) as zfy, 3 as flag from dual
	        </when>
	  </choose>
		)group by flag)
	</select>
	
	<!-- 统计查询  门诊均次 下钻到科室 -->
	<select id="getAverageCostByDeptAndMz" resultType="hashmap" parameterType="hashmap">
		select code,
		text,	 
		dimorder,
		round(sum(zfy),4) as jcfy,
		case when sum(zfy2) <![CDATA[ <> ]]>
		0 then round((sum(zfy) - sum(zfy2)) / sum(zfy2), 4) else 0 end as
		yearOnYear,
		case when sum(zfy3) <![CDATA[ <> ]]>
		0 then round((sum(zfy) - sum(zfy3)) / sum(zfy3), 4) else 0 end as
		ringRatio
		from ( select
		code,
		text,
		dimorder,
		case when flag = 1 then sum(zfy) else 0 end zfy,
		case when flag = 2 then sum(zfy) else 0 end zfy2,
		case when flag = 3
		then sum(zfy) else 0 end zfy3
		from (
			SELECT a.code,a.text ,a.dimorder,decode(nvl(b,0),0,0,a/b) as zfy,1 as flag FROM
			(select code,text,dimorder,
				<choose>
			        <when test="CWorYW=='CW'">
			           sum(${cw_mzxx.indbName_value})  as a 
			        </when>
			        <when test="CWorYW=='YW'">
			           sum(${yw_mzxx.indbName_value})  as a 
			        </when>
		    	</choose>
			
			from 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_mzxx.indbName_value}  t1
		        </when>
		        <when test="CWorYW=='YW'">
		            ${yw_mzxx.indbName_value}  t1
		        </when>
		    </choose>
			LEFT JOIN 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_mzxx.dimDept} t4
		        </when>
		         <when test="CWorYW=='YW'">
		           ${yw_mzxx.dimDept} t4
		        </when>
		    </choose>
			 on 
			 <choose>
		        <when test="CWorYW=='CW'">
		           t1.${cw_mzxx.dimDept} = t4.code
		        </when>
		        <when test="CWorYW=='YW'">
		           t1.${yw_mzxx.dimDept} = t4.code
		        </when>
		    </choose>
		        <choose>
				<when
					test='aycx != null and aycx ==1'>
					<include refid="sql_nowMonth_where2_FY" />
				</when>
				<when
					test='aycx == null or (aycx != null and aycx !=1 )'>
					<include refid="sql_now_where2_FY" />
				</when>
			</choose>
			where 1 = 1 
			
			GROUP BY code,text,dimorder ORDER BY dimorder) a 
			left	 JOIN
			(	
				select
				code,text,
				dimorder,
			    sum(${mz_jzrc.indbName_value})  as b 
				from 
			           ${mz_jzrc.indbName_value} t1
				LEFT JOIN 
				
				<choose>
			        <when test="CWorYW=='CW'">
			            ${mz_jzrc.dimDeptCW} t4
			            on
			            t1.${mz_jzrc.dimDeptCW} = t4.code
			        </when>
			         <when test="CWorYW=='YW'">
			          ${mz_jzrc.dimDept} t4
			          on
			          t1.${mz_jzrc.dimDept} = t4.code
			        </when>
		   		 </choose>
				
				where 1 = 1 
				<choose>
					<when
						test='aycx != null and aycx ==1'>
						<include refid="sql_nowMonth_where2_RC" />
						
					</when>
					<when
						test='aycx == null or (aycx != null and aycx !=1 )'>
						<include refid="sql_now_where2_RC" />
					</when>
				</choose>
				GROUP BY code,text ,dimorder 
				ORDER BY dimorder
			) b on a.code = b.code
			
		<!-- 同比 -->
		union
		
		SELECT a.code,a.text ,a.dimorder,decode(nvl(b,0),0,0,a/b) as zfy,2 as flag FROM
			(select code,text,dimorder,
				<choose>
			        <when test="CWorYW=='CW'">
			           sum(${cw_mzxx.indbName_value})  as a 
			        </when>
			        <when test="CWorYW=='YW'">
			           sum(${yw_mzxx.indbName_value})  as a 
			        </when>
		    	</choose>
			
			from 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_mzxx.indbName_value}  t1
		        </when>
		        <when test="CWorYW=='YW'">
		           ${yw_mzxx.indbName_value}  t1
		        </when>
		    </choose>
			LEFT JOIN 
			<choose>
<!-- 		        <when test="CWorYW=='CW'"> -->
<!-- 		           ${cw_mzxx.dimDeptCW} t4 -->
<!-- 		        </when> -->
		        <when test="CWorYW=='CW'">
		           ${cw_mzxx.dimDept} t4
		        </when>
		         <when test="CWorYW=='YW'">
		           ${yw_mzxx.dimDept} t4
		        </when>
		    </choose>
			 on 
			 <choose>
		        <when test="CWorYW=='CW'">
		           t1.${cw_mzxx.dimDept} = t4.code
		        </when>
		        <when test="CWorYW=='YW'">
		           t1.${yw_mzxx.dimDept} = t4.code
		        </when>
		    </choose>
			where 1 = 1 
			<choose>
				<when
					test='aycx != null and aycx ==1'>
					<include refid="sql_yearOnYearMonth_where2_FY" />
				</when>
				<when
					test='aycx == null or (aycx != null and aycx !=1 )'>
					<include refid="sql_yearOnYear_where2_FY" />
				</when>
			</choose>
			GROUP BY code,text,dimorder ORDER BY dimorder) a 
			left	 JOIN
			(	
				select
				code,text,
				dimorder,
			    sum(${mz_jzrc.indbName_value})  as b 
				from 
			           ${mz_jzrc.indbName_value} t1
				LEFT JOIN 
			          <choose>
			        <when test="CWorYW=='CW'">
			            ${mz_jzrc.dimDeptCW} t4
			            on
			            t1.${mz_jzrc.dimDeptCW} = t4.code
			        </when>
			         <when test="CWorYW=='YW'">
			          ${mz_jzrc.dimDept} t4
			          on
			          t1.${mz_jzrc.dimDept} = t4.code
			        </when>
		   		 </choose>
				where 1 = 1 
			<choose>
				<when
					test='aycx != null and aycx ==1'>
					<include refid="sql_yearOnYearMonth_where2_RC" />
				</when>
				<when
					test='aycx == null or (aycx != null and aycx !=1 )'>
					<include refid="sql_yearOnYear_where2_RC" />
				</when>
			</choose>
			GROUP BY code,text ,dimorder 
			ORDER BY dimorder) b on a.code = b.code
		
		<!-- 环比 -->
		union
		
		SELECT a.code,a.text ,a.dimorder,decode(nvl(b,0),0,0,a/b) as zfy,3 as flag FROM
			(select code,text,dimorder,
				<choose>
			        <when test="CWorYW=='CW'">
			           sum(${cw_mzxx.indbName_value})  as a 
			        </when>
			        <when test="CWorYW=='YW'">
			           sum(${yw_mzxx.indbName_value})  as a 
			        </when>
		    	</choose>
			
			from 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_mzxx.indbName_value}  t1
		        </when>
		        <when test="CWorYW=='YW'">
		           ${yw_mzxx.indbName_value}  t1
		        </when>
		    </choose>
			LEFT JOIN 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_mzxx.dimDept} t4
		        </when>
		         <when test="CWorYW=='YW'">
		           ${yw_mzxx.dimDept} t4
		        </when>
		    </choose>
			 on 
			 <choose>
		        <when test="CWorYW=='CW'">
		           t1.${cw_mzxx.dimDept} = t4.code
		        </when>
		        <when test="CWorYW=='YW'">
		           t1.${yw_mzxx.dimDept} = t4.code
		        </when>
		    </choose>
			where 1 = 1 
			<choose>
				<when
					test='aycx != null and aycx ==1'>
					<include refid="sql_ringRatioMonth_where2_FY" />
				</when>
				<when
					test='aycx == null or (aycx != null and aycx !=1 )'>
					<include refid="sql_ringRatio_where2_FY" />
				</when>
			</choose>
			GROUP BY code,text,dimorder ORDER BY dimorder) a 
			left	 JOIN
			(	
				select
				code,text,
				dimorder,
			    sum(${mz_jzrc.indbName_value})  as b 
				from 
			           ${mz_jzrc.indbName_value} t1
				LEFT JOIN 
			           <choose>
			        <when test="CWorYW=='CW'">
			            ${mz_jzrc.dimDeptCW} t4
			            on
			            t1.${mz_jzrc.dimDeptCW} = t4.code
			        </when>
			         <when test="CWorYW=='YW'">
			          ${mz_jzrc.dimDept} t4
			          on
			          t1.${mz_jzrc.dimDept} = t4.code
			        </when>
		   		 </choose>
			where 1 = 1 
			<choose>
			<when
				test='aycx != null and aycx ==1'>
				<include refid="sql_ringRatioMonth_where2_RC" />
			</when>
			<when
				test='aycx == null or (aycx != null and aycx !=1 )'>
				<include refid="sql_ringRatio_where2_RC" />
			</when>
		</choose>
			GROUP BY code,text ,dimorder 
			ORDER BY dimorder) b on a.code = b.code
		
			) 
			<!-- TODO -->
			<include refid="sql_where_deptCodes" />
			
			GROUP BY code,text,flag,dimorder)GROUP BY code,text,dimorder ORDER BY dimorder
		
	</select>
	
	
	
	<!-- 统计查询  手术均次 下钻到科室 -->
	<select id="getAverageCostByDeptAndSs" resultType="hashmap" parameterType="hashmap">
		select code,
		text,	 
		dimorder,
		round(sum(zfy),4) as jcfy,
		case when sum(zfy2) <![CDATA[ <> ]]>
		0 then round((sum(zfy) - sum(zfy2)) / sum(zfy2), 4) else 0 end as
		yearOnYear,
		case when sum(zfy3) <![CDATA[ <> ]]>
		0 then round((sum(zfy) - sum(zfy3)) / sum(zfy3), 4) else 0 end as
		ringRatio
		from ( select
		code,
		text,
		dimorder,
		case when flag = 1 then sum(zfy) else 0 end zfy,
		case when flag = 2 then sum(zfy) else 0 end zfy2,
		case when flag = 3
		then sum(zfy) else 0 end zfy3
		from (
			SELECT a.code,a.text ,a.dimorder,decode(nvl(b,0),0,0,a/b) as zfy,1 as flag FROM
			(select code,text,dimorder,
				<choose>
			        <when test="CWorYW=='CW'">
			           sum(${cw_ssfy.indbName_value})  as a 
			        </when>
			        <when test="CWorYW=='YW'">
			           sum(${yw_ssfy.indbName_value})  as a 
			        </when>
		    	</choose>
			
			from 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_ssfy.indbName_value}  t1
		        </when>
		        <when test="CWorYW=='YW'">
		            ${yw_ssfy.indbName_value}  t1
		        </when>
		    </choose>
			LEFT JOIN 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_ssfy.dimDept} t4
		        </when>
		         <when test="CWorYW=='YW'">
		           ${yw_ssfy.dimDept} t4
		        </when>
		    </choose>
			 on 
			 <choose>
		        <when test="CWorYW=='CW'">
		           t1.${cw_ssfy.dimDept} = t4.code
		        </when>
		        <when test="CWorYW=='YW'">
		           t1.${yw_ssfy.dimDept} = t4.code
		        </when>
		    </choose>
			where 1 = 1 
			<choose>
				<when
					test='aycx != null and aycx ==1'>
					<include refid="sql_nowMonth_where2_FY" />
				</when>
				<when
					test='aycx == null or (aycx != null and aycx !=1 )'>
					<include refid="sql_now_where2_FY" />
				</when>
			</choose>
			GROUP BY code,text,dimorder ORDER BY dimorder) a 
			left	 JOIN
			(	
				select
				code,text,
				dimorder,
			    sum(${ss_jzrc.indbName_value})  as b 
				from 
			           ${ss_jzrc.indbName_value} t1
				LEFT JOIN 
			          <choose>
			        <when test="CWorYW=='CW'">
			            ${ss_jzrc.dimDeptCW} t4
			            on
			            t1.${ss_jzrc.dimDeptCW} = t4.code
			        </when>
			         <when test="CWorYW=='YW'">
			          ${ss_jzrc.dimDept} t4
			          on
			          t1.${ss_jzrc.dimDept} = t4.code
			        </when>
		   		 </choose>
				where 1 = 1 
				<choose>
					<when
						test='aycx != null and aycx ==1'>
						<include refid="sql_nowMonth_where2_RC" />
					</when>
					<when
						test='aycx == null or (aycx != null and aycx !=1 )'>
						<include refid="sql_now_where2_RC" />
					</when>
				</choose>
				GROUP BY code,text ,dimorder 
				ORDER BY dimorder
			) b on a.code = b.code
			
		<!-- 同比 -->
		union
		
		SELECT a.code,a.text ,a.dimorder,decode(nvl(b,0),0,0,a/b) as zfy,2 as flag FROM
			(select code,text,dimorder,
				<choose>
			        <when test="CWorYW=='CW'">
			           sum(${cw_ssfy.indbName_value})  as a 
			        </when>
			        <when test="CWorYW=='YW'">
			           sum(${yw_ssfy.indbName_value})  as a 
			        </when>
		    	</choose>
			
			from 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_ssfy.indbName_value}  t1
		        </when>
		        <when test="CWorYW=='YW'">
		           ${yw_ssfy.indbName_value}  t1
		        </when>
		    </choose>
			LEFT JOIN 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_ssfy.dimDept} t4
		        </when>
		         <when test="CWorYW=='YW'">
		           ${yw_ssfy.dimDept} t4
		        </when>
		    </choose>
			 on 
			 <choose>
		        <when test="CWorYW=='CW'">
		           t1.${cw_ssfy.dimDept} = t4.code
		        </when>
		        <when test="CWorYW=='YW'">
		           t1.${yw_ssfy.dimDept} = t4.code
		        </when>
		    </choose>
			where 1 = 1 
			<choose>
				<when
					test='aycx != null and aycx ==1'>
					<include refid="sql_yearOnYearMonth_where2_FY" />
				</when>
				<when
					test='aycx == null or (aycx != null and aycx !=1 )'>
					<include refid="sql_yearOnYear_where2_FY" />
				</when>
			</choose>
			GROUP BY code,text,dimorder ORDER BY dimorder) a 
			left	 JOIN
			(	
				select
				code,text,
				dimorder,
			    sum(${ss_jzrc.indbName_value})  as b 
				from 
			           ${ss_jzrc.indbName_value} t1
				LEFT JOIN 
			          <choose>
			        <when test="CWorYW=='CW'">
			            ${ss_jzrc.dimDeptCW} t4
			            on
			            t1.${ss_jzrc.dimDeptCW} = t4.code
			        </when>
			         <when test="CWorYW=='YW'">
			          ${ss_jzrc.dimDept} t4
			          on
			          t1.${ss_jzrc.dimDept} = t4.code
			        </when>
		   		 </choose>
				where 1 = 1 
			<choose>
				<when
					test='aycx != null and aycx ==1'>
					<include refid="sql_yearOnYearMonth_where2_RC" />
				</when>
				<when
					test='aycx == null or (aycx != null and aycx !=1 )'>
					<include refid="sql_yearOnYear_where2_RC" />
				</when>
			</choose>
			GROUP BY code,text ,dimorder 
			ORDER BY dimorder) b on a.code = b.code
		
		<!-- 环比 -->
		union
		
		SELECT a.code,a.text ,a.dimorder,decode(nvl(b,0),0,0,a/b) as zfy,3 as flag FROM
			(select code,text,dimorder,
				<choose>
			        <when test="CWorYW=='CW'">
			           sum(${cw_ssfy.indbName_value})  as a 
			        </when>
			        <when test="CWorYW=='YW'">
			           sum(${yw_ssfy.indbName_value})  as a 
			        </when>
		    	</choose>
			
			from 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_ssfy.indbName_value}  t1
		        </when>
		        <when test="CWorYW=='YW'">
		           ${yw_ssfy.indbName_value}  t1
		        </when>
		    </choose>
			LEFT JOIN 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_ssfy.dimDept} t4
		        </when>
		         <when test="CWorYW=='YW'">
		           ${yw_ssfy.dimDept} t4
		        </when>
		    </choose>
			 on 
			 <choose>
		        <when test="CWorYW=='CW'">
		           t1.${cw_ssfy.dimDept} = t4.code
		        </when>
		        <when test="CWorYW=='YW'">
		           t1.${yw_ssfy.dimDept} = t4.code
		        </when>
		    </choose>
			where 1 = 1 
			<choose>
				<when
					test='aycx != null and aycx ==1'>
					<include refid="sql_ringRatioMonth_where2_FY" />
				</when>
				<when
					test='aycx == null or (aycx != null and aycx !=1 )'>
					<include refid="sql_ringRatio_where2_FY" />
				</when>
			</choose>
			GROUP BY code,text,dimorder ORDER BY dimorder) a 
			left	 JOIN
			(	
				select
				code,text,
				dimorder,
			    sum(${ss_jzrc.indbName_value})  as b 
				from 
			           ${ss_jzrc.indbName_value} t1
				LEFT JOIN 
			           <choose>
			        <when test="CWorYW=='CW'">
			            ${ss_jzrc.dimDeptCW} t4
			            on
			            t1.${ss_jzrc.dimDeptCW} = t4.code
			        </when>
			         <when test="CWorYW=='YW'">
			          ${ss_jzrc.dimDept} t4
			          on
			          t1.${ss_jzrc.dimDept} = t4.code
			        </when>
		   		 </choose>
			where 1 = 1 
			<choose>
			<when
				test='aycx != null and aycx ==1'>
				<include refid="sql_ringRatioMonth_where2_RC" />
			</when>
			<when
				test='aycx == null or (aycx != null and aycx !=1 )'>
				<include refid="sql_ringRatio_where2_RC" />
			</when>
		</choose>
			GROUP BY code,text ,dimorder 
			ORDER BY dimorder) b on a.code = b.code
		
			) 
			<!-- TODO -->
			<include refid="sql_where_deptCodes" />
			
			GROUP BY code,text,flag,dimorder)GROUP BY code,text,dimorder ORDER BY dimorder
		
	</select>
	
	
	<!-- 统计查询  住院均次费  下钻到科室-->
	<select id="getAverageCostByDeptAndZy" resultType="hashmap" parameterType="hashmap">
		select code,
		text,	 
		dimorder,
		round(sum(zfy),4) as jcfy,
		case when sum(zfy2) <![CDATA[ <> ]]>
		0 then round((sum(zfy) - sum(zfy2)) / sum(zfy2), 4) else 0 end as
		yearOnYear,
		case when sum(zfy3) <![CDATA[ <> ]]>
		0 then round((sum(zfy) - sum(zfy3)) / sum(zfy3), 4) else 0 end as
		ringRatio
		from ( select
		code,
		text,
		dimorder,
		case when flag = 1 then sum(zfy) else 0 end zfy,
		case when flag = 2 then sum(zfy) else 0 end zfy2,
		case when flag = 3
		then sum(zfy) else 0 end zfy3
		from (
			SELECT a.code,a.text ,a.dimorder,decode(nvl(b,0),0,0,a/b) as zfy,1 as flag FROM
			(select code,text,dimorder,
				<choose>
			        <when test="CWorYW=='CW'">
			           sum(${cw_zyxx.indbName_value})  as a 
			        </when>
			        <when test="CWorYW=='YW'">
			           sum(${yw_zyxx.indbName_value})  as a 
			        </when>
		    	</choose>
			
			from 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_zyxx.indbName_value}  t1
		        </when>
		        <when test="CWorYW=='YW'">
		            ${yw_zyxx.indbName_value}  t1
		        </when>
		    </choose>
			LEFT JOIN 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_zyxx.dimDept} t4
		        </when>
		         <when test="CWorYW=='YW'">
		           ${yw_zyxx.dimDept} t4
		        </when>
		    </choose>
			 on 
			 <choose>
		        <when test="CWorYW=='CW'">
		           t1.${cw_zyxx.dimDept} = t4.code
		        </when>
		        <when test="CWorYW=='YW'">
		           t1.${yw_zyxx.dimDept} = t4.code
		        </when>
		    </choose>
			where 1 = 1 
			<choose>
				<when
					test='aycx != null and aycx ==1'>
					<include refid="sql_nowMonth_where2_FY" />
				</when>
				<when
					test='aycx == null or (aycx != null and aycx !=1 )'>
					<include refid="sql_now_where2_FY" />
				</when>
			</choose>
			GROUP BY code,text,dimorder ORDER BY dimorder) a 
			left	 JOIN
			(	
				select
				code,text,
				dimorder,
			    sum(${zy_jzrc.indbName_value})  as b 
				from 
			           ${zy_jzrc.indbName_value} t1
				LEFT JOIN 
			          <choose>
			        <when test="CWorYW=='CW'">
			            ${zy_jzrc.dimDeptCW} t4
			            on
			            t1.${zy_jzrc.dimDeptCW} = t4.code
			        </when>
			         <when test="CWorYW=='YW'">
			          ${zy_jzrc.dimDept} t4
			          on
			          t1.${zy_jzrc.dimDept} = t4.code
			        </when>
		   		 </choose>
				where 1 = 1 
				<choose>
					<when
						test='aycx != null and aycx ==1'>
						<include refid="sql_nowMonth_where2_RC" />
					</when>
					<when
						test='aycx == null or (aycx != null and aycx !=1 )'>
						<include refid="sql_now_where2_RC" />
					</when>
				</choose>
				GROUP BY code,text ,dimorder 
				ORDER BY dimorder
			) b on a.code = b.code
			
		<!-- 同比 -->
		union
		
		SELECT a.code,a.text ,a.dimorder,decode(nvl(b,0),0,0,a/b) as zfy,2 as flag FROM
			(select code,text,dimorder,
				<choose>
			        <when test="CWorYW=='CW'">
			           sum(${cw_zyxx.indbName_value})  as a 
			        </when>
			        <when test="CWorYW=='YW'">
			           sum(${yw_zyxx.indbName_value})  as a 
			        </when>
		    	</choose>
			
			from 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_zyxx.indbName_value}  t1
		        </when>
		        <when test="CWorYW=='YW'">
		           ${yw_zyxx.indbName_value}  t1
		        </when>
		    </choose>
			LEFT JOIN 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_zyxx.dimDept} t4
		        </when>
		         <when test="CWorYW=='YW'">
		           ${yw_zyxx.dimDept} t4
		        </when>
		    </choose>
			 on 
			 <choose>
		        <when test="CWorYW=='CW'">
		           t1.${cw_zyxx.dimDept} = t4.code
		        </when>
		        <when test="CWorYW=='YW'">
		           t1.${yw_zyxx.dimDept} = t4.code
		        </when>
		    </choose>
			where 1 = 1 
			<choose>
				<when
					test='aycx != null and aycx ==1'>
					<include refid="sql_yearOnYearMonth_where2_FY" />
				</when>
				<when
					test='aycx == null or (aycx != null and aycx !=1 )'>
					<include refid="sql_yearOnYear_where2_FY" />
				</when>
			</choose>
			GROUP BY code,text,dimorder ORDER BY dimorder) a 
			left	 JOIN
			(	
				select
				code,text,
				dimorder,
			    sum(${zy_jzrc.indbName_value})  as b 
				from 
			           ${zy_jzrc.indbName_value} t1
				LEFT JOIN 
			         <choose>
			        <when test="CWorYW=='CW'">
			            ${zy_jzrc.dimDeptCW} t4
			            on
			            t1.${zy_jzrc.dimDeptCW} = t4.code
			        </when>
			         <when test="CWorYW=='YW'">
			          ${zy_jzrc.dimDept} t4
			          on
			          t1.${zy_jzrc.dimDept} = t4.code
			        </when>
		   		 </choose>
				where 1 = 1 
			<choose>
				<when
					test='aycx != null and aycx ==1'>
					<include refid="sql_yearOnYearMonth_where2_RC" />
				</when>
				<when
					test='aycx == null or (aycx != null and aycx !=1 )'>
					<include refid="sql_yearOnYear_where2_RC" />
				</when>
			</choose>
			GROUP BY code,text ,dimorder 
			ORDER BY dimorder) b on a.code = b.code
		
		<!-- 环比 -->
		union
		
		SELECT a.code,a.text ,a.dimorder,decode(nvl(b,0),0,0,a/b) as zfy,3 as flag FROM
			(select code,text,dimorder,
				<choose>
			        <when test="CWorYW=='CW'">
			           sum(${cw_zyxx.indbName_value})  as a 
			        </when>
			        <when test="CWorYW=='YW'">
			           sum(${yw_zyxx.indbName_value})  as a 
			        </when>
		    	</choose>
			
			from 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_zyxx.indbName_value}  t1
		        </when>
		        <when test="CWorYW=='YW'">
		           ${yw_zyxx.indbName_value}  t1
		        </when>
		    </choose>
			LEFT JOIN 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_zyxx.dimDept} t4
		        </when>
		         <when test="CWorYW=='YW'">
		           ${yw_zyxx.dimDept} t4
		        </when>
		    </choose>
			 on 
			 <choose>
		        <when test="CWorYW=='CW'">
		           t1.${cw_zyxx.dimDept} = t4.code
		        </when>
		        <when test="CWorYW=='YW'">
		           t1.${yw_zyxx.dimDept} = t4.code
		        </when>
		    </choose>
			where 1 = 1 
			<choose>
				<when
					test='aycx != null and aycx ==1'>
					<include refid="sql_ringRatioMonth_where2_FY" />
				</when>
				<when
					test='aycx == null or (aycx != null and aycx !=1 )'>
					<include refid="sql_ringRatio_where2_FY" />
				</when>
			</choose>
			GROUP BY code,text,dimorder ORDER BY dimorder) a 
			left	 JOIN
			(	
				select
				code,text,
				dimorder,
			    sum(${zy_jzrc.indbName_value})  as b 
				from 
			           ${zy_jzrc.indbName_value} t1
				LEFT JOIN 
			          <choose>
			        <when test="CWorYW=='CW'">
			            ${zy_jzrc.dimDeptCW} t4
			            on
			            t1.${zy_jzrc.dimDeptCW} = t4.code
			        </when>
			         <when test="CWorYW=='YW'">
			          ${zy_jzrc.dimDept} t4
			          on
			          t1.${zy_jzrc.dimDept} = t4.code
			        </when>
		   		 </choose>
			where 1 = 1 
			<choose>
			<when
				test='aycx != null and aycx ==1'>
				<include refid="sql_ringRatioMonth_where2_RC" />
			</when>
			<when
				test='aycx == null or (aycx != null and aycx !=1 )'>
				<include refid="sql_ringRatio_where2_RC" />
			</when>
		</choose>
			GROUP BY code,text ,dimorder 
			ORDER BY dimorder) b on a.code = b.code
		
			) 
			
			<!-- TODO -->
			<include refid="sql_where_deptCodes" />
			GROUP BY code,text,flag,dimorder)GROUP BY code,text,dimorder ORDER BY dimorder
		
	</select>
	
	<!-- 获取月报信息 - 日均&月度 出入院人次 -->
	<select id="getComprehensiveMonthlyReportPersonTime" parameterType="hashmap" resultType="hashmap">
		select sum(cyrjrc) as cyrjrc,sum(ryrjrc) as ryrjrc,sum(yryrc) as yryrc,sum(ycyrc) as ycyrc
		from (
				--日均出院
				select
					round(nvl(sum(${zy_jzrc.indbName_value}),0) / (case when #{yf,jdbcType=VARCHAR} =to_char(sysdate, 'yyyy-mm')
					then to_char(sysdate, 'dd') - 1
					else to_number(to_char(last_day(to_date(#{yf,jdbcType=VARCHAR},'yyyy-mm')),'dd'))end),0) as cyrjrc,
					0 as ryrjrc,0 as ycyrc,0 as yryrc,1 as flag
				from ${zy_jzrc.indbName_value} t1, ${zy_jzrc.dimOrganization} t2
				where t1.${zy_jzrc.dimOrganization}= t2.code
				<if test='yf != null'>
					and t1.${zy_jzrc.dimMonth} = #{yf,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${zy_jzrc.dimOrganization} in
					<foreach item="item" collection="jgidList" open="(" separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
			union
			--日均入院
			select 0 as cyrjrc,round(
					(select nvl(sum(${sz_br.indbName_value}),0)
					from ${sz_br.indbName_value} t1
					<where>
						<if test='yf != null'>
								t1.${sz_br.dimMonth} = #{yf,jdbcType=VARCHAR}
						</if>
						<if test="size != 0">
							and t1.${sz_br.dimOrganization} in
							<foreach item="item" collection="jgidList" open="(" separator="," close=")">
								#{item.jgid,jdbcType=VARCHAR}
							</foreach>
						</if>
					</where>
					) / (case
						when #{yf,jdbcType=VARCHAR} = to_char(sysdate, 'yyyy-mm')
						then to_char(sysdate, 'dd') - 1
						else to_number(to_char(last_day(to_date(#{yf,jdbcType=VARCHAR},'yyyy-mm')),'dd'))end),
			0) as ryrjrc,0 as ycyrc,0 as yryrc,2 as flag
			from dual
			union
			--入院
			select 0 as cyrjrc,0 as ryrjrc,0 as ycyrc,
			(select nvl(sum(${sz_br.indbName_value}),0)
				from ${sz_br.indbName_value} t1
				<where>
					<if test='yf != null'>
						t1.${sz_br.dimMonth} = #{yf,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${sz_br.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</where>
			) as yryrc,3 as flag
			from dual
			--出院
			union
			select 0 as cyrjrc,0 as ryrjrc,nvl(sum(${zy_jzrc.indbName_value}),0) as ycyrc,0 as yryrc,4 as flag
			from ${zy_jzrc.indbName_value} t1, ${zy_jzrc.dimOrganization} t2
			where t1.${zy_jzrc.dimOrganization} = t2.code
			<if test='yf != null'>
				and t1.${zy_jzrc.dimMonth} = #{yf,jdbcType=VARCHAR}
			</if>
			<if test="size != 0">
				and t1.${zy_jzrc.dimOrganization} in
				<foreach item="item" collection="jgidList" open="(" separator="," close=")">
					#{item.jgid,jdbcType=VARCHAR}
				</foreach>
			</if>
		)
	</select>
	
	<!-- 月收治人次、同比、环比 -->
	<select id="getComprehensiveMonthlyReportAdmissionsPersonTime" resultType="hashmap" parameterType="hashmap">
		select sum(yryrc) as rc,
		case when sum(tbyryrc)  <![CDATA[ <> ]]>0 then round((sum(yryrc) - sum(tbyryrc)) / sum(tbyryrc), 4) else 0 end as yearOnYear,
		case when sum(hbyryrc)  <![CDATA[ <> ]]>0 then round((sum(yryrc) - sum(hbyryrc)) / sum(hbyryrc), 4) else 0 end as ringRatio
		from (
				--入院
				select nvl((
						select nvl(sum(${sz_br.indbName_value}),0)
						from ${sz_br.indbName_value} t1, ${sz_br.dimOrganization} t2
						where t1.${sz_br.dimOrganization} = t2.code
						<if test='yf != null'>
							and t1.${sz_br.dimMonth} = #{yf,jdbcType=VARCHAR}
						</if>
						<if test="size != 0">
							and t1.${sz_br.dimOrganization} in
							<foreach item="item" collection="jgidList" open="(" separator="," close=")">
								#{item.jgid,jdbcType=VARCHAR}
							</foreach>
						</if>
					),0) yryrc,0 as tbyryrc,0 as hbyryrc,1 as flag
				from dual
				union
				select 0 as yryrc,
				nvl((
					select nvl(sum(${sz_br.indbName_value}),0)
					from ${sz_br.indbName_value} t1,${sz_br.dimOrganization} t2
					where t1.${sz_br.dimOrganization} = t2.code
					<if test='yf != null'>
						and t1.${sz_br.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${sz_br.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				),0) tbyryrc,0 as hbyryrc,2 as flag
				from dual
				union
				select 0 as yryrc,0 as tbyryrc,
				nvl((
					select nvl(sum(${sz_br.indbName_value}),0)
					from ${sz_br.indbName_value} t1,${sz_br.dimOrganization} t2
					where t1.${sz_br.dimOrganization} = t2.code
					<if test='yf != null'>
						and t1.${sz_br.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${sz_br.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				),0) hbyryrc,3 as flag
				from dual
			)
	</select>

	<!--  日均门诊人次、同比、环比 -->
	<select id="getComprehensiveMonthlyReportDailyAverageOutpatientPersonTime" resultType="hashmap" parameterType="hashmap">
		select rjrc,case when rjtb = 0 then 0 else round((rjrc-rjtb )/rjtb,4) end as yearOnYear,
		case when rjhb = 0 then 0 else round((rjrc-rjhb)/rjhb,4) end as ringRatio
		from (
				select
				case when (
					case when #{yf,jdbcType=VARCHAR} = to_char(sysdate,'yyyy-mm')
					then to_char(sysdate, 'dd') -1 else
					to_number(to_char(last_day(to_date(#{yf,jdbcType=VARCHAR},'yyyy-mm')), 'dd'))end
				) = 0 then 0 else
				round(
					sum(yryrc)/ (case when #{yf,jdbcType=VARCHAR} = to_char(sysdate,'yyyy-mm')
					then to_char(sysdate, 'dd') -1 else
					to_number(to_char(last_day(to_date(#{yf,jdbcType=VARCHAR},'yyyy-mm')), 'dd')) end) , 0
					) end as rjrc,
				case when (
					case when #{yf,jdbcType=VARCHAR} = to_char(sysdate,'yyyy-mm') then to_char(sysdate, 'dd') -1 else
					to_number(to_char(last_day(to_date(#{yf,jdbcType=VARCHAR},'yyyy-mm')), 'dd')) end
				) = 0 then 0 else
				round(
					sum(tbyryrc)/ (case when #{yf,jdbcType=VARCHAR} = to_char(sysdate,'yyyy-mm')
					then to_char(sysdate, 'dd') -1 else to_number(to_char(last_day(to_date(#{yf,jdbcType=VARCHAR},'yyyy-mm')), 'dd')) end) , 0
				) end as rjtb,
				case when (
					case when #{yf,jdbcType=VARCHAR} = to_char(sysdate,'yyyy-mm')
					then to_char(sysdate, 'dd') -1 else
					to_number(to_char(last_day(to_date(#{yf,jdbcType=VARCHAR},'yyyy-mm')), 'dd')) end
				) = 0 then 0 else
				round(
					sum(hbyryrc)/ (case when #{yf,jdbcType=VARCHAR} = to_char(sysdate,'yyyy-mm')
					then to_char(sysdate, 'dd') -1 else to_number(to_char(last_day(to_date(#{yf,jdbcType=VARCHAR},'yyyy-mm')), 'dd')) end) , 0
				) end as rjhb
				from (
					--门诊人次
					select sum(${mz_jzrc.indbName_value}) as yryrc,0 as tbyryrc,0 as hbyryrc,1 as flag
					from ${mz_jzrc.indbName_value} t1, ${mz_jzrc.dimOrganization} t2
					where t1.${mz_jzrc.dimOrganization} = t2.code
					<if test='yf != null'>
						and t1.${mz_jzrc.dimMonth} = #{yf,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${mz_jzrc.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
					union
					select 0 as ycyrc,sum(${mz_jzrc.indbName_value}) as tbyryrc,0 as hbyryrc,2 as flag
					from ${mz_jzrc.indbName_value} t1, ${mz_jzrc.dimOrganization} t2
					where t1.${mz_jzrc.dimOrganization} =t2.code
					<if test='yearOnYearMonth != null'>
						and t1.${mz_jzrc.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${mz_jzrc.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
					union
					select 0 as ycyrc,0 as tbycyrc,sum(${mz_jzrc.indbName_value}) as hbyryrc,3 as flag
					from ${mz_jzrc.indbName_value} t1, ${mz_jzrc.dimOrganization} t2
					where t1.${mz_jzrc.dimOrganization} =t2.code
					<if test='ringRatioMonth != null'>
						and t1.${mz_jzrc.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${mz_jzrc.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				)
		)
	</select>

	<!--  月门诊人次、同比、环比 -->
	<select id="getComprehensiveMonthlyReportMonthlyOutpatientPersonTime" resultType="hashmap" parameterType="hashmap">
		select sum(yryrc) as ymzrc,
		case when sum(tbyryrc) =0 then 0 else round((sum(yryrc)-sum(tbyryrc))/sum(tbyryrc),4) end as yearOnYear,
		case when sum(hbyryrc) =0 then 0 else round((sum(yryrc)-sum(hbyryrc))/sum(hbyryrc),4) end as ringRatio
		from (
				--月门诊人次
				select sum(${mz_jzrc.indbName_value}) as yryrc,0 as tbyryrc,0 as hbyryrc,1 as flag
				from ${mz_jzrc.indbName_value} t1, ${mz_jzrc.dimOrganization} t2
				where t1.${mz_jzrc.dimOrganization} =t2.code
				<if test='yf != null'>
					and t1.${mz_jzrc.dimMonth} = #{yf,jdbcType=VARCHAR}</if>
				<if test="size != 0">
					and t1.${mz_jzrc.dimOrganization} in
					<foreach item="item" collection="jgidList" open="(" separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
				union
				select 0 as ycyrc,sum(${mz_jzrc.indbName_value}) as tbyryrc,0 as hbyryrc,2 as flag
				from ${mz_jzrc.indbName_value} t1, ${mz_jzrc.dimOrganization} t2
				where t1.${mz_jzrc.dimOrganization} =t2.code
				<if test='yearOnYearMonth != null'>
					and t1.${mz_jzrc.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${mz_jzrc.dimOrganization} in
					<foreach item="item" collection="jgidList" open="(" separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
				union
				select 0 as ycyrc,0 as tbycyrc,sum(${mz_jzrc.indbName_value}) as hbyryrc,3 as flag
				from ${mz_jzrc.indbName_value} t1, ${mz_jzrc.dimOrganization} t2
				where t1.${mz_jzrc.dimOrganization} =t2.code
				<if test='ringRatioMonth != null'>
					and t1.${mz_jzrc.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
				</if>
				<if test="size != 0">
					and t1.${mz_jzrc.dimOrganization} in
					<foreach item="item" collection="jgidList" open="("
						separator="," close=")">
						#{item.jgid,jdbcType=VARCHAR}
					</foreach>
				</if>
		)
	</select>

	<!-- 病区信息 -->
	<select id="getWardInformation" resultType="hashmap" parameterType="hashmap">
		select beHos beHos, --入院
		leaveHos leaveHos, --出院
		inHos inHos, --在院
		critical critical, --危重
		ratedBed ratedBed, --额定床位
		deptid deptid,deptname deptname
		from (
				select sum(beHos) beHos, --入院
				sum(leaveHos)
				leaveHos, --出院
				sum(inHos) inHos, --在院
				sum(critical) critical, --危重
				sum(ratedBed) ratedBed, --额定床位
				deptid deptid,deptname deptname,dimorder
				from (
						select sum(t1.${ry_rc.indbName_value}) beHos,0 leaveHos,0 inHos,0 critical,
						0 ratedBed,t2.code deptid,t2.text deptname,t2.dimorder dimorder
						from ${ry_rc.indbName_value} t1, ${ry_rc.dimDept} t2
						where t1.${ry_rc.dimDept}= t2.code
						<if test='date != null'>
							and t1.${ry_rc.dimTime} = #{date,jdbcType=VARCHAR}
						</if>
						<if test="size != 0">
							and t1.${ry_rc.dimOrganization} in
							<foreach item="item" collection="jgidList" open="(" separator="," close=")">
								#{item.jgid,jdbcType=VARCHAR}
							</foreach>
						</if>
						group by t2.code, t2.text,t2.dimorder
						union
						select 0 beHos,0 leaveHos,sum(t1.${zy_rc.indbName_value}) inHos,0 critical,0 ratedBed,
						t2.code deptid,t2.text deptname,t2.dimorder dimorder
						from ${zy_rc.indbName_value} t1, ${zy_rc.dimDept} t2
						where t1.${zy_rc.dimDept} = t2.code 
						and t1.${zy_rc.dimSjc} = 
						(select
							max(t1.${zy_rc.dimSjc}) from ${zy_rc.indbName_value} t1 
							<where>
								<if test='date != null'>
									t1.${zy_rc.dimTime} = #{date,jdbcType=VARCHAR}
								</if>
								<if test="size != 0">
									and t1.${zy_rc.dimOrganization} in
									<foreach item="item" collection="jgidList" open="(" separator="," close=")">
										#{item.jgid,jdbcType=VARCHAR}
									</foreach>
								</if>
							</where>
						)
						<if test='date != null'>
							and t1.${zy_rc.dimTime} = #{date,jdbcType=VARCHAR}
						</if>
						<if test="size != 0">
							and t1.${zy_rc.dimOrganization} in
							<foreach item="item" collection="jgidList" open="(" separator="," close=")">
								#{item.jgid,jdbcType=VARCHAR}
							</foreach>
						</if>
						group by t2.code, t2.text,t2.dimorder
						union
						select 0 beHos,sum(t1.${cy_rc.indbName_value}) leaveHos,0 inHos,0 critical,
						0 ratedBed,t2.code deptid,t2.text deptname,t2.dimorder dimorder
						from ${cy_rc.indbName_value} t1,${cy_rc.dimDept} t2
						where t1.${cy_rc.dimDept} = t2.code
						<if test='date != null'>
							and t1.${cy_rc.dimTime} = #{date,jdbcType=VARCHAR}
						</if>
						<if test="size != 0">
							and t1.${cy_rc.dimOrganization} in
							<foreach item="item" collection="jgidList" open="(" separator="," close=")">
								#{item.jgid,jdbcType=VARCHAR}
							</foreach>
						</if>
						group by t2.code, t2.text,t2.dimorder
						union
						select 0 beHos,0 leaveHos,0 inHos,sum(${zy_rc.indbName_value}) critical,
						0 ratedBed,t2.code deptid,t2.text deptname,t2.dimorder dimorder
						from ${zy_rc.indbName_value} t1, ${zy_rc.dimDept} t2
						where t1.${zy_rc.dimDept} = t2.code
						and t1.${zy_rc.dimSjc} = 
						(select
							max(t1.${zy_rc.dimSjc}) from ${zy_rc.indbName_value} t1 
							<where>
								<if test='date != null'>
									t1.${zy_rc.dimTime} = #{date,jdbcType=VARCHAR}
								</if>
								<if test="size != 0">
									and t1.${zy_rc.dimOrganization} in
									<foreach item="item" collection="jgidList" open="(" separator="," close=")">
										#{item.jgid,jdbcType=VARCHAR}
									</foreach>
								</if>
							</where>
						)
						and t1.${zy_rc.dimSfwz} = '1'
						<if test='date != null'>
							and t1.${zy_rc.dimTime} = #{date,jdbcType=VARCHAR}
						</if>
						<if test="size != 0">
							and t1.${zy_rc.dimOrganization} in
							<foreach item="item" collection="jgidList" open="(" separator="," close=")">
								#{item.jgid,jdbcType=VARCHAR}
							</foreach>
						</if>
						group by t2.code, t2.text,t2.dimorder
						union
						select 0 beHos,0 leaveHos,0 inHos,0 critical,sum(t1.${kf_bcs.indbName_value}) ratedBed,
						t2.code deptid,t2.text deptname,t2.dimorder dimorder
						from ${kf_bcs.indbName_value} t1, ${kf_bcs.dimDept} t2
						where t1.${kf_bcs.dimDept} = t2.code
						and t1.${kf_bcs.dimMonth} =
						(select
							max(${kf_bcs.dimMonth}) from ${kf_bcs.indbName_value}
							<where>
								<if test="size != 0">
									${kf_bcs.dimOrganization} in
									<foreach item="item" collection="jgidList" open="(" separator="," close=")">
										#{item.jgid,jdbcType=VARCHAR}
									</foreach>
								</if>
							</where>
						)
						<if test="size != 0">
							and t1.${kf_bcs.dimOrganization} in
							<foreach item="item" collection="jgidList" open="(" separator="," close=")">
								#{item.jgid,jdbcType=VARCHAR}
							</foreach>
						</if>
						group by t2.code, t2.text,t2.dimorder
				)
				group by deptid,deptname,dimorder order by dimorder
		)
		 where ratedBed > 0 order by dimorder
	</select>

	<!-- 材料支出 -->
	<select id="getClzcByMonth" resultType="hashmap" parameterType="hashmap">
		SELECT SUM (t.${cl_zc.indbName_value}) AS clzc,t.${cl_zc.dimMonth} AS ny
		FROM ${cl_zc.indbName_value} t
		where t.${cl_zc.dimOrganization} in
		<foreach item="item" collection="jgidList" open="(" separator="," close=")">
			#{item.jgid,jdbcType=VARCHAR}
		</foreach>
		and t.${cl_zc.dimMonth} in
		<foreach item="item" collection="last12Months" index="index" open="(" separator="," close=")">
			#{item}
		</foreach>
		GROUP BY t.${cl_zc.dimMonth}
		ORDER BY t.${cl_zc.dimMonth} DESC
	</select>

	<!-- 管理费用 -->
	<select id="getGlfyByMonth" resultType="hashmap" parameterType="hashmap">
		SELECT SUM (t.${gl_fy.indbName_value}) AS GLFY,t.${gl_fy.dimMonth} AS ny
		FROM ${gl_fy.indbName_value} t
		where t.${gl_fy.dimOrganization} in
		<foreach item="item" collection="jgidList" open="(" separator="," close=")">
			#{item.jgid,jdbcType=VARCHAR}
		</foreach>
		and t.${gl_fy.dimMonth} in
		<foreach item="item" collection="last12Months" index="index" open="(" separator="," close=")">
			#{item}
		</foreach>
		GROUP BY t.${gl_fy.dimMonth}
		ORDER BY t.${gl_fy.dimMonth} DESC
	</select>

	<!-- 门诊收入 -->
	<select id="getMzsrByMonth" resultType="hashmap" parameterType="hashmap">
		SELECT SUM (t.${mz_sr.indbName_value}) AS MZSR,t.${mz_sr.dimMonth} AS ny
		FROM ${mz_sr.indbName_value} t
		where t.${mz_sr.dimOrganization} in
		<foreach item="item" collection="jgidList" open="(" separator="," close=")">
			#{item.jgid,jdbcType=VARCHAR}
		</foreach>
		and t.${mz_sr.dimMonth} in
		<foreach item="item" collection="last12Months" index="index" open="(" separator="," close=")">
			#{item}
		</foreach>
		GROUP BY t.${mz_sr.dimMonth}
		ORDER BY t.${mz_sr.dimMonth} DESC
	</select>

	<!-- 住院收入 -->
	<select id="getZysrByMonth" resultType="hashmap" parameterType="hashmap">
		SELECT SUM (t.${zy_sr.indbName_value}) AS ZYSR,t.${zy_sr.dimMonth} AS ny
		FROM ${zy_sr.indbName_value} t
		where t.${zy_sr.dimOrganization} in
		<foreach item="item" collection="jgidList" open="(" separator="," close=")">
			#{item.jgid,jdbcType=VARCHAR}
		</foreach>
		and t.${zy_sr.dimMonth} in
		<foreach item="item" collection="last12Months" index="index" open="(" separator="," close=")">
			#{item}
		</foreach>
		GROUP BY t.${zy_sr.dimMonth}
		ORDER BY t.${zy_sr.dimMonth} DESC
	</select>

	<!-- 药品 -->
	<select id="getYpByMonth" resultType="hashmap" parameterType="hashmap">
		SELECT SUM (t.${yp_xf.indbName_value}) AS YP,t.${yp_xf.dimMonth} AS ny
		FROM ${yp_xf.indbName_value} t
		where t.${yp_xf.dimOrganization} in
		<foreach item="item" collection="jgidList" open="(" separator="," close=")">
			#{item.jgid,jdbcType=VARCHAR}
		</foreach>
		and t.${yp_xf.dimMonth} in
		<foreach item="item" collection="last12Months" index="index" open="(" separator="," close=")">
			#{item}
		</foreach>
		GROUP BY t.${yp_xf.dimMonth}
		ORDER BY t.${yp_xf.dimMonth} DESC
	</select>

	<!-- 住院药品 -->
	<select id="getZyypByMonth" resultType="hashmap" parameterType="hashmap">
		SELECT SUM (t.${zyyp_xf.indbName_value}) AS ZYYP,t.${zyyp_xf.dimMonth} AS ny
		FROM ${zyyp_xf.indbName_value} t
		where t.${zyyp_xf.dimOrganization} in
		<foreach item="item" collection="jgidList" open="(" separator="," close=")">
			#{item.jgid,jdbcType=VARCHAR}
		</foreach>
		and t.${zyyp_xf.dimMonth} in
		<foreach item="item" collection="last12Months" index="index" open="(" separator="," close=")">
			#{item}
		</foreach>
		GROUP BY t.${zyyp_xf.dimMonth}
		ORDER BY t.${zyyp_xf.dimMonth} DESC
	</select>

	<!-- 每个科室的材料支出 -->
	<select id="getClzcByKs" resultType="hashmap" parameterType="hashmap">
		SELECT * FROM(
			SELECT SUM (A.${cl_zc.indbName_value}) AS clzc1,A.${cl_zc.dimThirdDept} AS ks1
			FROM(
				SELECT * FROM ${cl_zc.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='startDate != null'>
						and t1.${cl_zc.dimTime} >= #{startDate,jdbcType=VARCHAR}
					</if>
					<if test='endDate != null'>
						and t1.${cl_zc.dimTime} <![CDATA[ <= ]]>#{endDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${cl_zc.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yf != null'>
						and t1.${cl_zc.dimMonth} = #{yf,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${cl_zc.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) A
			GROUP BY A.${cl_zc.dimThirdDept}
		) AA
		FULL JOIN (
			SELECT SUM (A.${cl_zc.indbName_value}) AS clzc2,A.${cl_zc.dimThirdDept} AS ks2
			FROM(
				SELECT * FROM ${cl_zc.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='ringRatioStartDate != null'>
						and t1.${cl_zc.dimTime} >=#{ringRatioStartDate,jdbcType=VARCHAR}
					</if>
					<if test='ringRatioEndDate != null'>and
						t1.${cl_zc.dimTime} <![CDATA[ <= ]]>#{ringRatioEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${cl_zc.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='ringRatioMonth != null'>
						and t1.${cl_zc.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${cl_zc.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) A GROUP BY A.${cl_zc.dimThirdDept}
		) BB ON AA.ks1 = BB.ks2
		FULL JOIN (
			SELECT SUM (A.${cl_zc.indbName_value}) AS clzc3,A.${cl_zc.dimThirdDept} AS ks3
			FROM(
				SELECT * FROM ${cl_zc.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='yearOnYearStartDate != null'>
						and t1.${cl_zc.dimTime} >=#{yearOnYearStartDate,jdbcType=VARCHAR}
					</if>
					<if test='yearOnYearEndDate != null'>and
						t1.${cl_zc.dimTime} <![CDATA[ <= ]]>#{yearOnYearEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${cl_zc.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yearOnYearMonth != null'>
						and t1.${cl_zc.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${cl_zc.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) A GROUP BY A.${cl_zc.dimThirdDept}
		) CC ON AA.ks1 = CC.ks3
	</select>

	<!-- 每个科室的管理费用 -->
	<select id="getGlfyByKs" resultType="hashmap" parameterType="hashmap">
		SELECT * FROM(
			SELECT SUM (A.${gl_fy.indbName_value}) AS glfy1,A.${gl_fy.dimThirdDept} AS ks1
			FROM(
				SELECT * FROM ${gl_fy.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='startDate != null'>
						and t1.${gl_fy.dimTime} >= #{startDate,jdbcType=VARCHAR}
					</if>
					<if test='endDate != null'>
						and t1.${gl_fy.dimTime} <![CDATA[ <= ]]>#{endDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${gl_fy.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yf != null'>
						and t1.${gl_fy.dimMonth} = #{yf,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${gl_fy.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) A GROUP BY A.${gl_fy.dimThirdDept}
		) AA
		FULL JOIN (
			SELECT SUM (A.${gl_fy.indbName_value}) AS glfy2,A.${gl_fy.dimThirdDept} AS ks2
			FROM(
				SELECT * FROM ${gl_fy.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='ringRatioStartDate != null'>
						and t1.${gl_fy.dimTime} >=#{ringRatioStartDate,jdbcType=VARCHAR}
					</if>
					<if test='ringRatioEndDate != null'>
						and t1.${gl_fy.dimTime} <![CDATA[ <= ]]>#{ringRatioEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${gl_fy.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='ringRatioMonth != null'>
						and t1.${gl_fy.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${gl_fy.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) A
			GROUP BY A.${gl_fy.dimThirdDept}
		) BB ON AA.ks1 = BB.ks2
		FULL JOIN (
			SELECT SUM (A.${gl_fy.indbName_value}) AS glfy3,A.${gl_fy.dimThirdDept} AS ks3
			FROM(
				SELECT * FROM ${gl_fy.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='yearOnYearStartDate != null'>
						and t1.${gl_fy.dimTime} >=#{yearOnYearStartDate,jdbcType=VARCHAR}
					</if>
					<if test='yearOnYearEndDate != null'>
						and t1.${gl_fy.dimTime} <![CDATA[ <= ]]>#{yearOnYearEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${gl_fy.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yearOnYearMonth != null'>
						and t1.${gl_fy.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${gl_fy.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) A GROUP BY A.${gl_fy.dimThirdDept}
		) CC ON AA.ks1 = CC.ks3
	</select>

	<!-- 每个科室的门诊收入 -->
	<select id="getMzsrByKs" resultType="hashmap" parameterType="hashmap">
		SELECT *FROM(
			SELECT SUM (A.${mz_sr.indbName_value}) AS mzsr1,A.${mz_sr.dimThirdDept} AS ks1 FROM(
				SELECT * FROM ${mz_sr.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='startDate != null'>
						and t1.${mz_sr.dimTime} >= #{startDate,jdbcType=VARCHAR}
					</if>
					<if test='endDate != null'>
						and t1.${mz_sr.dimTime} <![CDATA[ <= ]]>#{endDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${mz_sr.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yf != null'>
						and t1.${mz_sr.dimMonth} = #{yf,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${mz_sr.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) A GROUP BY A.${mz_sr.dimThirdDept}
		) AA
		FULL JOIN (
			SELECT SUM (A.${mz_sr.indbName_value}) AS mzsr2,A.${mz_sr.dimThirdDept} AS ks2 FROM(
				SELECT * FROM ${mz_sr.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='ringRatioStartDate != null'>
						and t1.${mz_sr.dimTime} >=#{ringRatioStartDate,jdbcType=VARCHAR}
					</if>
					<if test='ringRatioEndDate != null'>
						and t1.${mz_sr.dimTime} <![CDATA[ <= ]]>#{ringRatioEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${mz_sr.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='ringRatioMonth != null'>
						and t1.${mz_sr.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${mz_sr.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) A GROUP BY A.${mz_sr.dimThirdDept}
		) BB ON AA.ks1 = BB.ks2
		FULL JOIN (
			SELECT SUM (A.${mz_sr.indbName_value}) AS mzsr3,A.${mz_sr.dimThirdDept} AS ks3 FROM(
				SELECT * FROM ${mz_sr.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='yearOnYearStartDate != null'>
						and t1.${mz_sr.dimTime} >=#{yearOnYearStartDate,jdbcType=VARCHAR}
					</if>
					<if test='yearOnYearEndDate != null'>
						and t1.${mz_sr.dimTime} <![CDATA[ <= ]]>#{yearOnYearEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${mz_sr.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yearOnYearMonth != null'>
						and t1.${mz_sr.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${mz_sr.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) A GROUP BY A.${mz_sr.dimThirdDept}
		) CC ON AA.ks1 = CC.ks3
	</select>

	<!-- 每个科室的住院收入 -->
	<select id="getZysrByKs" resultType="hashmap" parameterType="hashmap">
		SELECT * FROM(
			SELECT SUM (A.${zy_sr.indbName_value}) AS zysr1,A.${zy_sr.dimThirdDept} AS ks1 FROM(
				SELECT * FROM ${zy_sr.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='startDate != null'>
						and t1.${zy_sr.dimTime} >= #{startDate,jdbcType=VARCHAR}
					</if>
					<if test='endDate != null'>
						and t1.${zy_sr.dimTime} <![CDATA[ <= ]]>#{endDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${zy_sr.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yf != null'>
						and t1.${zy_sr.dimMonth} = #{yf,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${zy_sr.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) A GROUP BY A.${zy_sr.dimThirdDept}
		) AA
		FULL JOIN (
			SELECT SUM (A.${zy_sr.indbName_value}) AS zysr2,A.${zy_sr.dimThirdDept} AS ks2 FROM(
				SELECT * FROM ${zy_sr.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='ringRatioStartDate != null'>
						and t1.${zy_sr.dimTime} >=#{ringRatioStartDate,jdbcType=VARCHAR}
					</if>
					<if test='ringRatioEndDate != null'>
						and t1.${zy_sr.dimTime} <![CDATA[ <= ]]>#{ringRatioEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${zy_sr.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='ringRatioMonth != null'>
						and t1.${zy_sr.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${zy_sr.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) A GROUP BY A.${zy_sr.dimThirdDept}
		) BB ON AA.ks1 = BB.ks2
		FULL JOIN (
			SELECT SUM (A.${zy_sr.indbName_value}) AS zysr3,A.${zy_sr.dimThirdDept} AS ks3 FROM(
				SELECT * FROM ${zy_sr.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='yearOnYearStartDate != null'>
						and t1.${zy_sr.dimTime} >=#{yearOnYearStartDate,jdbcType=VARCHAR}
					</if>
					<if test='yearOnYearEndDate != null'>
						and t1.${zy_sr.dimTime} <![CDATA[ <= ]]>#{yearOnYearEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${zy_sr.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yearOnYearMonth != null'>
						and t1.${zy_sr.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${zy_sr.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) A GROUP BY A.${zy_sr.dimThirdDept}
		) CC ON AA.ks1 = CC.ks3
	</select>

	<!-- 每个科室的药品 -->
	<select id="getYpByKs" resultType="hashmap" parameterType="hashmap">
		SELECT * FROM(
			SELECT SUM (A.${yp_xf.indbName_value}) AS yp1,A.${yp_xf.dimThirdDept} AS ks1 FROM(
				SELECT * FROM ${yp_xf.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='startDate != null'>
						and t1.${yp_xf.dimTime} >= #{startDate,jdbcType=VARCHAR}
					</if>
					<if test='endDate != null'>
						and t1.${yp_xf.dimTime} <![CDATA[ <= ]]>#{endDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${yp_xf.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yf != null'>
						and t1.${yp_xf.dimMonth} = #{yf,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${yp_xf.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) A GROUP BY A.${yp_xf.dimThirdDept}
		) AA
		FULL JOIN (
			SELECT SUM (A.${yp_xf.indbName_value}) AS yp2,A.${yp_xf.dimThirdDept} AS ks2 FROM(
				SELECT * FROM ${yp_xf.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='ringRatioStartDate != null'>
						and t1.${yp_xf.dimTime} >=#{ringRatioStartDate,jdbcType=VARCHAR}
					</if>
					<if test='ringRatioEndDate != null'>
						and t1.${yp_xf.dimTime} <![CDATA[ <= ]]>#{ringRatioEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${yp_xf.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='ringRatioMonth != null'>
						and t1.${yp_xf.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${yp_xf.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) A GROUP BY A.${yp_xf.dimThirdDept}
		) BB ON AA.ks1 = BB.ks2
		FULL JOIN (
			SELECT SUM (A.${yp_xf.indbName_value}) AS yp3,A.${yp_xf.dimThirdDept} AS ks3 FROM(
				SELECT * FROM ${yp_xf.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='yearOnYearStartDate != null'>
						and t1.${yp_xf.dimTime} >=#{yearOnYearStartDate,jdbcType=VARCHAR}
					</if>
					<if test='yearOnYearEndDate != null'>
						and t1.${yp_xf.dimTime} <![CDATA[ <= ]]>#{yearOnYearEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${yp_xf.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yearOnYearMonth != null'>
						and t1.${yp_xf.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${yp_xf.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) A GROUP BY A.${yp_xf.dimThirdDept}
		) CC ON AA.ks1 = CC.ks3
	</select>

	<!-- 每个科室的住院药品 -->
	<select id="getZyypByKs" resultType="hashmap" parameterType="hashmap">
		SELECT * FROM(
			SELECT SUM (A.${zyyp_xf.indbName_value}) AS zyyp1,A.${zyyp_xf.dimThirdDept} AS ks1 FROM(
				SELECT * FROM ${zyyp_xf.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='startDate != null'>
						and t1.${zyyp_xf.dimTime} >= #{startDate,jdbcType=VARCHAR}
					</if>
					<if test='endDate != null'>
						and t1.${zyyp_xf.dimTime} <![CDATA[ <= ]]>#{endDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${zyyp_xf.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yf != null'>
						and t1.${zyyp_xf.dimMonth} = #{yf,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${zyyp_xf.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) A GROUP BY A.${zyyp_xf.dimThirdDept}
		) AA
		FULL JOIN (
			SELECT SUM (A.${zyyp_xf.indbName_value}) AS zyyp2, A.${zyyp_xf.dimThirdDept} AS ks2 FROM (
				SELECT * FROM ${zyyp_xf.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='ringRatioStartDate != null'>
						and t1.${zyyp_xf.dimTime} >=#{ringRatioStartDate,jdbcType=VARCHAR}
					</if>
					<if test='ringRatioEndDate != null'>
						and t1.${zyyp_xf.dimTime} <![CDATA[ <= ]]>#{ringRatioEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${zyyp_xf.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='ringRatioMonth != null'>
						and t1.${zyyp_xf.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${zyyp_xf.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) A GROUP BY A.${zyyp_xf.dimThirdDept}
		) BB ON AA.ks1 = BB.ks2
		FULL JOIN (
			SELECT SUM (A.${zyyp_xf.indbName_value}) AS zyyp3, A.${zyyp_xf.dimThirdDept} AS ks3 FROM (
				SELECT * FROM ${zyyp_xf.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='yearOnYearStartDate != null'>
						and t1.${zyyp_xf.dimTime} >=#{yearOnYearStartDate,jdbcType=VARCHAR}
					</if>
					<if test='yearOnYearEndDate != null'>
						and t1.${zyyp_xf.dimTime} <![CDATA[ <= ]]>#{yearOnYearEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${zyyp_xf.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yearOnYearMonth != null'>
						and t1.${zyyp_xf.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${zyyp_xf.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) A GROUP BY A.${zyyp_xf.dimThirdDept}
		) CC ON AA.ks1 = CC.ks3
	</select>

	<!-- 查询一共有多少科室 -->
	<select id="getAllKs" resultType="hashmap" parameterType="hashmap">
		SELECT DISTINCT(A.DIM0000773) AS KS,a.dimorder FROM(
			SELECT DISTINCT(${cl_zc.dimThirdDept}) DIM0000773,t2.dimorder dimorder 
			from ${cl_zc.indbName_value} t1, ${cl_zc.dimThirdDept} t2 where t1.${cl_zc.dimThirdDept} = t2.code
			UNION ALL
			SELECT DISTINCT(${gl_fy.dimThirdDept}) DIM0000773,t2.dimorder dimorder 
			from ${gl_fy.indbName_value} t1, ${gl_fy.dimThirdDept} t2 where t1.${gl_fy.dimThirdDept} = t2.code
			UNION ALL
			SELECT DISTINCT(${mz_sr.dimThirdDept}) DIM0000773,t2.dimorder dimorder
			from ${mz_sr.indbName_value} t1, ${mz_sr.dimThirdDept} t2 where t1.${mz_sr.dimThirdDept} = t2.code
			UNION ALL
			SELECT DISTINCT(${zy_sr.dimThirdDept}) DIM0000773,t2.dimorder dimorder
			from ${zy_sr.indbName_value} t1, ${zy_sr.dimThirdDept} t2 where t1.${zy_sr.dimThirdDept} = t2.code
			UNION ALL
			SELECT DISTINCT(${yp_xf.dimThirdDept}) DIM0000773,t2.dimorder dimorder
			from ${yp_xf.indbName_value} t1, ${yp_xf.dimThirdDept} t2 where t1.${yp_xf.dimThirdDept} = t2.code
			UNION ALL
			SELECT DISTINCT(${zyyp_xf.dimThirdDept}) DIM0000773,t2.dimorder dimorder
			from ${zyyp_xf.indbName_value} t1, ${zyyp_xf.dimThirdDept} t2 where t1.${zyyp_xf.dimThirdDept} = t2.code
		) A where 1= 1 order by A.dimorder
	</select>

	<!-- 科室代码与科室名称的对应关系map -->
	<select id="getKsMap" resultType="hashmap" parameterType="hashmap">
		SELECT CODE as key,TEXT as value from DIM0000773
	</select>

	<!-- 查询三个时间段内的六项费用 -->
	<select id="getQyfyList" resultType="hashmap" parameterType="hashmap">
		select * from(
			(
				select nvl(sum(t1.${cl_zc.indbName_value}),0) FY1 from ${cl_zc.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='startDate != null'>
						and t1.${cl_zc.dimTime} >= #{startDate,jdbcType=VARCHAR}
					</if>
					<if test='endDate != null'>
						and t1.${cl_zc.dimTime} <![CDATA[ <= ]]>#{endDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${cl_zc.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yf != null'>
						and t1.${cl_zc.dimMonth} = #{yf,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${cl_zc.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			)
			full join
			(
				select nvl(sum(t1.${cl_zc.indbName_value}),0) FY2 from ${cl_zc.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='ringRatioStartDate != null'>
						and t1.${cl_zc.dimTime} >=#{ringRatioStartDate,jdbcType=VARCHAR}
					</if>
					<if test='ringRatioEndDate != null'>and
						t1.${cl_zc.dimTime} <![CDATA[ <= ]]>#{ringRatioEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${cl_zc.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='ringRatioMonth != null'>
						and t1.${cl_zc.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${cl_zc.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) on 1=1
			full join
			(
				select nvl(sum(t1.${cl_zc.indbName_value}),0) FY3 from ${cl_zc.indbName_value}
				t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='yearOnYearStartDate != null'>
						and t1.${cl_zc.dimTime} >=#{yearOnYearStartDate,jdbcType=VARCHAR}
					</if>
					<if test='yearOnYearEndDate != null'>and
						t1.${cl_zc.dimTime} <![CDATA[ <= ]]>#{yearOnYearEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${cl_zc.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yearOnYearMonth != null'>
						and t1.${cl_zc.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${cl_zc.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) on 1=1
		)
		union all
		select * from(
			(
				select nvl(sum(t1.${gl_fy.indbName_value}),0) FY1 from ${gl_fy.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='startDate != null'>
						and t1.${gl_fy.dimTime} >= #{startDate,jdbcType=VARCHAR}
					</if>
					<if test='endDate != null'>
						and t1.${gl_fy.dimTime} <![CDATA[ <= ]]>#{endDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${gl_fy.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yf != null'>
						and t1.${gl_fy.dimMonth} = #{yf,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${gl_fy.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			)
			full join
			(
				select nvl(sum(t1.${gl_fy.indbName_value}),0) FY2 from ${gl_fy.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='ringRatioStartDate != null'>
						and t1.${gl_fy.dimTime} >=#{ringRatioStartDate,jdbcType=VARCHAR}
					</if>
					<if test='ringRatioEndDate != null'>and
						t1.${gl_fy.dimTime} <![CDATA[ <= ]]>#{ringRatioEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${gl_fy.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='ringRatioMonth != null'>
						and t1.${gl_fy.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${gl_fy.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) on 1=1
			full join
			(
				select nvl(sum(t1.${gl_fy.indbName_value}),0) FY3 from ${gl_fy.indbName_value}
				t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='yearOnYearStartDate != null'>
						and t1.${gl_fy.dimTime} >=#{yearOnYearStartDate,jdbcType=VARCHAR}
					</if>
					<if test='yearOnYearEndDate != null'>and
						t1.${gl_fy.dimTime} <![CDATA[ <= ]]>#{yearOnYearEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${gl_fy.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yearOnYearMonth != null'>
						and t1.${gl_fy.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${gl_fy.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) on 1=1
		)
		union all
		select * from(
			(
				select nvl(sum(t1.${zy_sr.indbName_value}),0) FY1 from ${zy_sr.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='startDate != null'>
						and t1.${zy_sr.dimTime} >= #{startDate,jdbcType=VARCHAR}
					</if>
					<if test='endDate != null'>
						and t1.${zy_sr.dimTime} <![CDATA[ <= ]]>#{endDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${zy_sr.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yf != null'>
						and t1.${zy_sr.dimMonth} = #{yf,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${zy_sr.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			)
			full join
			(
				select nvl(sum(t1.${zy_sr.indbName_value}),0) FY2 from ${zy_sr.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='ringRatioStartDate != null'>
						and t1.${zy_sr.dimTime} >=#{ringRatioStartDate,jdbcType=VARCHAR}
					</if>
					<if test='ringRatioEndDate != null'>and
						t1.${zy_sr.dimTime} <![CDATA[ <= ]]>#{ringRatioEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${zy_sr.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='ringRatioMonth != null'>
						and t1.${zy_sr.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${zy_sr.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) on 1=1
			full join
			(
				select nvl(sum(t1.${zy_sr.indbName_value}),0) FY3 from ${zy_sr.indbName_value}
				t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='yearOnYearStartDate != null'>
						and t1.${zy_sr.dimTime} >=#{yearOnYearStartDate,jdbcType=VARCHAR}
					</if>
					<if test='yearOnYearEndDate != null'>and
						t1.${zy_sr.dimTime} <![CDATA[ <= ]]>#{yearOnYearEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${zy_sr.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yearOnYearMonth != null'>
						and t1.${zy_sr.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${zy_sr.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) on 1=1
		)
		union all
		select * from(
			(
				select nvl(sum(t1.${mz_sr.indbName_value}),0) FY1 from ${mz_sr.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='startDate != null'>
						and t1.${mz_sr.dimTime} >= #{startDate,jdbcType=VARCHAR}
					</if>
					<if test='endDate != null'>
						and t1.${mz_sr.dimTime} <![CDATA[ <= ]]>#{endDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${mz_sr.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yf != null'>
						and t1.${mz_sr.dimMonth} = #{yf,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${mz_sr.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			)
			full join
			(
				select nvl(sum(t1.${mz_sr.indbName_value}),0) FY2 from ${mz_sr.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='ringRatioStartDate != null'>
						and t1.${mz_sr.dimTime} >=#{ringRatioStartDate,jdbcType=VARCHAR}
					</if>
					<if test='ringRatioEndDate != null'>and
						t1.${mz_sr.dimTime} <![CDATA[ <= ]]>#{ringRatioEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${mz_sr.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='ringRatioMonth != null'>
						and t1.${mz_sr.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${mz_sr.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				) on 1=1
			full join
			(
				select nvl(sum(t1.${mz_sr.indbName_value}),0) FY3 from ${mz_sr.indbName_value}
				t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='yearOnYearStartDate != null'>
						and t1.${mz_sr.dimTime} >=#{yearOnYearStartDate,jdbcType=VARCHAR}
					</if>
					<if test='yearOnYearEndDate != null'>and
						t1.${mz_sr.dimTime} <![CDATA[ <= ]]>#{yearOnYearEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${mz_sr.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yearOnYearMonth != null'>
						and t1.${mz_sr.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${mz_sr.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) on 1=1
		)
		union all
		select * from(
			(
				select nvl(sum(t1.${yp_xf.indbName_value}),0) FY1 from ${yp_xf.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='startDate != null'>
						and t1.${yp_xf.dimTime} >= #{startDate,jdbcType=VARCHAR}
					</if>
					<if test='endDate != null'>
						and t1.${yp_xf.dimTime} <![CDATA[ <= ]]>#{endDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${yp_xf.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yf != null'>
						and t1.${yp_xf.dimMonth} = #{yf,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${yp_xf.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			)
			full join
			(
				select nvl(sum(t1.${yp_xf.indbName_value}),0) FY2 from ${yp_xf.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='ringRatioStartDate != null'>
						and t1.${yp_xf.dimTime} >=#{ringRatioStartDate,jdbcType=VARCHAR}
					</if>
					<if test='ringRatioEndDate != null'>and
						t1.${yp_xf.dimTime} <![CDATA[ <= ]]>#{ringRatioEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${yp_xf.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='ringRatioMonth != null'>
						and t1.${yp_xf.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${yp_xf.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) on 1=1
			full join
			(
				select nvl(sum(t1.${yp_xf.indbName_value}),0) FY3 from ${yp_xf.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='yearOnYearStartDate != null'>
						and t1.${yp_xf.dimTime} >=#{yearOnYearStartDate,jdbcType=VARCHAR}
					</if>
					<if test='yearOnYearEndDate != null'>and
						t1.${yp_xf.dimTime} <![CDATA[ <= ]]>#{yearOnYearEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${yp_xf.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yearOnYearMonth != null'>
						and t1.${yp_xf.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${yp_xf.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) on 1=1
		)
		union all
		select * from(
			(
				select nvl(sum(t1.${zyyp_xf.indbName_value}),0) FY1 from ${zyyp_xf.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='startDate != null'>
						and t1.${zyyp_xf.dimTime} >= #{startDate,jdbcType=VARCHAR}
					</if>
					<if test='endDate != null'>
						and t1.${zyyp_xf.dimTime} <![CDATA[ <= ]]>#{endDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${zyyp_xf.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yf != null'>
						and t1.${zyyp_xf.dimMonth} = #{yf,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${zyyp_xf.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			)
			full join
			(
				select nvl(sum(t1.${zyyp_xf.indbName_value}),0) FY2 from ${zyyp_xf.indbName_value} t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='ringRatioStartDate != null'>
						and t1.${zyyp_xf.dimTime} >=#{ringRatioStartDate,jdbcType=VARCHAR}
					</if>
					<if test='ringRatioEndDate != null'>and
						t1.${zyyp_xf.dimTime} <![CDATA[ <= ]]>#{ringRatioEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${zyyp_xf.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='ringRatioMonth != null'>
						and t1.${zyyp_xf.dimMonth} = #{ringRatioMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${zyyp_xf.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) on 1=1
			full join
			(
				select nvl(sum(t1.${zyyp_xf.indbName_value}),0) FY3 from ${zyyp_xf.indbName_value}
				t1
				WHERE 1=1
				<if test=" aycx == null or (aycx != null and aycx !=1 )">
					<if test='yearOnYearStartDate != null'>
						and t1.${zyyp_xf.dimTime} >=#{yearOnYearStartDate,jdbcType=VARCHAR}
					</if>
					<if test='yearOnYearEndDate != null'>and
						t1.${zyyp_xf.dimTime} <![CDATA[ <= ]]>#{yearOnYearEndDate,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${zyyp_xf.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
				<if test=" aycx != null and aycx ==1 ">
					<if test='yearOnYearMonth != null'>
						and t1.${zyyp_xf.dimMonth} = #{yearOnYearMonth,jdbcType=VARCHAR}
					</if>
					<if test="size != 0">
						and t1.${zyyp_xf.dimOrganization} in
						<foreach item="item" collection="jgidList" open="(" separator="," close=")">
							#{item.jgid,jdbcType=VARCHAR}
						</foreach>
					</if>
				</if>
			) on 1=1
		)
	</select>
	
	
	<!-- 统计查询  门诊均次 下钻到医生 -->
	<select id="getAverageCostByDoctorAndMz" resultType="hashmap" parameterType="hashmap">
		select code,
		text,	 
		dimorder,
		round(sum(zfy),4) as jcfy,
		case when sum(zfy2) <![CDATA[ <> ]]>
		0 then round((sum(zfy) - sum(zfy2)) / sum(zfy2), 4) else 0 end as
		yearOnYear,
		case when sum(zfy3) <![CDATA[ <> ]]>
		0 then round((sum(zfy) - sum(zfy3)) / sum(zfy3), 4) else 0 end as
		ringRatio
		from ( select
		code,
		text,
		dimorder,
		case when flag = 1 then sum(zfy) else 0 end zfy,
		case when flag = 2 then sum(zfy) else 0 end zfy2,
		case when flag = 3
		then sum(zfy) else 0 end zfy3
		from (
			SELECT a.code,a.text ,a.dimorder,decode(nvl(b,0),0,0,a/b) as zfy,1 as flag FROM
			(select code,text,dimorder,
				<choose>
			        <when test="CWorYW=='CW'">
			           sum(${cw_mzxx.indbName_value})  as a 
			        </when>
			        <when test="CWorYW=='YW'">
			           sum(${yw_mzxx.indbName_value})  as a 
			        </when>
		    	</choose>
			
			from 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_mzxx.indbName_value}  t1
		        </when>
		        <when test="CWorYW=='YW'">
		            ${yw_mzxx.indbName_value}  t1
		        </when>
		    </choose>
			LEFT JOIN 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_mzxx.dimDoctor} t4
		        </when>
		         <when test="CWorYW=='YW'">
		           ${yw_mzxx.dimDoctor} t4
		        </when>
		    </choose>
			 on 
			 <choose>
		        <when test="CWorYW=='CW'">
		           t1.${cw_mzxx.dimDoctor} = t4.code
		        </when>
		        <when test="CWorYW=='YW'">
		           t1.${yw_mzxx.dimDoctor} = t4.code
		        </when>
		    </choose>
			where 1 = 1 
			<choose>
		        <when test="CWorYW=='CW'">
		          <include refid="sql_where_doctor_code_FY_CW" />
		        </when>
		        <when test="CWorYW=='YW'">
		           <include refid="sql_where_doctor_code_FY" />
		        </when>
		    </choose>
<!-- 			 and t1.#{yw_mzxx.dimDept} = #{code,jdbcType=VARCHAR} -->
			<choose>
				<when
					test='aycx != null and aycx ==1'>
					<include refid="sql_nowMonth_where2_FY" />
				</when>
				<when
					test='aycx == null or (aycx != null and aycx !=1 )'>
					<include refid="sql_now_where2_FY" />
				</when>
			</choose>
			GROUP BY code,text,dimorder ORDER BY dimorder) a 
			left	 JOIN
			(	
				select
				code,text,
				dimorder,
			    sum(${mz_jzrc.indbName_value})  as b 
				from 
			           ${mz_jzrc.indbName_value} t1
				LEFT JOIN 
			           ${mz_jzrc.dimDoctor} t4
				 on 
			           t1.${mz_jzrc.dimDoctor} = t4.code
				where 1 = 1 
				<include refid="sql_where_doctor_code_RC" /> 
<!-- 				and t1.dim0000584 = #{code,jdbcType=VARCHAR} -->
				<choose>
					<when
						test='aycx != null and aycx ==1'>
						<include refid="sql_nowMonth_where2_RC" />
					</when>
					<when
						test='aycx == null or (aycx != null and aycx !=1 )'>
						<include refid="sql_now_where2_RC" />
					</when>
				</choose>
				GROUP BY code,text ,dimorder 
				ORDER BY dimorder
			) b on a.code = b.code
			
		<!-- 同比 -->
		union
		
		SELECT a.code,a.text ,a.dimorder,decode(nvl(b,0),0,0,a/b) as zfy,2 as flag FROM
			(select code,text,dimorder,
				<choose>
			        <when test="CWorYW=='CW'">
			           sum(${cw_mzxx.indbName_value})  as a 
			        </when>
			        <when test="CWorYW=='YW'">
			           sum(${yw_mzxx.indbName_value})  as a 
			        </when>
		    	</choose>
			
			from 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_mzxx.indbName_value}  t1
		        </when>
		        <when test="CWorYW=='YW'">
		           ${yw_mzxx.indbName_value}  t1
		        </when>
		    </choose>
			LEFT JOIN 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_mzxx.dimDoctor} t4
		        </when>
		         <when test="CWorYW=='YW'">
		           ${yw_mzxx.dimDoctor} t4
		        </when>
		    </choose>
			 on 
			 <choose>
		        <when test="CWorYW=='CW'">
		           t1.${cw_mzxx.dimDoctor} = t4.code
		        </when>
		        <when test="CWorYW=='YW'">
		           t1.${yw_mzxx.dimDoctor} = t4.code
		        </when>
		    </choose>
			where 1 = 1 
			<choose>
		        <when test="CWorYW=='CW'">
		          <include refid="sql_where_doctor_code_FY_CW" />
		        </when>
		        <when test="CWorYW=='YW'">
		           <include refid="sql_where_doctor_code_FY" />
		        </when>
		    </choose>
<!-- 			and t1.dim0000584 = #{code,jdbcType=VARCHAR} -->
			<choose>
				<when
					test='aycx != null and aycx ==1'>
					<include refid="sql_yearOnYearMonth_where2_FY" />
				</when>
				<when
					test='aycx == null or (aycx != null and aycx !=1 )'>
					<include refid="sql_yearOnYear_where2_FY" />
				</when>
			</choose>
			GROUP BY code,text,dimorder ORDER BY dimorder) a 
			left	 JOIN
			(	
				select
				code,text,
				dimorder,
			    sum(${mz_jzrc.indbName_value})  as b 
				from 
			           ${mz_jzrc.indbName_value} t1
				LEFT JOIN 
			           ${mz_jzrc.dimDoctor} t4
				 on 
			           t1.${mz_jzrc.dimDoctor} = t4.code
				where 1 = 1 
				<include refid="sql_where_doctor_code_RC" /> 
<!-- 				and t1.dim0000584 = #{code,jdbcType=VARCHAR} -->
			<choose>
				<when
					test='aycx != null and aycx ==1'>
					<include refid="sql_yearOnYearMonth_where2_RC" />
				</when>
				<when
					test='aycx == null or (aycx != null and aycx !=1 )'>
					<include refid="sql_yearOnYear_where2_RC" />
				</when>
			</choose>
			GROUP BY code,text ,dimorder 
			ORDER BY dimorder) b on a.code = b.code
		
		<!-- 环比 -->
		union
		
		SELECT a.code,a.text ,a.dimorder,decode(nvl(b,0),0,0,a/b) as zfy,3 as flag FROM
			(select code,text,dimorder,
				<choose>
			        <when test="CWorYW=='CW'">
			           sum(${cw_mzxx.indbName_value})  as a 
			        </when>
			        <when test="CWorYW=='YW'">
			           sum(${yw_mzxx.indbName_value})  as a 
			        </when>
		    	</choose>
			
			from 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_mzxx.indbName_value}  t1
		        </when>
		        <when test="CWorYW=='YW'">
		           ${yw_mzxx.indbName_value}  t1
		        </when>
		    </choose>
			LEFT JOIN 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_mzxx.dimDoctor} t4
		        </when>
		         <when test="CWorYW=='YW'">
		           ${yw_mzxx.dimDoctor} t4
		        </when>
		    </choose>
			 on 
			 <choose>
		        <when test="CWorYW=='CW'">
		           t1.${cw_mzxx.dimDoctor} = t4.code
		        </when>
		        <when test="CWorYW=='YW'">
		           t1.${yw_mzxx.dimDoctor} = t4.code
		        </when>
		    </choose>
			where 1 = 1 
			<choose>
		        <when test="CWorYW=='CW'">
		          <include refid="sql_where_doctor_code_FY_CW" />
		        </when>
		        <when test="CWorYW=='YW'">
		           <include refid="sql_where_doctor_code_FY" />
		        </when>
		    </choose>
			<choose>
				<when
					test='aycx != null and aycx ==1'>
					<include refid="sql_ringRatioMonth_where2_FY" />
				</when>
				<when
					test='aycx == null or (aycx != null and aycx !=1 )'>
					<include refid="sql_ringRatio_where2_FY" />
				</when>
			</choose>
			GROUP BY code,text,dimorder ORDER BY dimorder) a 
			left	 JOIN
			(	
				select
				code,text,
				dimorder,
			    sum(${mz_jzrc.indbName_value})  as b 
				from 
			           ${mz_jzrc.indbName_value} t1
				LEFT JOIN 
			           ${mz_jzrc.dimDoctor} t4
				 on 
			           t1.${mz_jzrc.dimDoctor} = t4.code
			where 1 = 1 
			<include refid="sql_where_doctor_code_RC" /> 
			<choose>
			<when
				test='aycx != null and aycx ==1'>
				<include refid="sql_ringRatioMonth_where2_RC" />
			</when>
			<when
				test='aycx == null or (aycx != null and aycx !=1 )'>
				<include refid="sql_ringRatio_where2_RC" />
			</when>
		</choose>
			GROUP BY code,text ,dimorder 
			ORDER BY dimorder) b on a.code = b.code
		
			) 
			<!-- TODO -->
			<include refid="sql_where_doctorCodes" />
			GROUP BY code,text,flag,dimorder)GROUP BY code,text,dimorder ORDER BY dimorder
		
	</select>
	
	
	
	<!-- 统计查询  住院均次费  下钻到医生-->
	<select id="getAverageCostByDoctorAndZy" resultType="hashmap" parameterType="hashmap">
		select code,
		text,	 
		dimorder,
		round(sum(zfy),4) as jcfy,
		case when sum(zfy2) <![CDATA[ <> ]]>
		0 then round((sum(zfy) - sum(zfy2)) / sum(zfy2), 4) else 0 end as
		yearOnYear,
		case when sum(zfy3) <![CDATA[ <> ]]>
		0 then round((sum(zfy) - sum(zfy3)) / sum(zfy3), 4) else 0 end as
		ringRatio
		from ( select
		code,
		text,
		dimorder,
		case when flag = 1 then sum(zfy) else 0 end zfy,
		case when flag = 2 then sum(zfy) else 0 end zfy2,
		case when flag = 3
		then sum(zfy) else 0 end zfy3
		from (
			SELECT a.code,a.text ,a.dimorder,decode(nvl(b,0),0,0,a/b) as zfy,1 as flag FROM
			(select code,text,dimorder,
				<choose>
			        <when test="CWorYW=='CW'">
			           sum(${cw_zyxx.indbName_value})  as a 
			        </when>
			        <when test="CWorYW=='YW'">
			           sum(${yw_zyxx.indbName_value})  as a 
			        </when>
		    	</choose>
			
			from 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_zyxx.indbName_value}  t1
		        </when>
		        <when test="CWorYW=='YW'">
		            ${yw_zyxx.indbName_value}  t1
		        </when>
		    </choose>
		<!--	LEFT JOIN 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_zyxx.dimDoctor} t4
		        </when>
		         <when test="CWorYW=='YW'">
		           ${yw_zyxx.dimDoctor} t4
		        </when>
		    </choose>
			 on 
			 <choose>
		        <when test="CWorYW=='CW'">
		           t1.${cw_zyxx.dimDoctor} = t4.code
		        </when>
		        <when test="CWorYW=='YW'">
		           t1.${yw_zyxx.dimDoctor} = t4.code
		        </when>
		    </choose>-->
			where 1 = 1 
			<choose>
		        <when test="CWorYW=='CW'">
		          <include refid="sql_where_doctor_code_FY_CW" />
		        </when>
		        <when test="CWorYW=='YW'">
		           <include refid="sql_where_doctor_code_FY" />
		        </when>
		    </choose>
			<choose>
				<when
					test='aycx != null and aycx ==1'>
					<include refid="sql_nowMonth_where2_FY" />
				</when>
				<when
					test='aycx == null or (aycx != null and aycx !=1 )'>
					<include refid="sql_now_where2_FY" />
				</when>
			</choose>
			GROUP BY code,text,dimorder ORDER BY dimorder) a 
			left	 JOIN
			(	
				select
				code,text,
				dimorder,
			    sum(${zy_jzrc.indbName_value})  as b 
				from 
			           ${zy_jzrc.indbName_value} t1
				LEFT JOIN 
			           ${zy_jzrc.dimDoctor} t4
				 on 
			           t1.${zy_jzrc.dimDoctor} = t4.code
				where 1 = 1 <include refid="sql_where_doctor_code_RC" /> 
				<choose>
					<when
						test='aycx != null and aycx ==1'>
						<include refid="sql_nowMonth_where2_RC" />
					</when>
					<when
						test='aycx == null or (aycx != null and aycx !=1 )'>
						<include refid="sql_now_where2_RC" />
					</when>
				</choose>
				GROUP BY code,text ,dimorder 
				ORDER BY dimorder
			) b on a.code = b.code
			
		<!-- 同比 -->
		union
		
		SELECT a.code,a.text ,a.dimorder,decode(nvl(b,0),0,0,a/b) as zfy,2 as flag FROM
			(select code,text,dimorder,
				<choose>
			        <when test="CWorYW=='CW'">
			           sum(${cw_zyxx.indbName_value})  as a 
			        </when>
			        <when test="CWorYW=='YW'">
			           sum(${yw_zyxx.indbName_value})  as a 
			        </when>
		    	</choose>
			
			from 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_zyxx.indbName_value}  t1
		        </when>
		        <when test="CWorYW=='YW'">
		           ${yw_zyxx.indbName_value}  t1
		        </when>
		    </choose>
			<!-- LEFT JOIN 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_zyxx.dimDoctor} t4
		        </when>
		         <when test="CWorYW=='YW'">
		           ${yw_zyxx.dimDoctor} t4
		        </when>
		    </choose>
			 on 
			 <choose>
		        <when test="CWorYW=='CW'">
		           t1.${cw_zyxx.dimDoctor} = t4.code
		        </when>
		        <when test="CWorYW=='YW'">
		           t1.${yw_zyxx.dimDoctor} = t4.code
		        </when>
		    </choose>
			-->
			where 1 = 1 
			<choose>
		        <when test="CWorYW=='CW'">
		          <include refid="sql_where_doctor_code_FY_CW" />
		        </when>
		        <when test="CWorYW=='YW'">
		           <include refid="sql_where_doctor_code_FY" />
		        </when>
		    </choose>
			<choose>
				<when
					test='aycx != null and aycx ==1'>
					<include refid="sql_yearOnYearMonth_where2_FY" />
				</when>
				<when
					test='aycx == null or (aycx != null and aycx !=1 )'>
					<include refid="sql_yearOnYear_where2_FY" />
				</when>
			</choose>
			GROUP BY code,text,dimorder ORDER BY dimorder) a 
			left	 JOIN
			(	
				select
				code,text,
				dimorder,
			    sum(${zy_jzrc.indbName_value})  as b 
				from 
			           ${zy_jzrc.indbName_value} t1
				LEFT JOIN 
			           ${zy_jzrc.dimDoctor} t4
				 on 
			           t1.${zy_jzrc.dimDoctor} = t4.code
				where 1 = 1 <include refid="sql_where_doctor_code_RC" /> 
			<choose>
				<when
					test='aycx != null and aycx ==1'>
					<include refid="sql_yearOnYearMonth_where2_RC" />
				</when>
				<when
					test='aycx == null or (aycx != null and aycx !=1 )'>
					<include refid="sql_yearOnYear_where2_RC" />
				</when>
			</choose>
			GROUP BY code,text ,dimorder 
			ORDER BY dimorder) b on a.code = b.code
		
		<!-- 环比 -->
		union
		
		SELECT a.code,a.text ,a.dimorder,decode(nvl(b,0),0,0,a/b) as zfy,3 as flag FROM
			(select code,text,dimorder,
				<choose>
			        <when test="CWorYW=='CW'">
			           sum(${cw_zyxx.indbName_value})  as a 
			        </when>
			        <when test="CWorYW=='YW'">
			           sum(${yw_zyxx.indbName_value})  as a 
			        </when>
		    	</choose>
			
			from 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_zyxx.indbName_value}  t1
		        </when>
		        <when test="CWorYW=='YW'">
		           ${yw_zyxx.indbName_value}  t1
		        </when>
		    </choose>
		<!--	LEFT JOIN 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_zyxx.dimDoctor} t4
		        </when>
		         <when test="CWorYW=='YW'">
		           ${yw_zyxx.dimDoctor} t4
		        </when>
		    </choose>
			 on 
			 <choose>
		        <when test="CWorYW=='CW'">
		           t1.${cw_zyxx.dimDoctor} = t4.code
		        </when>
		        <when test="CWorYW=='YW'">
		           t1.${yw_zyxx.dimDoctor} = t4.code
		        </when>
		    </choose>
			-->
			where 1 = 1 
			<choose>
		        <when test="CWorYW=='CW'">
		          <include refid="sql_where_doctor_code_FY_CW" />
		        </when>
		        <when test="CWorYW=='YW'">
		           <include refid="sql_where_doctor_code_FY" />
		        </when>
		    </choose>
			<choose>
				<when
					test='aycx != null and aycx ==1'>
					<include refid="sql_ringRatioMonth_where2_FY" />
				</when>
				<when
					test='aycx == null or (aycx != null and aycx !=1 )'>
					<include refid="sql_ringRatio_where2_FY" />
				</when>
			</choose>
			GROUP BY code,text,dimorder ORDER BY dimorder) a 
			left	 JOIN
			(	
				select
				code,text,
				dimorder,
			    sum(${zy_jzrc.indbName_value})  as b 
				from 
			           ${zy_jzrc.indbName_value} t1
				LEFT JOIN 
			           ${zy_jzrc.dimDoctor} t4
				 on 
			           t1.${zy_jzrc.dimDoctor} = t4.code
			where 1 = 1 <include refid="sql_where_doctor_code_RC" /> 
			<choose>
			<when
				test='aycx != null and aycx ==1'>
				<include refid="sql_ringRatioMonth_where2_RC" />
			</when>
			<when
				test='aycx == null or (aycx != null and aycx !=1 )'>
				<include refid="sql_ringRatio_where2_RC" />
			</when>
		</choose>
			GROUP BY code,text ,dimorder 
			ORDER BY dimorder) b on a.code = b.code
		
			) 
			<!-- TODO -->
			<include refid="sql_where_doctorCodes" />
			GROUP BY code,text,flag,dimorder)GROUP BY code,text,dimorder ORDER BY dimorder
		
	</select>
	
	
	<!-- 统计查询  手术均次 下钻到医生 -->
	<select id="getAverageCostByDoctorAndSs" resultType="hashmap" parameterType="hashmap">
		select code,
		text,	 
		dimorder,
		round(sum(zfy),4) as jcfy,
		case when sum(zfy2) <![CDATA[ <> ]]>
		0 then round((sum(zfy) - sum(zfy2)) / sum(zfy2), 4) else 0 end as
		yearOnYear,
		case when sum(zfy3) <![CDATA[ <> ]]>
		0 then round((sum(zfy) - sum(zfy3)) / sum(zfy3), 4) else 0 end as
		ringRatio
		from ( select
		code,
		text,
		dimorder,
		case when flag = 1 then sum(zfy) else 0 end zfy,
		case when flag = 2 then sum(zfy) else 0 end zfy2,
		case when flag = 3
		then sum(zfy) else 0 end zfy3
		from (
			SELECT a.code,a.text ,a.dimorder,decode(nvl(b,0),0,0,a/b) as zfy,1 as flag FROM
			(select code,text,dimorder,
				<choose>
			        <when test="CWorYW=='CW'">
			           sum(${cw_ssfy.indbName_value})  as a 
			        </when>
			        <when test="CWorYW=='YW'">
			           sum(${yw_ssfy.indbName_value})  as a 
			        </when>
		    	</choose>
			
			from 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_ssfy.indbName_value}  t1
		        </when>
		        <when test="CWorYW=='YW'">
		            ${yw_ssfy.indbName_value}  t1
		        </when>
		    </choose>
			LEFT JOIN 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_ssfy.dimDoctor} t4
		        </when>
		         <when test="CWorYW=='YW'">
		           ${yw_ssfy.dimDoctor} t4
		        </when>
		    </choose>
			 on 
			 <choose>
		        <when test="CWorYW=='CW'">
		           t1.${cw_ssfy.dimDoctor} = t4.code
		        </when>
		        <when test="CWorYW=='YW'">
		           t1.${yw_ssfy.dimDoctor} = t4.code
		        </when>
		    </choose>
			where 1 = 1 
			<choose>
		        <when test="CWorYW=='CW'">
		          <include refid="sql_where_doctor_code_FY_CW" />
		        </when>
		        <when test="CWorYW=='YW'">
		           <include refid="sql_where_doctor_code_FY" />
		        </when>
		    </choose>
			 
			<choose>
				<when
					test='aycx != null and aycx ==1'>
					<include refid="sql_nowMonth_where2_FY" />
				</when>
				<when
					test='aycx == null or (aycx != null and aycx !=1 )'>
					<include refid="sql_now_where2_FY" />
				</when>
			</choose>
			GROUP BY code,text,dimorder ORDER BY dimorder) a 
			left	 JOIN
			(	
				select
				code,text,
				dimorder,
			    sum(${ss_jzrc.indbName_value})  as b 
				from 
			           ${ss_jzrc.indbName_value} t1
				LEFT JOIN 
			           ${ss_jzrc.dimDoctor} t4
				 on 
			           t1.${ss_jzrc.dimDoctor} = t4.code
				where 1 = 1 <include refid="sql_where_doctor_code_RC" /> 
				<choose>
					<when
						test='aycx != null and aycx ==1'>
						<include refid="sql_nowMonth_where2_RC" />
					</when>
					<when
						test='aycx == null or (aycx != null and aycx !=1 )'>
						<include refid="sql_now_where2_RC" />
					</when>
				</choose>
				GROUP BY code,text ,dimorder 
				ORDER BY dimorder
			) b on a.code = b.code
			
		<!-- 同比 -->
		union
		
		SELECT a.code,a.text ,a.dimorder,decode(nvl(b,0),0,0,a/b) as zfy,2 as flag FROM
			(select code,text,dimorder,
				<choose>
			        <when test="CWorYW=='CW'">
			           sum(${cw_ssfy.indbName_value})  as a 
			        </when>
			        <when test="CWorYW=='YW'">
			           sum(${yw_ssfy.indbName_value})  as a 
			        </when>
		    	</choose>
			
			from 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_ssfy.indbName_value}  t1
		        </when>
		        <when test="CWorYW=='YW'">
		           ${yw_ssfy.indbName_value}  t1
		        </when>
		    </choose>
			LEFT JOIN 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_ssfy.dimDoctor} t4
		        </when>
		         <when test="CWorYW=='YW'">
		           ${yw_ssfy.dimDoctor} t4
		        </when>
		    </choose>
			 on 
			 <choose>
		        <when test="CWorYW=='CW'">
		           t1.${cw_ssfy.dimDoctor} = t4.code
		        </when>
		        <when test="CWorYW=='YW'">
		           t1.${yw_ssfy.dimDoctor} = t4.code
		        </when>
		    </choose>
			where 1 = 1 
			<choose>
		        <when test="CWorYW=='CW'">
		          <include refid="sql_where_doctor_code_FY_CW" />
		        </when>
		        <when test="CWorYW=='YW'">
		           <include refid="sql_where_doctor_code_FY" />
		        </when>
		    </choose>
			<choose>
				<when
					test='aycx != null and aycx ==1'>
					<include refid="sql_yearOnYearMonth_where2_FY" />
				</when>
				<when
					test='aycx == null or (aycx != null and aycx !=1 )'>
					<include refid="sql_yearOnYear_where2_FY" />
				</when>
			</choose>
			GROUP BY code,text,dimorder ORDER BY dimorder) a 
			left	 JOIN
			(	
				select
				code,text,
				dimorder,
			    sum(${ss_jzrc.indbName_value})  as b 
				from 
			           ${ss_jzrc.indbName_value} t1
				LEFT JOIN 
			           ${ss_jzrc.dimDoctor} t4
				 on 
			           t1.${ss_jzrc.dimDoctor} = t4.code
				where 1 = 1 <include refid="sql_where_doctor_code_RC" /> 
			<choose>
				<when
					test='aycx != null and aycx ==1'>
					<include refid="sql_yearOnYearMonth_where2_RC" />
				</when>
				<when
					test='aycx == null or (aycx != null and aycx !=1 )'>
					<include refid="sql_yearOnYear_where2_RC" />
				</when>
			</choose>
			GROUP BY code,text ,dimorder 
			ORDER BY dimorder) b on a.code = b.code
		
		<!-- 环比 -->
		union
		
		SELECT a.code,a.text ,a.dimorder,decode(nvl(b,0),0,0,a/b) as zfy,3 as flag FROM
			(select code,text,dimorder,
				<choose>
			        <when test="CWorYW=='CW'">
			           sum(${cw_ssfy.indbName_value})  as a 
			        </when>
			        <when test="CWorYW=='YW'">
			           sum(${yw_ssfy.indbName_value})  as a 
			        </when>
		    	</choose>
			
			from 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_ssfy.indbName_value}  t1
		        </when>
		        <when test="CWorYW=='YW'">
		           ${yw_ssfy.indbName_value}  t1
		        </when>
		    </choose>
			LEFT JOIN 
			<choose>
		        <when test="CWorYW=='CW'">
		           ${cw_ssfy.dimDoctor} t4
		        </when>
		         <when test="CWorYW=='YW'">
		           ${yw_ssfy.dimDoctor} t4
		        </when>
		    </choose>
			 on 
			 <choose>
		        <when test="CWorYW=='CW'">
		           t1.${cw_ssfy.dimDoctor} = t4.code
		        </when>
		        <when test="CWorYW=='YW'">
		           t1.${yw_ssfy.dimDoctor} = t4.code
		        </when>
		    </choose>
			where 1 = 1 
			<choose>
		        <when test="CWorYW=='CW'">
		          <include refid="sql_where_doctor_code_FY_CW" />
		        </when>
		        <when test="CWorYW=='YW'">
		           <include refid="sql_where_doctor_code_FY" />
		        </when>
		    </choose>
			<choose>
				<when
					test='aycx != null and aycx ==1'>
					<include refid="sql_ringRatioMonth_where2_FY" />
				</when>
				<when
					test='aycx == null or (aycx != null and aycx !=1 )'>
					<include refid="sql_ringRatio_where2_FY" />
				</when>
			</choose>
			GROUP BY code,text,dimorder ORDER BY dimorder) a 
			left	 JOIN
			(	
				select
				code,text,
				dimorder,
			    sum(${ss_jzrc.indbName_value})  as b 
				from 
			           ${ss_jzrc.indbName_value} t1
				LEFT JOIN 
			           ${ss_jzrc.dimDoctor} t4
				 on 
			           t1.${ss_jzrc.dimDoctor} = t4.code
			where 1 = 1 <include refid="sql_where_doctor_code_RC" /> 
			<choose>
			<when
				test='aycx != null and aycx ==1'>
				<include refid="sql_ringRatioMonth_where2_RC" />
			</when>
			<when
				test='aycx == null or (aycx != null and aycx !=1 )'>
				<include refid="sql_ringRatio_where2_RC" />
			</when>
		</choose>
			GROUP BY code,text ,dimorder 
			ORDER BY dimorder) b on a.code = b.code
		
			) 
			<!-- TODO -->
			<include refid="sql_where_doctorCodes" />
			GROUP BY code,text,flag,dimorder)GROUP BY code,text,dimorder ORDER BY dimorder
		
	</select>
	
	
	<!--门诊药占比 下钻到科室 -->
	<select id="getCountDrugOccupationRatioByOutpatientByDeptMz" resultType="hashmap"
		parameterType="hashmap">
		select a.code as code,a.text as text,nvl(a.yzb,0) as zb ,nvl(b.yzb,0) as yearOnYear,
		nvl(c.yzb,0) as ringRatio from
		 
		<if test=" CWorYW !='CW' ">
			(select 
			t4.code,t4.text, t4.dimorder,
			round(sum(${yw_mzxx.indbName_value})  / (
			select 
			sum(${yw_mzxx.indbName_value})
		
			from ${yw_mzxx.indbName_value} t1,
			${yw_mzxx.dimExpenseType} t2
			where 1 = 1
			and t1.${yw_mzxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			),4) as yzb
			from ${yw_mzxx.indbName_value} t1 left join ${yw_mzxx.dimDept} t4 
			on t1.${yw_mzxx.dimDept} = t4.code, 
			${yw_mzxx.dimExpenseType} t2 
			where 1 = 1
			and t1.${yw_mzxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14') 
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			GROUP BY t4.code,t4.text ,t4.dimorder ) a 
			left join
			
			
			(select 
			t4.code,t4.text, t4.dimorder,
			round(sum(${yw_mzxx.indbName_value})  / (
			select 
			sum(${yw_mzxx.indbName_value})
		
			from ${yw_mzxx.indbName_value} t1,
			${yw_mzxx.dimExpenseType} t2
			where 1 = 1
			and t1.${yw_mzxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			),4) as yzb
			from ${yw_mzxx.indbName_value} t1 left join ${yw_mzxx.dimDept} t4 
			on t1.${yw_mzxx.dimDept} = t4.code, 
			${yw_mzxx.dimExpenseType} t2 
			where 1 = 1
			and t1.${yw_mzxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			GROUP BY t4.code,t4.text ,t4.dimorder )  b on a.code = b.code
			
			
			left join
			(select 
			t4.code,t4.text, t4.dimorder,
			round(sum(${yw_mzxx.indbName_value})  / (
			select 
			sum(${yw_mzxx.indbName_value})
		
			from ${yw_mzxx.indbName_value} t1,
			${yw_mzxx.dimExpenseType} t2
			where 1 = 1
			and t1.${yw_mzxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			),4) as yzb
			from ${yw_mzxx.indbName_value} t1 left join ${yw_mzxx.dimDept} t4 
			on t1.${yw_mzxx.dimDept} = t4.code, 
			${yw_mzxx.dimExpenseType} t2 
			where 1 = 1
			and t1.${yw_mzxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			GROUP BY t4.code,t4.text ,t4.dimorder ) c
			  on a.code = c.code  
			  <!-- TODO -->
			  <include refid="sql_where_deptCodes_a" />
			  
			  order BY a.dimorder
		</if>
		
		<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
			(select 
			
			t4.code,t4.text, t4.dimorder,
			round(sum(${cw_mzxx.indbName_value})  / (
			select 
			sum(${cw_mzxx.indbName_value})
		
			from ${cw_mzxx.indbName_value} t1,
			${cw_mzxx.dimExpenseType} t2
			where 1 = 1
			and t1.${cw_mzxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			),4) as yzb
			from ${cw_mzxx.indbName_value} t1 left join ${cw_mzxx.dimDept} t4 
			on t1.${cw_mzxx.dimDept} = t4.code, 
			${cw_mzxx.dimExpenseType} t2 
			where 1 = 1
			and t1.${cw_mzxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			GROUP BY t4.code,t4.text ,t4.dimorder ) a 
			left join
			
			
			(select 
			t4.code,t4.text, t4.dimorder,
			round(sum(${cw_mzxx.indbName_value})  / (
			select 
			sum(${cw_mzxx.indbName_value})
		
			from ${cw_mzxx.indbName_value} t1,
			${cw_mzxx.dimExpenseType} t2
			where 1 = 1
			and t1.${cw_mzxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			),4) as yzb
			from ${cw_mzxx.indbName_value} t1 left join ${cw_mzxx.dimDept} t4 
			on t1.${cw_mzxx.dimDept} = t4.code, 
			${cw_mzxx.dimExpenseType} t2 
			where 1 = 1
			and t1.${cw_mzxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			GROUP BY t4.code,t4.text ,t4.dimorder )  b on a.code = b.code
			
			
			left join
			(select 
			t4.code,t4.text, t4.dimorder,
			round(sum(${cw_mzxx.indbName_value})  / (
			select 
			sum(${cw_mzxx.indbName_value})
		
			from ${cw_mzxx.indbName_value} t1,
			${cw_mzxx.dimExpenseType} t2
			where 1 = 1
			and t1.${cw_mzxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			),4) as yzb
			from ${cw_mzxx.indbName_value} t1 left join ${cw_mzxx.dimDept} t4 
			on t1.${cw_mzxx.dimDept} = t4.code, 
			${cw_mzxx.dimExpenseType} t2 
			where 1 = 1
			and t1.${cw_mzxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			GROUP BY t4.code,t4.text ,t4.dimorder ) c
			  on a.code = c.code  
			   <!-- TODO -->
			  <include refid="sql_where_deptCodes_a" />
			  order BY a.dimorder
		</if>
	</select>
	<!--住院药占比 下钻到科室 -->
	<select id="getCountDrugOccupationRatioByOutpatientByDeptZy" resultType="hashmap"
		parameterType="hashmap">
		select a.code as code,a.text as text,nvl(a.yzb,0) as zb ,nvl(b.yzb,0) as yearOnYear,
		nvl(c.yzb,0) as ringRatio from
		 
		<if test=" CWorYW !='CW' ">
			(select 
			t4.code,t4.text, t4.dimorder,
			round(sum(${yw_zyxx.indbName_value})  / (
			select 
			sum(${yw_zyxx.indbName_value})
		
			from ${yw_zyxx.indbName_value} t1,
			${yw_zyxx.dimExpenseType} t2
			where 1 = 1
			and t1.${yw_zyxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			),4) as yzb
			from ${yw_zyxx.indbName_value} t1 left join ${yw_zyxx.dimDept} t4 
			on t1.${yw_zyxx.dimDept} = t4.code, 
			${yw_zyxx.dimExpenseType} t2 
			where 1 = 1
			and t1.${yw_zyxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14') 
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			GROUP BY t4.code,t4.text ,t4.dimorder ) a 
			left join
			
			
			(select 
			t4.code,t4.text, t4.dimorder,
			round(sum(${yw_zyxx.indbName_value})  / (
			select 
			sum(${yw_zyxx.indbName_value})
		
			from ${yw_zyxx.indbName_value} t1,
			${yw_zyxx.dimExpenseType} t2
			where 1 = 1
			and t1.${yw_zyxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			),4) as yzb
			from ${yw_zyxx.indbName_value} t1 left join ${yw_zyxx.dimDept} t4 
			on t1.${yw_zyxx.dimDept} = t4.code, 
			${yw_zyxx.dimExpenseType} t2 
			where 1 = 1
			and t1.${yw_zyxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14') 
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			GROUP BY t4.code,t4.text ,t4.dimorder )  b on a.code = b.code
			
			
			left join
			(select 
			t4.code,t4.text, t4.dimorder,
			round(sum(${yw_zyxx.indbName_value})  / (
			select 
			sum(${yw_zyxx.indbName_value})
		
			from ${yw_zyxx.indbName_value} t1,
			${yw_zyxx.dimExpenseType} t2
			where 1 = 1
			and t1.${yw_zyxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			),4) as yzb
			from ${yw_zyxx.indbName_value} t1 left join ${yw_zyxx.dimDept} t4 
			on t1.${yw_zyxx.dimDept} = t4.code, 
			${yw_zyxx.dimExpenseType} t2 
			where 1 = 1
			and t1.${yw_zyxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14') 
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			GROUP BY t4.code,t4.text ,t4.dimorder ) c
			  on a.code = c.code 
			  <include refid="sql_where_deptCodes_a" />
			   order BY a.dimorder
		</if>
		
		<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
			(select 
			t4.code,t4.text, t4.dimorder,
			round(sum(${cw_zyxx.indbName_value})  / (
			select 
			sum(${cw_zyxx.indbName_value})
		
			from ${cw_zyxx.indbName_value} t1,
			${cw_zyxx.dimExpenseType} t2
			where 1 = 1
			and t1.${cw_zyxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			),4) as yzb
			from ${cw_zyxx.indbName_value} t1 left join ${cw_zyxx.dimDept} t4 
			on t1.${cw_zyxx.dimDept} = t4.code, 
			${cw_zyxx.dimExpenseType} t2 
			where 1 = 1
			and t1.${cw_zyxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			GROUP BY t4.code,t4.text ,t4.dimorder ) a 
			left join
			(select 
			t4.code,t4.text, t4.dimorder,
			round(sum(${cw_zyxx.indbName_value})  / (
			select 
			sum(${cw_zyxx.indbName_value})
		
			from ${cw_zyxx.indbName_value} t1,
			${cw_zyxx.dimExpenseType} t2
			where 1 = 1
			and t1.${cw_zyxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			),4) as yzb
			from ${cw_zyxx.indbName_value} t1 left join ${cw_zyxx.dimDept} t4 
			on t1.${cw_zyxx.dimDept} = t4.code, 
			${cw_zyxx.dimExpenseType} t2 
			where 1 = 1
			and t1.${cw_zyxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			GROUP BY t4.code,t4.text ,t4.dimorder )  b on a.code = b.code
			left join
			(select 
			t4.code,t4.text, t4.dimorder,
			round(sum(${cw_zyxx.indbName_value})  / (
			select 
			sum(${cw_zyxx.indbName_value})
		
			from ${cw_zyxx.indbName_value} t1,
			${cw_zyxx.dimExpenseType} t2
			where 1 = 1
			and t1.${cw_zyxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			),4) as yzb
			from ${cw_zyxx.indbName_value} t1 left join ${cw_zyxx.dimDept} t4 
			on t1.${cw_zyxx.dimDept} = t4.code, 
			${cw_zyxx.dimExpenseType} t2 
			where 1 = 1
			and t1.${cw_zyxx.dimExpenseType} = t2.code
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			GROUP BY t4.code,t4.text ,t4.dimorder ) c
			  on a.code = c.code  
			  <!-- TODO -->
			  <include refid="sql_where_deptCodes_a" />
			  order BY a.dimorder
		</if>
	</select>	
	<!-- 药占比 下钻到科室药品费用 -->
	<select id="getCountDrugOccupationRatioByOutpatientAndDeptAndDrugMz" resultType="hashmap"
		parameterType="hashmap">
		select
		case when zfy4 <![CDATA[ <> ]]> 0 then round(sum(zfy)/ zfy4, 4) else 0 end as zb,
		case when zfy5 <![CDATA[ <> ]]> 0 then round(sum(zfy2) / zfy5 , 4) else 0 end as yearOnYear,
		case when zfy6 <![CDATA[ <> ]]> 0 then round(sum(zfy3) / zfy6 , 4) else 0 end as ringRatio,
		code,text
		from (
		select case when flag = 1 then sum(zfy) else 0 end zfy,
		case when flag = 2 then sum(zfy) else 0 end zfy2,
		case when flag = 3 then sum(zfy) else 0 end zfy3,
		code,text,
		(

		<if test=" CWorYW !='CW' ">
			select 
			sum(${yw_mzxx.indbName_value}) 
			from ${yw_mzxx.indbName_value} t1,${yw_mzxx.dimExpenseType} t2
			where 1=1 and
			t1.${yw_mzxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			) as zfy4,
			( 
			select 
			sum(${yw_mzxx.indbName_value}) 
			from ${yw_mzxx.indbName_value} t1,${yw_mzxx.dimExpenseType} t2
			where 1=1 and
			t1.${yw_mzxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			) as zfy5,
			( 
			select 
			sum(${yw_mzxx.indbName_value}) 
			from ${yw_mzxx.indbName_value} t1,${yw_mzxx.dimExpenseType} t2
			where 1=1 and
			t1.${yw_mzxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			) as zfy6
			from (
			select sum(${yw_mzxx.indbName_value}) zfy, t2.code,t2.text,1 as flag
			from ${yw_mzxx.indbName_value} t1 LEFT JOIN ${yw_mzxx.dimDept} t4 
			on t1.${yw_mzxx.dimDept} = t4.code,
			${yw_mzxx.dimExpenseType} t2
			where 1=1
			and t1.${yw_mzxx.dimExpenseType} = t2.code
			<include refid="sql_where_doctor_code_FY" />
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>

			group by t2.code,t2.text
			union
			select sum(${yw_mzxx.indbName_value}) zfy, t2.code,t2.text,2 as flag
			from ${yw_mzxx.indbName_value} t1 LEFT JOIN ${yw_mzxx.dimDept} t4 
			on t1.${yw_mzxx.dimDept} = t4.code,
			${yw_mzxx.dimExpenseType} t2
			where 1=1
			and t1.${yw_mzxx.dimExpenseType} = t2.code
			<include refid="sql_where_doctor_code_FY" />
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			group by t2.code,t2.text
			union
			select sum(${yw_mzxx.indbName_value}) zfy, t2.code,t2.text,3 as flag
			from ${yw_mzxx.indbName_value} t1 LEFT JOIN ${yw_mzxx.dimDept} t4 
			on t1.${yw_mzxx.dimDept} = t4.code,
			${yw_mzxx.dimExpenseType} t2
			where 1=1
			and t1.${yw_mzxx.dimExpenseType} = t2.code
			<include refid="sql_where_doctor_code_FY" />
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			group by t2.code,t2.text
		</if>
		
		<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
		
			select sum(${cw_mzxx.indbName_value}) from ${cw_mzxx.indbName_value} t1,
			${cw_mzxx.dimExpenseType} t2
			where 1=1 and
			t1.${cw_mzxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			) as zfy4,
			( 
			select sum(${cw_mzxx.indbName_value}) from ${cw_mzxx.indbName_value} t1,
			${cw_mzxx.dimExpenseType} t2
			where 1=1 and
			t1.${cw_mzxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			) as zfy5,
			( 
			select sum(${cw_mzxx.indbName_value}) from ${cw_mzxx.indbName_value} t1,
			${cw_mzxx.dimExpenseType} t2
			where 1=1 and
			t1.${cw_mzxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			) as zfy6
			from (
			select sum(${cw_mzxx.indbName_value}) zfy, t2.code,t2.text,1 as flag
			from ${cw_mzxx.indbName_value}
			t1 LEFT JOIN ${cw_mzxx.dimDept} t4 on t1.${cw_mzxx.dimDept} = t4.code,
			${cw_mzxx.dimExpenseType} t2
			where 1=1
			and t1.${cw_mzxx.dimExpenseType} = t2.code
			<include refid="sql_where_doctor_code_FY_CW" />
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			group by t2.code,t2.text
			union
			select sum(${cw_mzxx.indbName_value}) zfy, t2.code,t2.text,2 as flag
			from ${cw_mzxx.indbName_value}
			t1 LEFT JOIN ${cw_mzxx.dimDept} t4 on t1.${cw_mzxx.dimDept} = t4.code,
			${cw_mzxx.dimExpenseType} t2
			where 1=1
			and t1.${cw_mzxx.dimExpenseType} = t2.code
			<include refid="sql_where_doctor_code_FY_CW" />
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			group by t2.code,t2.text
			union
			select sum(${cw_mzxx.indbName_value}) zfy, t2.code,t2.text,3 as flag
			from ${cw_mzxx.indbName_value}
			t1 LEFT JOIN ${cw_mzxx.dimDept} t4 on t1.${cw_mzxx.dimDept} = t4.code,
			${cw_mzxx.dimExpenseType} t2
			where 1=1
			and t1.${cw_mzxx.dimExpenseType} = t2.code
			<include refid="sql_where_doctor_code_FY_CW" />
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			group by t2.code,t2.text
		</if>
		)group by flag,code,text)group by code,text,zfy4,zfy5,zfy6
		<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
			order by text
		</if>
		<if test="  CWorYW !='CW' ">
			order by code
		</if>
	</select>
	
	<select id="getCountDrugOccupationRatioByOutpatientAndDeptAndDrugZy" resultType="hashmap"
		parameterType="hashmap">
		select
		case when zfy4 <![CDATA[ <> ]]> 0 then round(sum(zfy)/ zfy4, 4) else 0 end as zb,
		case when zfy5 <![CDATA[ <> ]]> 0 then round(sum(zfy2) / zfy5 , 4) else 0 end as yearOnYear,
		case when zfy6 <![CDATA[ <> ]]> 0 then round(sum(zfy3) / zfy6 , 4) else 0 end as ringRatio,
		code,text
		from (
		select case when flag = 1 then sum(zfy) else 0 end zfy,
		case when flag = 2 then sum(zfy) else 0 end zfy2,
		case when flag = 3 then sum(zfy) else 0 end zfy3,
		code,text,
		(
		<if test=" CWorYW !='CW' ">
			select 
			sum(${yw_zyxx.indbName_value}) 
			from ${yw_zyxx.indbName_value} t1,${yw_zyxx.dimExpenseType} t2
			where 1=1 and
			t1.${yw_zyxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			) as zfy4,
			( 
			select 
			sum(${yw_zyxx.indbName_value}) 
			from ${yw_zyxx.indbName_value} t1,${yw_zyxx.dimExpenseType} t2
			where 1=1 and
			t1.${yw_zyxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			) as zfy5,
			( 
			select 
			sum(${yw_zyxx.indbName_value}) 
			from ${yw_zyxx.indbName_value} t1,${yw_zyxx.dimExpenseType} t2
			where 1=1 and
			t1.${yw_zyxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			) as zfy6
			from (
			select sum(${yw_zyxx.indbName_value}) zfy, t2.code,t2.text,1 as flag
			from ${yw_zyxx.indbName_value} t1 LEFT JOIN ${yw_zyxx.dimDept} t4 
			on t1.${yw_zyxx.dimDept} = t4.code,
			${yw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${yw_zyxx.dimExpenseType} = t2.code
			<include refid="sql_where_doctor_code_FY" />
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>

			group by t2.code,t2.text
			union
			select sum(${yw_zyxx.indbName_value}) zfy, t2.code,t2.text,2 as flag
			from ${yw_zyxx.indbName_value} t1 LEFT JOIN ${yw_zyxx.dimDept} t4 
			on t1.${yw_zyxx.dimDept} = t4.code,
			${yw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${yw_zyxx.dimExpenseType} = t2.code
			<include refid="sql_where_doctor_code_FY" />
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			group by t2.code,t2.text
			union
			select sum(${yw_zyxx.indbName_value}) zfy, t2.code,t2.text,3 as flag
			from ${yw_zyxx.indbName_value} t1 LEFT JOIN ${yw_zyxx.dimDept} t4 
			on t1.${yw_zyxx.dimDept} = t4.code,
			${yw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${yw_zyxx.dimExpenseType} = t2.code
			<include refid="sql_where_doctor_code_FY" />
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			group by t2.code,t2.text
		</if>
		
		<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
		
			select sum(${cw_zyxx.indbName_value}) from ${cw_zyxx.indbName_value} t1,
			${cw_zyxx.dimExpenseType} t2
			where 1=1 and
			t1.${cw_zyxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			) as zfy4,
			( 
			select sum(${cw_zyxx.indbName_value}) from ${cw_zyxx.indbName_value} t1,
			${cw_zyxx.dimExpenseType} t2
			where 1=1 and
			t1.${cw_zyxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			) as zfy5,
			( 
			select sum(${cw_zyxx.indbName_value}) from ${cw_zyxx.indbName_value} t1,
			${cw_zyxx.dimExpenseType} t2
			where 1=1 and
			t1.${cw_zyxx.dimExpenseType} = t2.code
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			) as zfy6
			from (
			select sum(${cw_zyxx.indbName_value}) zfy, t2.code,t2.text,1 as flag
			from ${cw_zyxx.indbName_value}
			t1 LEFT JOIN ${cw_zyxx.dimDept} t4 on t1.${cw_zyxx.dimDept} = t4.code,
			${cw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${cw_zyxx.dimExpenseType} = t2.code
			<include refid="sql_where_doctor_code_FY_CW" />
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_now_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_nowMonth_where2_FY" />
			</if>
			group by t2.code,t2.text
			union
			select sum(${cw_zyxx.indbName_value}) zfy, t2.code,t2.text,2 as flag
			from ${cw_zyxx.indbName_value}
			t1 LEFT JOIN ${cw_zyxx.dimDept} t4 on t1.${cw_zyxx.dimDept} = t4.code,
			${cw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${cw_zyxx.dimExpenseType} = t2.code
			<include refid="sql_where_doctor_code_FY_CW" />
			and t2.code in ('12','13','14')
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_yearOnYear_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_yearOnYearMonth_where2_FY" />
			</if>
			group by t2.code,t2.text
			union
			select sum(${cw_zyxx.indbName_value}) zfy, t2.code,t2.text,3 as flag
			from ${cw_zyxx.indbName_value}
			t1 LEFT JOIN ${cw_zyxx.dimDept} t4 on t1.${cw_zyxx.dimDept} = t4.code,
			${cw_zyxx.dimExpenseType} t2
			where 1=1
			and t1.${cw_zyxx.dimExpenseType} = t2.code
			<include refid="sql_where_doctor_code_FY_CW" />
			and t2.code in ('12','13','14')
			
			<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
				<include refid="sql_ringRatio_where2_FY" />
			</if>
			<if test=" aycx != null and aycx ==1 ">
				<include refid="sql_ringRatioMonth_where2_FY" />
			</if>
			group by t2.code,t2.text
		</if>
		)group by flag,code,text)group by code,text,zfy4,zfy5,zfy6
		<if test="CWorYW!=null and CWorYW!='' and CWorYW =='CW' ">
			order by text
		</if>
		<if test="  CWorYW !='CW' ">
			order by code
		</if>
	</select>
	
	<select id="getTimeIntervalAnalysisByOutpatientAndDeptAndTime" resultType="hashmap"
		parameterType="hashmap">
		select   t4.code,t4.text,t4.dimorder,
		sum(${gh_rc.indbName_value}) as rc
		from ${gh_rc.indbName_value} t1 
		LEFT JOIN ${gh_rc.dimDept} t4 on t1.${gh_rc.dimDept} = t4.code where 1 = 1
		<if test='date != null'> and t1.${gh_rc.dimTime} = #{date,jdbcType=VARCHAR}</if>
		<if test="size != 0">
			and t1.${gh_rc.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
			</if>
			
			<include refid="sql_where_hourTime" />
			<!-- TODO -->
			<include refid="sql_where_and_deptCodes" />
		group by to_char(to_date(t1.${gh_rc.dimHour}, 'hh24:mi:ss'), 'hh24'),t4.code,t4.text ,t4.dimorder
		order  by t4.dimorder
	</select>
	
	<select id="getTimeIntervalAnalysisByOutpatientAndDoctorAndTime" resultType="hashmap"
		parameterType="hashmap">
		select   t2.code,t2.text,t2.dimorder,
		sum(${gh_rc.indbName_value}) as rc
		from ${gh_rc.indbName_value} t1 
		LEFT JOIN ${gh_rc.dimDept} t4 on t1.${gh_rc.dimDept} = t4.code LEFT JOIN ${gh_rc.dimDoctor} t2 on 
		t1.${gh_rc.dimDoctor} = t2.code where 1 = 1
		<choose>
			<when test="MzOrJz != null and MzOrJz == 'MZ'">
				and t1.${gh_rc.dimDept} = #{code,jdbcType=VARCHAR}
			</when>
			<when test="MzOrJz != null and MzOrJz == 'JZ'">
				and t1.${gh_rc.dimDept} = '0189'
			</when>
		</choose>
		
		<if test='date != null'> and t1.${gh_rc.dimTime} = #{date,jdbcType=VARCHAR}</if>
		<if test="size != 0">
			and t1.${gh_rc.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		<include refid="sql_where_hourTime" />
		<!-- TODO -->
			<include refid="sql_where_and_doctorCodes" />
		group by to_char(to_date(t1.${gh_rc.dimHour}, 'hh24:mi:ss'), 'hh24'),t2.code,t2.text ,t2.dimorder
		order  by t2.dimorder
	</select>
	
	
	
	<select id="getTodayPrescriptionTotalByDept" resultType="hashmap"
		parameterType="hashmap">
		select cfsl , zxcf,  zdcf,  cfje, a.code as code
		from (
		(select sum(${cf_sl.indbName_value}) as cfsl,
		t4.code
		from
		${cf_sl.indbName_value} t1 LEFT JOIN ${cf_sl.dimDept}
		t4 on t1.${cf_sl.dimDept}= t4.code, ${cf_sl.dimOrganization} t3
		where t1.${cf_sl.dimOrganization} = t3.code
		<if test='date != null'> and t1.${cf_sl.dimTime} = #{date,jdbcType=VARCHAR}</if>
		<if test="size != 0">
			and t1.${cf_sl.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		GROUP BY t4.code) a 
		
		FULL JOIN  
		
		(select
		sum(${cf_je.indbName_value}) as cfje,
		t4.code
		from
		${cf_je.indbName_value} t1 LEFT JOIN ${cf_je.dimDept}
		t4 on t1.${cf_je.dimDept}= t4.code, ${cf_je.dimOrganization} t3
		where t1.${cf_je.dimOrganization} = t3.code
		<if test='date != null'> and t1.${cf_je.dimTime} = #{date,jdbcType=VARCHAR}</if>
		<if test="size != 0">
			and t1.${cf_je.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		GROUP BY t4.code) b on a.code = b .code
		
		FULL JOIN 
		
		(select 
		min(${cf_je.indbName_value}) zxcf,
		max(${cf_je.indbName_value}) zdcf,
		t4.code
		from ${cf_je.indbName_value} t1 LEFT JOIN ${cf_je.dimDept}
		t4 on t1.${cf_je.dimDept}= t4.code, ${cf_je.dimOrganization} t3
		where t1.${cf_je.dimOrganization} = t3.code
		<if test='date != null'> and t1.${cf_je.dimTime} = #{date,jdbcType=VARCHAR}</if>
		<if test="size != 0">
			and t1.${cf_je.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		and t1.${cf_je.indbName_value}> 0
		GROUP BY t4.code) c on a.code = c.code)
		<!-- TODO -->
		<include refid="sql_where_deptCodes_a" />
	</select>
	
	
	<select id="getTodayPrescriptionTotalByDoctor" resultType="hashmap"
		parameterType="hashmap">
		select cfsl , zxcf,  zdcf,  cfje, a.code as code
		from (
		(select sum(${cf_sl.indbName_value}) as cfsl,
		t2.code
		from
		${cf_sl.indbName_value} t1 
		LEFT JOIN ${cf_sl.dimDoctor} t2
		on t1.${cf_sl.dimDoctor}= t2.code
		
		LEFT JOIN ${cf_sl.dimDept}
		t4 on t1.${cf_sl.dimDept}= t4.code, ${cf_sl.dimOrganization} t3
		where t1.${cf_sl.dimOrganization} = t3.code
		and t1.${cf_sl.dimDept} = #{code}
		<if test='date != null'> and t1.${cf_sl.dimTime} = #{date,jdbcType=VARCHAR}</if>
		<if test="size != 0">
			and t1.${cf_sl.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		GROUP BY t2.code) a 
		
		FULL JOIN  
		
		(select
		sum(${cf_je.indbName_value}) as cfje,
		t2.code
		from
		${cf_je.indbName_value} t1 
		LEFT JOIN ${cf_je.dimDoctor} t2
		on t1.${cf_je.dimDoctor}= t2.code
		LEFT JOIN ${cf_je.dimDept}
		t4 on t1.${cf_je.dimDept}= t4.code, ${cf_je.dimOrganization} t3
		where t1.${cf_je.dimOrganization} = t3.code
		and t1.${cf_je.dimDept} = #{code}
		<if test='date != null'> and t1.${cf_je.dimTime} = #{date,jdbcType=VARCHAR}</if>
		<if test="size != 0">
			and t1.${cf_je.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		GROUP BY t2.code) b on a.code = b .code
		
		FULL JOIN 
		
		(select 
		min(${cf_je.indbName_value}) zxcf,
		max(${cf_je.indbName_value}) zdcf,
		t2.code
		from ${cf_je.indbName_value} t1 
		LEFT JOIN ${cf_je.dimDoctor} t2
		on t1.${cf_je.dimDoctor}= t2.code
		LEFT JOIN ${cf_je.dimDept}
		t4 on t1.${cf_je.dimDept}= t4.code, ${cf_je.dimOrganization} t3
		where t1.${cf_je.dimOrganization} = t3.code
		and t1.${cf_je.dimDept} = #{code}
		<if test='date != null'> and t1.${cf_je.dimTime} = #{date,jdbcType=VARCHAR}</if>
		<if test="size != 0">
			and t1.${cf_je.dimOrganization} in
			<foreach item="item" collection="jgidList" open="("
				separator="," close=")">
				#{item.jgid,jdbcType=VARCHAR}
			</foreach>
		</if>
		and t1.${cf_je.indbName_value}> 0
		GROUP BY t2.code) c on a.code = c.code)
		<!-- TODO -->
		<include refid="sql_where_doctorCodes_a" />
	</select>
	
	
	
	<select id="getDischargeTimeByDept" resultType="hashmap"
		parameterType="hashmap">
		select nvl(sum(rc), 0) rc,
		case when sum(rc2) <![CDATA[ <> ]]>
		0 then round((sum(rc) - sum(rc2)) / sum(rc2), 4) else 0 end as
		yearOnYear,
		case when sum(rc3) <![CDATA[ <> ]]>
		0 then round((sum(rc) - sum(rc3)) / sum(rc3), 4) else 0 end as
		ringRatio,
		code,text,dimorder
		from (select case when flag = 1 then sum(rc) else 0 end rc,
		case when flag = 2 then sum(rc) else 0 end rc2,
		case when flag = 3 then
		sum(rc) else 0 end rc3,
		code,text,dimorder 
		from (
			select sum(${zy_jzrc.indbName_value}) rc, t4.code, t4.text , t4.dimorder, 1 as flag
		from
		${zy_jzrc.indbName_value} t1 left join ${zy_jzrc.dimDept} t4 on t1.${zy_jzrc.dimDept} = t4.CODE where 1=1
		<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
			<include refid="sql_now_where2_RC" />
		</if>
		<if test=" aycx != null and aycx ==1 ">
			<include refid="sql_nowMonth_where2_RC" />
		</if>
		GROUP BY t4.code,t4.text, t4.dimorder 

		union
		select sum(${zy_jzrc.indbName_value}) rc, t4.code, t4.text , t4.dimorder, 2 as flag
		from
		${zy_jzrc.indbName_value} t1 left join ${zy_jzrc.dimDept} t4 on 
		t1.${zy_jzrc.dimDept} = t4.CODE where 1=1
		<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
			<include refid="sql_yearOnYear_where2_RC" />
		</if>
		<if test=" aycx != null and aycx ==1 ">
			<include refid="sql_yearOnYearMonth_where2_RC" />
		</if>
		 GROUP BY t4.code,t4.text, t4.dimorder 

		union
		select sum(${zy_jzrc.indbName_value}) rc, t4.code, t4.text , t4.dimorder, 3 as flag
		from
		${zy_jzrc.indbName_value} t1 left join ${zy_jzrc.dimDept} t4 on t1.${zy_jzrc.dimDept} = t4.CODE where 1=1
		<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
			<include refid="sql_ringRatio_where2_RC" />
		</if>
		<if test=" aycx != null and aycx ==1 ">
			<include refid="sql_ringRatioMonth_where2_RC" />
		</if>
		 GROUP BY t4.code,t4.text, t4.dimorder 

		)  
		<!-- TODO -->
		<include refid="sql_where_deptCodes" />
		
		group by flag,code,text,dimorder) group by code,text,dimorder ORDER BY  dimorder

	</select>
	
	
	<select id="getDischargeTimeByDoctor" resultType="hashmap"
		parameterType="hashmap">
		select nvl(sum(rc), 0) rc,
		case when sum(rc2) <![CDATA[ <> ]]>
		0 then round((sum(rc) - sum(rc2)) / sum(rc2), 4) else 0 end as
		yearOnYear,
		case when sum(rc3) <![CDATA[ <> ]]>
		0 then round((sum(rc) - sum(rc3)) / sum(rc3), 4) else 0 end as
		ringRatio,
		code,text,dimorder
		from (select case when flag = 1 then sum(rc) else 0 end rc,
		case when flag = 2 then sum(rc) else 0 end rc2,
		case when flag = 3 then
		sum(rc) else 0 end rc3,
		code,text,dimorder 
		from (
			select sum(${zy_jzrc.indbName_value}) rc, t2.code, t2.text , t2.dimorder, 1 as flag
		from
		${zy_jzrc.indbName_value} t1 left join ${zy_jzrc.dimDoctor} t2 on t1.${zy_jzrc.dimDoctor} = t2.CODE where 1=1
		and t1.${zy_jzrc.dimDept}=#{code} 
		<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
			<include refid="sql_now_where2_RC" />
		</if>
		<if test=" aycx != null and aycx ==1 ">
			<include refid="sql_nowMonth_where2_RC" />
		</if>
		GROUP BY t2.code,t2.text, t2.dimorder 

		union
		select sum(${zy_jzrc.indbName_value}) rc, t2.code, t2.text , t2.dimorder, 2 as flag
		from
		${zy_jzrc.indbName_value} t1 left join ${zy_jzrc.dimDoctor} t2 on 
		t1.${zy_jzrc.dimDoctor} = t2.CODE where 1=1
		and t1.${zy_jzrc.dimDept}=#{code} 
		<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
			<include refid="sql_yearOnYear_where2_RC" />
		</if>
		<if test=" aycx != null and aycx ==1 ">
			<include refid="sql_yearOnYearMonth_where2_RC" />
		</if>
		 GROUP BY t2.code,t2.text, t2.dimorder 

		union
		select sum(${zy_jzrc.indbName_value}) rc, t2.code, t2.text , t2.dimorder, 3 as flag
		from
		${zy_jzrc.indbName_value} t1 left join ${zy_jzrc.dimDoctor} t2 on t1.${zy_jzrc.dimDoctor} = t2.CODE where 1=1
		and t1.${zy_jzrc.dimDept}=#{code} 
		<if test=" aycx == null or (aycx != null and aycx !=1 ) ">
			<include refid="sql_ringRatio_where2_RC" />
		</if>
		<if test=" aycx != null and aycx ==1 ">
			<include refid="sql_ringRatioMonth_where2_RC" />
		</if>
		 GROUP BY t2.code,t2.text, t2.dimorder 

		)  
		<!-- TODO -->
		<include refid="sql_where_doctorCodes" />
		group by flag,code,text,dimorder) group by code,text,dimorder ORDER BY  dimorder
	</select>
	
</mapper>